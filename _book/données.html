<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Données | Notes de cours de R - Version 2</title>
  <meta name="description" content="2 Données | Notes de cours de R - Version 2" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Données | Notes de cours de R - Version 2" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Données | Notes de cours de R - Version 2" />
  
  
  

<meta name="author" content="Ewen Gallic" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction.html"/>
<link rel="next" href="fonction.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="styles/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="avant-propos.html"><a href="avant-propos.html"><i class="fa fa-check"></i>Avant Propos</a>
<ul>
<li class="chapter" data-level="0.1" data-path="avant-propos.html"><a href="avant-propos.html#objectifs"><i class="fa fa-check"></i><b>0.1</b> Objectifs</a></li>
<li class="chapter" data-level="0.2" data-path="avant-propos.html"><a href="avant-propos.html#à-qui-sadressent-ces-notes"><i class="fa fa-check"></i><b>0.2</b> À qui s’adressent ces notes ?</a></li>
<li class="chapter" data-level="0.3" data-path="avant-propos.html"><a href="avant-propos.html#remerciements"><i class="fa fa-check"></i><b>0.3</b> Remerciements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#historique"><i class="fa fa-check"></i><b>1.1</b> Historique</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#présentation-de-lespace-de-travail"><i class="fa fa-check"></i><b>1.2</b> Présentation de l’espace de travail</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#la-console-et-les-fenêtres-de-script"><i class="fa fa-check"></i><b>1.2.1</b> La console et les fenêtres de script</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction.html"><a href="introduction.html#les-variables"><i class="fa fa-check"></i><b>1.2.2</b> Les variables</a></li>
<li class="chapter" data-level="1.2.3" data-path="introduction.html"><a href="introduction.html#les-packages"><i class="fa fa-check"></i><b>1.2.3</b> Les <em>packages</em></a></li>
<li class="chapter" data-level="1.2.4" data-path="introduction.html"><a href="introduction.html#laide"><i class="fa fa-check"></i><b>1.2.4</b> L’aide</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#un-environnement-de-développement-rstudio"><i class="fa fa-check"></i><b>1.3</b> Un environnement de développement : RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="données.html"><a href="données.html"><i class="fa fa-check"></i><b>2</b> Données</a>
<ul>
<li class="chapter" data-level="2.1" data-path="données.html"><a href="données.html#types-de-données"><i class="fa fa-check"></i><b>2.1</b> Types de données</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="données.html"><a href="données.html#donnees-mode"><i class="fa fa-check"></i><b>2.1.1</b> Mode</a></li>
<li class="chapter" data-level="2.1.2" data-path="données.html"><a href="données.html#longueur"><i class="fa fa-check"></i><b>2.1.2</b> Longueur</a></li>
<li class="chapter" data-level="2.1.3" data-path="données.html"><a href="données.html#lobjet-vide"><i class="fa fa-check"></i><b>2.1.3</b> L’objet vide</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="données.html"><a href="données.html#structures"><i class="fa fa-check"></i><b>2.2</b> Structure des données</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="données.html"><a href="données.html#structures-de-base"><i class="fa fa-check"></i><b>2.2.1</b> Structures de base</a></li>
<li class="chapter" data-level="2.2.2" data-path="données.html"><a href="données.html#tableaux-de-données"><i class="fa fa-check"></i><b>2.2.2</b> Tableaux de données</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="données.html"><a href="données.html#importation-exportation-et-création-de-données"><i class="fa fa-check"></i><b>2.3</b> Importation, exportation et création de données</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="données.html"><a href="données.html#importation"><i class="fa fa-check"></i><b>2.3.1</b> Importation</a></li>
<li class="chapter" data-level="2.3.2" data-path="données.html"><a href="données.html#exportation"><i class="fa fa-check"></i><b>2.3.2</b> Exportation</a></li>
<li class="chapter" data-level="2.3.3" data-path="données.html"><a href="données.html#génération"><i class="fa fa-check"></i><b>2.3.3</b> Génération</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="données.html"><a href="données.html#manipulation-des-données"><i class="fa fa-check"></i><b>2.4</b> Manipulation des données</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="données.html"><a href="données.html#opérateurs"><i class="fa fa-check"></i><b>2.4.1</b> Opérateurs</a></li>
<li class="chapter" data-level="2.4.2" data-path="données.html"><a href="données.html#manip-acces"><i class="fa fa-check"></i><b>2.4.2</b> Accès aux valeurs, modifications</a></li>
<li class="chapter" data-level="2.4.3" data-path="données.html"><a href="données.html#chaînes-de-caractères"><i class="fa fa-check"></i><b>2.4.3</b> Chaînes de caractères</a></li>
<li class="chapter" data-level="2.4.4" data-path="données.html"><a href="données.html#dates-1"><i class="fa fa-check"></i><b>2.4.4</b> Dates</a></li>
<li class="chapter" data-level="2.4.5" data-path="données.html"><a href="données.html#calculs-matriciels"><i class="fa fa-check"></i><b>2.4.5</b> Calculs matriciels</a></li>
<li class="chapter" data-level="2.4.6" data-path="données.html"><a href="données.html#tableaux_de_donnees"><i class="fa fa-check"></i><b>2.4.6</b> Tableaux de données</a></li>
<li class="chapter" data-level="2.4.7" data-path="données.html"><a href="données.html#data-tables"><i class="fa fa-check"></i><b>2.4.7</b> Data tables</a></li>
<li class="chapter" data-level="2.4.8" data-path="données.html"><a href="données.html#quelques-fonctions-utiles"><i class="fa fa-check"></i><b>2.4.8</b> Quelques fonctions utiles</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="données.html"><a href="données.html#exercices"><i class="fa fa-check"></i><b>2.5</b> Exercices</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="fonction.html"><a href="fonction.html"><i class="fa fa-check"></i><b>3</b> Fonction</a>
<ul>
<li class="chapter" data-level="3.1" data-path="fonction.html"><a href="fonction.html#définition"><i class="fa fa-check"></i><b>3.1</b> Définition</a></li>
<li class="chapter" data-level="3.2" data-path="fonction.html"><a href="fonction.html#fonctions_structure"><i class="fa fa-check"></i><b>3.2</b> La structure d’une fonction</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="fonction.html"><a href="fonction.html#fonctions_structure_corps"><i class="fa fa-check"></i><b>3.2.1</b> Le corps d’une fonction</a></li>
<li class="chapter" data-level="3.2.2" data-path="fonction.html"><a href="fonction.html#fonctions_structure_parametres"><i class="fa fa-check"></i><b>3.2.2</b> Les arguments d’une fonction</a></li>
<li class="chapter" data-level="3.2.3" data-path="fonction.html"><a href="fonction.html#fonctions_structure_environnement"><i class="fa fa-check"></i><b>3.2.3</b> Portée des fonctions</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="fonction.html"><a href="fonction.html#documentation"><i class="fa fa-check"></i><b>3.3</b> Documentation</a></li>
<li class="chapter" data-level="3.4" data-path="fonction.html"><a href="fonction.html#exercices-1"><i class="fa fa-check"></i><b>3.4</b> Exercices</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="boucles.html"><a href="boucles.html"><i class="fa fa-check"></i><b>4</b> Boucles et calculs vectoriels</a>
<ul>
<li class="chapter" data-level="4.1" data-path="boucles.html"><a href="boucles.html#boucles_boucles"><i class="fa fa-check"></i><b>4.1</b> Les boucles</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="boucles.html"><a href="boucles.html#boucles_boucles_while"><i class="fa fa-check"></i><b>4.1.1</b> Les boucles avec <code>while()</code></a></li>
<li class="chapter" data-level="4.1.2" data-path="boucles.html"><a href="boucles.html#boucles_boucles_for"><i class="fa fa-check"></i><b>4.1.2</b> Les boucles avec <code>for()</code></a></li>
<li class="chapter" data-level="4.1.3" data-path="boucles.html"><a href="boucles.html#boucles_boucles_conditions"><i class="fa fa-check"></i><b>4.1.3</b> Les conditions</a></li>
<li class="chapter" data-level="4.1.4" data-path="boucles.html"><a href="boucles.html#boucles_boucles_repeat"><i class="fa fa-check"></i><b>4.1.4</b> L’instruction <code>repeat</code> … <code>break</code></a></li>
<li class="chapter" data-level="4.1.5" data-path="boucles.html"><a href="boucles.html#boucles_boucles_next"><i class="fa fa-check"></i><b>4.1.5</b> L’instruction <code>next</code> … <code>break</code></a></li>
<li class="chapter" data-level="4.1.6" data-path="boucles.html"><a href="boucles.html#boucles_boucles_progressbar"><i class="fa fa-check"></i><b>4.1.6</b> Barre de progression</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="boucles.html"><a href="boucles.html#boucles_vectorisation"><i class="fa fa-check"></i><b>4.2</b> La vectorisation</a></li>
<li class="chapter" data-level="4.3" data-path="boucles.html"><a href="boucles.html#boucles_vectorisation_purrr"><i class="fa fa-check"></i><b>4.3</b> Avec {<code>purrr</code>}</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="boucles.html"><a href="boucles.html#listes-ou-vecteurs-en-input"><i class="fa fa-check"></i><b>4.3.1</b> Listes ou vecteurs en <em>input</em></a></li>
<li class="chapter" data-level="4.3.2" data-path="boucles.html"><a href="boucles.html#tibbles-en-input"><i class="fa fa-check"></i><b>4.3.2</b> Tibbles en <em>input</em></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="boucles.html"><a href="boucles.html#boucles_vectorisation_plyr"><i class="fa fa-check"></i><b>4.4</b> Avec {<code>plyr</code>}</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="boucles.html"><a href="boucles.html#boucles_vectorisation_plyr_a_ply"><i class="fa fa-check"></i><b>4.4.1</b> Array en <em>input</em></a></li>
<li class="chapter" data-level="4.4.2" data-path="boucles.html"><a href="boucles.html#boucles_vectorisation_plyr_d_ply"><i class="fa fa-check"></i><b>4.4.2</b> <em>Data frame</em> en <em>input</em></a></li>
<li class="chapter" data-level="4.4.3" data-path="boucles.html"><a href="boucles.html#boucles_vectorisation_plyr_l_ply"><i class="fa fa-check"></i><b>4.4.3</b> <em>List</em> en <em>input</em></a></li>
<li class="chapter" data-level="4.4.4" data-path="boucles.html"><a href="boucles.html#boucles_vectorisation_plyr_parallel"><i class="fa fa-check"></i><b>4.4.4</b> Calcul parallèle</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="boucles.html"><a href="boucles.html#boucles_vectorisation_apply"><i class="fa fa-check"></i><b>4.5</b> Avec {<code>base</code>}</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="boucles.html"><a href="boucles.html#boucles_vectorisation_apply_lapply"><i class="fa fa-check"></i><b>4.5.1</b> La fonction <code>lapply</code></a></li>
<li class="chapter" data-level="4.5.2" data-path="boucles.html"><a href="boucles.html#boucles_vectorisation_apply_sapply"><i class="fa fa-check"></i><b>4.5.2</b> La fonction <code>sapply()</code></a></li>
<li class="chapter" data-level="4.5.3" data-path="boucles.html"><a href="boucles.html#boucles_vectorisation_apply_vapply"><i class="fa fa-check"></i><b>4.5.3</b> La fonction <code>vapply</code></a></li>
<li class="chapter" data-level="4.5.4" data-path="boucles.html"><a href="boucles.html#boucles_vectorisation_apply_apply"><i class="fa fa-check"></i><b>4.5.4</b> La fonction <code>apply()</code></a></li>
<li class="chapter" data-level="4.5.5" data-path="boucles.html"><a href="boucles.html#boucles_vectorisation_apply_tapply"><i class="fa fa-check"></i><b>4.5.5</b> La fonction <code>tapply()</code></a></li>
<li class="chapter" data-level="4.5.6" data-path="boucles.html"><a href="boucles.html#boucles_vectorisation_apply_mapply"><i class="fa fa-check"></i><b>4.5.6</b> La fonction <code>mapply()</code></a></li>
<li class="chapter" data-level="4.5.7" data-path="boucles.html"><a href="boucles.html#boucles_vectorisation_Vectorize"><i class="fa fa-check"></i><b>4.5.7</b> La fonction <code>Vectorize()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="boucles.html"><a href="boucles.html#boucles_exercices"><i class="fa fa-check"></i><b>4.6</b> Exercices</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="graphiques.html"><a href="graphiques.html"><i class="fa fa-check"></i><b>5</b> Graphiques</a>
<ul>
<li class="chapter" data-level="5.1" data-path="graphiques.html"><a href="graphiques.html#graphiques_structure"><i class="fa fa-check"></i><b>5.1</b> Structure</a></li>
<li class="chapter" data-level="5.2" data-path="graphiques.html"><a href="graphiques.html#graphiques_ggplot"><i class="fa fa-check"></i><b>5.2</b> Des graphiques élaborés avec <code>ggplot()</code></a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="graphiques.html"><a href="graphiques.html#graphiques_ggplot_aes"><i class="fa fa-check"></i><b>5.2.1</b> Arguments esthétiques</a></li>
<li class="chapter" data-level="5.2.2" data-path="graphiques.html"><a href="graphiques.html#graphiques_ggplot_geom"><i class="fa fa-check"></i><b>5.2.2</b> Arguments géométriques (fonctions <code>geom_*</code>)</a></li>
<li class="chapter" data-level="5.2.3" data-path="graphiques.html"><a href="graphiques.html#graphiques_ggplot_stat"><i class="fa fa-check"></i><b>5.2.3</b> Arguments statistiques</a></li>
<li class="chapter" data-level="5.2.4" data-path="graphiques.html"><a href="graphiques.html#graphiques_ggplot_scale"><i class="fa fa-check"></i><b>5.2.4</b> Échelles (fonction <code>scale_*()</code>)</a></li>
<li class="chapter" data-level="5.2.5" data-path="graphiques.html"><a href="graphiques.html#graphiques_ggplot_group"><i class="fa fa-check"></i><b>5.2.5</b> Groupes</a></li>
<li class="chapter" data-level="5.2.6" data-path="graphiques.html"><a href="graphiques.html#graphiques_ggplot_annotations"><i class="fa fa-check"></i><b>5.2.6</b> Annotations</a></li>
<li class="chapter" data-level="5.2.7" data-path="graphiques.html"><a href="graphiques.html#graphiques_ggplot_position"><i class="fa fa-check"></i><b>5.2.7</b> Positions</a></li>
<li class="chapter" data-level="5.2.8" data-path="graphiques.html"><a href="graphiques.html#graphiques_ggplot_facet"><i class="fa fa-check"></i><b>5.2.8</b> Facettes</a></li>
<li class="chapter" data-level="5.2.9" data-path="graphiques.html"><a href="graphiques.html#graphiques_ggplot_coord"><i class="fa fa-check"></i><b>5.2.9</b> Coordonnées</a></li>
<li class="chapter" data-level="5.2.10" data-path="graphiques.html"><a href="graphiques.html#graphiques_ggplot_axes"><i class="fa fa-check"></i><b>5.2.10</b> Titres, axes, légendes</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="graphiques.html"><a href="graphiques.html#graphiques_enregistrement"><i class="fa fa-check"></i><b>5.3</b> Enregistrement des graphiques</a></li>
<li class="chapter" data-level="5.4" data-path="graphiques.html"><a href="graphiques.html#graphiques_maps"><i class="fa fa-check"></i><b>5.4</b> Cartes</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="graphiques.html"><a href="graphiques.html#graphiques_maps_recup"><i class="fa fa-check"></i><b>5.4.1</b> Récupérer des cartes toutes faites</a></li>
<li class="chapter" data-level="5.4.2" data-path="graphiques.html"><a href="graphiques.html#graphiques_maps_choroplethe"><i class="fa fa-check"></i><b>5.4.2</b> Carte choroplèthe</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="graphiques.html"><a href="graphiques.html#graphiques_3d"><i class="fa fa-check"></i><b>5.5</b> Graphiques en 3D</a></li>
<li class="chapter" data-level="5.6" data-path="graphiques.html"><a href="graphiques.html#graphiques_exercices"><i class="fa fa-check"></i><b>5.6</b> Exercices</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="régressions-linéaires.html"><a href="régressions-linéaires.html"><i class="fa fa-check"></i><b>6</b> Régressions linéaires</a>
<ul>
<li class="chapter" data-level="6.1" data-path="régressions-linéaires.html"><a href="régressions-linéaires.html#rappels"><i class="fa fa-check"></i><b>6.1</b> Rappels</a></li>
<li class="chapter" data-level="6.2" data-path="régressions-linéaires.html"><a href="régressions-linéaires.html#regressions_donnees"><i class="fa fa-check"></i><b>6.2</b> Données de l’exemple</a></li>
<li class="chapter" data-level="6.3" data-path="régressions-linéaires.html"><a href="régressions-linéaires.html#estimation-des-paramètres"><i class="fa fa-check"></i><b>6.3</b> Estimation des paramètres {#}</a></li>
<li class="chapter" data-level="6.4" data-path="régressions-linéaires.html"><a href="régressions-linéaires.html#regressions_lecture"><i class="fa fa-check"></i><b>6.4</b> Lecture des sorties</a></li>
<li class="chapter" data-level="6.5" data-path="régressions-linéaires.html"><a href="régressions-linéaires.html#regressions_extractions"><i class="fa fa-check"></i><b>6.5</b> Extractions</a></li>
<li class="chapter" data-level="6.6" data-path="régressions-linéaires.html"><a href="régressions-linéaires.html#regressions_facteurs"><i class="fa fa-check"></i><b>6.6</b> Variables catégorielles</a></li>
<li class="chapter" data-level="6.7" data-path="régressions-linéaires.html"><a href="régressions-linéaires.html#regressions_tests"><i class="fa fa-check"></i><b>6.7</b> Tests de nullité des coefficients et intervalles de confiance</a></li>
<li class="chapter" data-level="6.8" data-path="régressions-linéaires.html"><a href="régressions-linéaires.html#regressions_previsions"><i class="fa fa-check"></i><b>6.8</b> Prévisions</a></li>
<li class="chapter" data-level="6.9" data-path="régressions-linéaires.html"><a href="régressions-linéaires.html#exercices-sur-la-régression"><i class="fa fa-check"></i><b>6.9</b> Exercices sur la régression</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="regex.html"><a href="regex.html"><i class="fa fa-check"></i><b>7</b> Expressions régulières</a>
<ul>
<li class="chapter" data-level="7.1" data-path="regex.html"><a href="regex.html#manip_regex_structure"><i class="fa fa-check"></i><b>7.1</b> Les recherches basiques</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="regex.html"><a href="regex.html#manip_regex_stringr_detect"><i class="fa fa-check"></i><b>7.1.1</b> Détection d’un motif avec <code>str_detect()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="regex.html"><a href="regex.html#manip_regex_classes"><i class="fa fa-check"></i><b>7.2</b> Les classes de caractères</a></li>
<li class="chapter" data-level="7.3" data-path="regex.html"><a href="regex.html#manip_regex_quantificateurs"><i class="fa fa-check"></i><b>7.3</b> Les quantificateurs</a></li>
<li class="chapter" data-level="7.4" data-path="regex.html"><a href="regex.html#manip_regex_metacaracteres"><i class="fa fa-check"></i><b>7.4</b> Les métacaractères</a></li>
<li class="chapter" data-level="7.5" data-path="regex.html"><a href="regex.html#manip_regex_stringr"><i class="fa fa-check"></i><b>7.5</b> Quelques fonctions du <em>package</em> {<code>stringr</code>}</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="regex.html"><a href="regex.html#manip_regex_stringr_extract"><i class="fa fa-check"></i><b>7.5.1</b> La fonction <code>str_detect()</code></a></li>
<li class="chapter" data-level="7.5.2" data-path="regex.html"><a href="regex.html#manip_regex_stringr_extract_all"><i class="fa fa-check"></i><b>7.5.2</b> La fonction <code>str_extract_all()</code></a></li>
<li class="chapter" data-level="7.5.3" data-path="regex.html"><a href="regex.html#manip_regex_stringr_match"><i class="fa fa-check"></i><b>7.5.3</b> La fonction <code>str_match()</code></a></li>
<li class="chapter" data-level="7.5.4" data-path="regex.html"><a href="regex.html#manip_regex_stringr_match_all"><i class="fa fa-check"></i><b>7.5.4</b> La fonction <code>str_match_all()</code></a></li>
<li class="chapter" data-level="7.5.5" data-path="regex.html"><a href="regex.html#manip_regex_stringr_locate"><i class="fa fa-check"></i><b>7.5.5</b> La fonction <code>str_locate()</code></a></li>
<li class="chapter" data-level="7.5.6" data-path="regex.html"><a href="regex.html#manip_regex_stringr_locate_all"><i class="fa fa-check"></i><b>7.5.6</b> La fonction <code>str_locate_all()</code></a></li>
<li class="chapter" data-level="7.5.7" data-path="regex.html"><a href="regex.html#manip_regex_stringr_replace"><i class="fa fa-check"></i><b>7.5.7</b> La fonction <code>str_replace()</code></a></li>
<li class="chapter" data-level="7.5.8" data-path="regex.html"><a href="regex.html#manip_regex_stringr_replace_all"><i class="fa fa-check"></i><b>7.5.8</b> La fonction <code>str_replace_all()</code></a></li>
<li class="chapter" data-level="7.5.9" data-path="regex.html"><a href="regex.html#manip_regex_stringr_split"><i class="fa fa-check"></i><b>7.5.9</b> La fonction <code>str_split()</code></a></li>
<li class="chapter" data-level="7.5.10" data-path="regex.html"><a href="regex.html#manip_regex_stringr_split_fixed"><i class="fa fa-check"></i><b>7.5.10</b> La fonction <code>str_string_fixed()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="regex.html"><a href="regex.html#manip_regex_base"><i class="fa fa-check"></i><b>7.6</b> Quelques fonctions du <em>package</em> {<code>base</code>}</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="pour-aller-plus-loin.html"><a href="pour-aller-plus-loin.html"><i class="fa fa-check"></i><b>8</b> Pour aller plus loin</a>
<ul>
<li class="chapter" data-level="8.1" data-path="pour-aller-plus-loin.html"><a href="pour-aller-plus-loin.html#travailler-par-projets-avec-rstudio"><i class="fa fa-check"></i><b>8.1</b> Travailler par projets, avec RStudio</a></li>
<li class="chapter" data-level="8.2" data-path="pour-aller-plus-loin.html"><a href="pour-aller-plus-loin.html#r-markdown"><i class="fa fa-check"></i><b>8.2</b> R Markdown</a></li>
<li class="chapter" data-level="8.3" data-path="pour-aller-plus-loin.html"><a href="pour-aller-plus-loin.html#modification-de-plusieurs-colonnes"><i class="fa fa-check"></i><b>8.3</b> Modification de plusieurs colonnes</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="pense-bête.html"><a href="pense-bête.html"><i class="fa fa-check"></i><b>9</b> Pense-bête</a>
<ul>
<li class="chapter" data-level="9.1" data-path="pense-bête.html"><a href="pense-bête.html#installer-un-package-depuis-sa-source"><i class="fa fa-check"></i><b>9.1</b> Installer un <em>package</em> depuis sa source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes de cours de R - Version 2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="données" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Données</h1>
<p>L’objectif de R étant d’analyser des données, il est tout aussi important de connaître les différents types qu’elles peuvent prendre que de savoir les manipuler. Ce chapitre présente dans un premier temps les objets en R, puis s’intéresse à l’importation et à l’exportation de données, et finit par la manièere de créer et de manipuler les différents types de données.</p>
<div id="types-de-données" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Types de données</h2>
<p>R gère des objets, qui sont caractérisés par un <em>nom</em>, un <em>mode</em>, une <em>longueur</em> et un <em>contenu</em>.</p>
<div id="donnees-mode" class="section level3" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Mode</h3>
<p>Le mode d’un objet est la nature des éléments qui le composent, leur type. On y accède par la fonction <code>mode()</code> ou encore <code>typeof()</code>.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="données.html#cb25-1" aria-hidden="true"></a>a &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb25-2"><a href="données.html#cb25-2" aria-hidden="true"></a><span class="kw">mode</span>(a)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<p>Il existe quatre principaux types :</p>
<ul>
<li><p><em>numeric</em> (numérique) :
On distingue deux types numériques, à savoir les <em>integers</em> (entiers) et les <em>double</em> ou <em>real</em> (réels).</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="données.html#cb27-1" aria-hidden="true"></a>a &lt;-<span class="st"> </span><span class="fl">2.0</span></span>
<span id="cb27-2"><a href="données.html#cb27-2" aria-hidden="true"></a><span class="kw">typeof</span>(a)</span></code></pre></div>
<pre><code>## [1] &quot;double&quot;</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="données.html#cb29-1" aria-hidden="true"></a><span class="kw">is.integer</span>(a) <span class="co"># a est un réel, pas un entier.</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="données.html#cb31-1" aria-hidden="true"></a>b &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb31-2"><a href="données.html#cb31-2" aria-hidden="true"></a><span class="kw">typeof</span>(b)</span></code></pre></div>
<pre><code>## [1] &quot;double&quot;</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="données.html#cb33-1" aria-hidden="true"></a>c &lt;-<span class="st"> </span><span class="kw">as.integer</span>(b)</span>
<span id="cb33-2"><a href="données.html#cb33-2" aria-hidden="true"></a><span class="kw">typeof</span>(c)</span></code></pre></div>
<pre><code>## [1] &quot;integer&quot;</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="données.html#cb35-1" aria-hidden="true"></a><span class="kw">is.numeric</span>(c) <span class="co"># c est bien un numérique.</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>La variable <code>c</code> a la même valeur que la variable <code>b</code>, mais elle nécessite un stockage en mémoire moins important <span class="citation">(Lafaye de Micheaux, Drouilhet, and Liquet <a href="#ref-Lafaye_2011_Logiciel" role="doc-biblioref">2011</a>)</span>. La fonction <code>is.integer()</code> retourne <code>TRUE</code> lorsque l’objet qui est fourni en argument est un entier, <code>FALSE</code> sinon. De manière plus générale, les instructions commençant par <code>as.</code> et suivies du nom d’un mode permettent de tester si l’objet indiqué en argument est de ce mode.</p></li>
<li><p><em>character</em> (caractère) :
Les chaînes de caractères sont placées entre guillemets simples <code>'</code> ou doubles <code>"</code>.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="données.html#cb37-1" aria-hidden="true"></a>a &lt;-<span class="st"> &quot;Hello world!&quot;</span></span>
<span id="cb37-2"><a href="données.html#cb37-2" aria-hidden="true"></a>a</span></code></pre></div>
<pre><code>## [1] &quot;Hello world!&quot;</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="données.html#cb39-1" aria-hidden="true"></a><span class="kw">typeof</span>(a)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre></li>
<li><p><em>logical</em> (logique, booléen) :
Les données de type logique peuvent prendre deux valeurs : <code>TRUE</code> ou <code>FALSE</code>. Elles répondent à une condition logique.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="données.html#cb41-1" aria-hidden="true"></a>a &lt;-<span class="st"> </span><span class="dv">1</span> ; b &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb41-2"><a href="données.html#cb41-2" aria-hidden="true"></a>a <span class="op">&lt;</span><span class="st"> </span>b</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="données.html#cb43-1" aria-hidden="true"></a>a <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="co"># Test d&#39;égalité</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="données.html#cb45-1" aria-hidden="true"></a>a <span class="op">!=</span><span class="st"> </span><span class="dv">1</span> <span class="co"># Test d&#39;inégalité</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="données.html#cb47-1" aria-hidden="true"></a><span class="kw">is.character</span>(a)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="données.html#cb49-1" aria-hidden="true"></a>(a &lt;-<span class="st"> </span><span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="données.html#cb51-1" aria-hidden="true"></a>(a &lt;-<span class="st"> </span>T)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Comme le montre l’exemple ci-dessus, il est possible d’abréger <code>TRUE</code> en <code>T</code> ; il en est de même pour <code>FALSE</code>, qui peut s’abéger en <code>F</code>.</p></li>
</ul>

<div class="remarque">
<p>Il peut parfois être pratique d’utiliser le fait que <code>TRUE</code> peut être automatiquement converti en 1 et <code>FALSE</code> en 0.
<code>TRUE + TRUE + FALSE + TRUE*TRUE</code> retournera 3.</p>
</div>
<ul>
<li><p><em>complex</em> (complexe) :
Les nombres complexes sont caractérisés par leur partie réelle, que l’on peut obtenir à l’aide de la fonction <code>Re()</code> ; et par leur partie imaginaire, que l’on obtient grâce à la fonction <code>Im()</code>. On créé un nombre complexe à l’aide de la lettre <code>i</code>.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="données.html#cb53-1" aria-hidden="true"></a>1i</span></code></pre></div>
<pre><code>## [1] 0+1i</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="données.html#cb55-1" aria-hidden="true"></a>z &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">+</span>3i</span>
<span id="cb55-2"><a href="données.html#cb55-2" aria-hidden="true"></a><span class="kw">Re</span>(z) <span class="co"># Partie réelle de z</span></span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="données.html#cb57-1" aria-hidden="true"></a><span class="kw">Im</span>(z) <span class="co"># Partie imaginaire de z</span></span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="données.html#cb59-1" aria-hidden="true"></a><span class="kw">Mod</span>(z) <span class="co"># Module de z</span></span></code></pre></div>
<pre><code>## [1] 3.605551</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="données.html#cb61-1" aria-hidden="true"></a><span class="kw">Arg</span>(z) <span class="co"># Argument de z</span></span></code></pre></div>
<pre><code>## [1] 0.9827937</code></pre></li>
</ul>
</div>
<div id="longueur" class="section level3" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Longueur</h3>
<p>La longueur d’un objet correspond au nombre d’éléments qu’il contient. On utilise la fonction <code>length()</code> pour connaître la longueur d’un objet.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="données.html#cb63-1" aria-hidden="true"></a>a &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb63-2"><a href="données.html#cb63-2" aria-hidden="true"></a><span class="kw">length</span>(a)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>Les données manquantes <code>NA</code> (<em>not available</em>) sont considérées comme étant de type <code>logical</code> par R.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="données.html#cb65-1" aria-hidden="true"></a><span class="kw">typeof</span>(x)</span></code></pre></div>
<pre><code>## [1] &quot;double&quot;</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="données.html#cb67-1" aria-hidden="true"></a><span class="kw">is.na</span>(x)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
</div>
<div id="lobjet-vide" class="section level3" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> L’objet vide</h3>
<p>L’objet <code>NULL</code> représente le vide en R. Il est de mode <code>NULL</code> et de longueur 0. Il ne faut cependant pas le confondre avec un objet vide.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="données.html#cb69-1" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb69-2"><a href="données.html#cb69-2" aria-hidden="true"></a><span class="kw">typeof</span>(x)</span></code></pre></div>
<pre><code>## [1] &quot;NULL&quot;</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="données.html#cb71-1" aria-hidden="true"></a><span class="kw">length</span>(x)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="données.html#cb73-1" aria-hidden="true"></a><span class="kw">is.null</span>(x)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="données.html#cb75-1" aria-hidden="true"></a><span class="kw">is.null</span>(<span class="kw">list</span>()) <span class="co"># La liste vide n&#39;est pas NULL</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
</div>
</div>
<div id="structures" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Structure des données</h2>
<p>Il existe de nombreuses structures servant à organiser les données dans R. Cette introduction à R n’a pas pour vocation de lister toutes celles qui existantent, aussi, seules quelques unes (les principales à mes yeux) sont présentées dans cette section. Pour connaître la structure d’un objet, il est possible d’utiliser la fonction <code></code>class()`.</p>
<div id="structures-de-base" class="section level3" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Structures de base</h3>
<div id="vecteurs" class="section level4" number="2.2.1.1">
<h4><span class="header-section-number">2.2.1.1</span> Vecteurs</h4>
<p>Les vecteurs sont extrêmement employés en R, et sont composés de données de mêmes types. La création d’un vecteur peut se faire à l’aide de la fonction de concaténation <code>c()</code>.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="données.html#cb77-1" aria-hidden="true"></a><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>

<div class="remarque">
Dans l’affichage de la console, <code>[1]</code> indique le rang de l’élément qui le suit dans le vecteur dont le contenu est affiché. La Section <a href="données.html#manip-acces">2.4.2</a>) permettra de mieux comprendre cet affichage.
</div>
<p>Il est possible d’attribuer un nom aux éléments d’un vecteur, soit lors de la création, soit <em>a posteriori</em>, en utilisant la fonction <code>names()</code>.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="données.html#cb79-1" aria-hidden="true"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">nom =</span> <span class="st">&quot;Piketty&quot;</span>, <span class="dt">prenom =</span> <span class="st">&quot;Thomas&quot;</span>, <span class="dt">annee_naissance =</span> <span class="st">&quot;1971&quot;</span>)</span>
<span id="cb79-2"><a href="données.html#cb79-2" aria-hidden="true"></a>a</span></code></pre></div>
<pre><code>##             nom          prenom annee_naissance 
##       &quot;Piketty&quot;        &quot;Thomas&quot;          &quot;1971&quot;</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="données.html#cb81-1" aria-hidden="true"></a>b &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Piketty&quot;</span>, <span class="st">&quot;Thomas&quot;</span>, <span class="st">&quot;1971&quot;</span>)</span>
<span id="cb81-2"><a href="données.html#cb81-2" aria-hidden="true"></a>b</span></code></pre></div>
<pre><code>## [1] &quot;Piketty&quot; &quot;Thomas&quot;  &quot;1971&quot;</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="données.html#cb83-1" aria-hidden="true"></a><span class="kw">names</span>(b) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;nom&quot;</span>, <span class="st">&quot;prenom&quot;</span>, <span class="st">&quot;annee_naissance&quot;</span>)</span>
<span id="cb83-2"><a href="données.html#cb83-2" aria-hidden="true"></a>b</span></code></pre></div>
<pre><code>##             nom          prenom annee_naissance 
##       &quot;Piketty&quot;        &quot;Thomas&quot;          &quot;1971&quot;</code></pre>
<p>Lorsque plusieurs types de données sont mélangés lors de la création du vecteur, R convertit les données dans le type le plus général.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="données.html#cb85-1" aria-hidden="true"></a><span class="kw">c</span>(<span class="st">&quot;deux&quot;</span>, <span class="dv">1</span>, <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;deux&quot; &quot;1&quot;    &quot;TRUE&quot;</code></pre>
<p>La fonction <code>is.vector()</code> retourne <code>TRUE</code> si l’objet passé en argument est un vecteur.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="données.html#cb87-1" aria-hidden="true"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb87-2"><a href="données.html#cb87-2" aria-hidden="true"></a><span class="kw">is.vector</span>(a)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>La fonction <code>length()</code> donne le nombre d’éléments qui composent le vecteur.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="données.html#cb89-1" aria-hidden="true"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb89-2"><a href="données.html#cb89-2" aria-hidden="true"></a><span class="kw">length</span>(a)</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
</div>
<div id="facteurs" class="section level4" number="2.2.1.2">
<h4><span class="header-section-number">2.2.1.2</span> Facteurs</h4>
<p>Les travaux d’économétrie requièrent souvent l’emploi de variables <em>qualitatives</em>. R possède une structure qui gère ces variables : <code>factor</code>. On utilise la fonction <code>factor()</code> pour encoder un vecteur en facteur.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="données.html#cb91-1" aria-hidden="true"></a>pays &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;France&quot;</span>, <span class="st">&quot;France&quot;</span>, <span class="st">&quot;Chine&quot;</span>, <span class="st">&quot;Espagne&quot;</span>, <span class="st">&quot;Chine&quot;</span>))</span>
<span id="cb91-2"><a href="données.html#cb91-2" aria-hidden="true"></a>pays</span></code></pre></div>
<pre><code>## [1] France  France  Chine   Espagne Chine  
## Levels: Chine Espagne France</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="données.html#cb93-1" aria-hidden="true"></a><span class="kw">class</span>(pays)</span></code></pre></div>
<pre><code>## [1] &quot;factor&quot;</code></pre>
<p>La fonction <code>levels()</code> retourne les niveaux du facteur.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="données.html#cb95-1" aria-hidden="true"></a><span class="kw">levels</span>(pays)</span></code></pre></div>
<pre><code>## [1] &quot;Chine&quot;   &quot;Espagne&quot; &quot;France&quot;</code></pre>
<p>Lors des analyses, il arrive de vouloir choisir la modalité de réféfence plutôt que de laisser R le faire automatiquement. Il suffit alors d’utiliser la fonction <code>relevel()</code>. Il faut toutefois ne pas oublier de réassigner le résultat à l’objet !</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="données.html#cb97-1" aria-hidden="true"></a>pays &lt;-<span class="st"> </span><span class="kw">relevel</span>(pays, <span class="dt">ref =</span> <span class="st">&quot;Espagne&quot;</span>)</span>
<span id="cb97-2"><a href="données.html#cb97-2" aria-hidden="true"></a>pays</span></code></pre></div>
<pre><code>## [1] France  France  Chine   Espagne Chine  
## Levels: Espagne Chine France</code></pre>
<p>Si les variables catégorielles sont ordonnées, R propose la fonction <code>ordered()</code>.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="données.html#cb99-1" aria-hidden="true"></a>revenus &lt;-<span class="st"> </span></span>
<span id="cb99-2"><a href="données.html#cb99-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">ordered</span>(<span class="kw">c</span>(<span class="st">&quot;&lt;1500&quot;</span>, <span class="st">&quot;&gt;2000&quot;</span>, <span class="st">&quot;&gt;2000&quot;</span>, <span class="st">&quot;1500-2000&quot;</span>, <span class="st">&quot;&gt;2000&quot;</span>, <span class="st">&quot;&lt;1500&quot;</span>),</span>
<span id="cb99-3"><a href="données.html#cb99-3" aria-hidden="true"></a>          <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;&lt;1500&quot;</span>, <span class="st">&quot;1500-2000&quot;</span>, <span class="st">&quot;&gt;2000&quot;</span>))</span>
<span id="cb99-4"><a href="données.html#cb99-4" aria-hidden="true"></a>revenus</span></code></pre></div>
<pre><code>## [1] &lt;1500     &gt;2000     &gt;2000     1500-2000 &gt;2000     &lt;1500    
## Levels: &lt;1500 &lt; 1500-2000 &lt; &gt;2000</code></pre>
</div>
<div id="structure-dates" class="section level4" number="2.2.1.3">
<h4><span class="header-section-number">2.2.1.3</span> Dates</h4>
<p>On note trois principales classes pour représenter des dates en R :</p>
<ul>
<li><em>Date</em> : adapté pour les dates, uniquement celles pour lesquelles on ne possède pas d’informations à propos de l’heure (e.g., <code>1977-05-27</code>);</li>
<li><em>POSIXct</em> et <em>POSIXlt</em> : pour les dates avec des heures (e.g., <code>1977-05-27 20:00:00</code>).</li>
</ul>
<div id="dates" class="section level5" number="2.2.1.3.1">
<h5><span class="header-section-number">2.2.1.3.1</span> Dates</h5>
<p>Les dates sont stoquées comme le nombre de jours depuis <code>1970-01-01</code>, avec des valeurs négatives pour des dates antérieures. Le format d’affichage est celui du calendrier grégorien.</p>
<p>La fonction <code>as.Date()</code> convertit une chaîne de caratcères en date. Si le format est de la forme <code>%Y-%m-%d</code> ou <code>%Y/%m/%d</code> (avec <code>%Y</code> l’année avec le siècle, <code>%m</code> le mois sur deux chiffres et <code>%d</code> le jour sur deux chiffres), il n’est pas nécessaire de renseigner l’argument <code>format</code> de la fonction. L’argument <code>origin</code> permet quant à lui de préciser une origine différente de <code>1970-01-01</code>.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="données.html#cb101-1" aria-hidden="true"></a>(d &lt;-<span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2020-10-21&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;2020-10-21&quot;</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="données.html#cb103-1" aria-hidden="true"></a><span class="kw">class</span>(d)</span></code></pre></div>
<pre><code>## [1] &quot;Date&quot;</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="données.html#cb105-1" aria-hidden="true"></a><span class="kw">unclass</span>(d)</span></code></pre></div>
<pre><code>## [1] 18556</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="données.html#cb107-1" aria-hidden="true"></a><span class="co"># La date du jour</span></span>
<span id="cb107-2"><a href="données.html#cb107-2" aria-hidden="true"></a><span class="kw">as.Date</span>(<span class="kw">Sys.time</span>())</span></code></pre></div>
<pre><code>## [1] &quot;2020-10-19&quot;</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="données.html#cb109-1" aria-hidden="true"></a><span class="co"># Avec un format non standard</span></span>
<span id="cb109-2"><a href="données.html#cb109-2" aria-hidden="true"></a>(d &lt;-<span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2020 21 10&quot;</span>, <span class="dt">format =</span> (<span class="st">&quot;%Y %d %m&quot;</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;2020-10-21&quot;</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="données.html#cb111-1" aria-hidden="true"></a>(d &lt;-<span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;21 Octobre, 2020&quot;</span>, <span class="dt">format =</span> (<span class="st">&quot;%d %B, %Y&quot;</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;2020-10-21&quot;</code></pre>
<p>La fonction <code>unclass()</code> utilisée dans le précédent exemple permet de voir la valeur stockée en interne.</p>
<p>Comme on peut le voir dans le précédent exemple, l’argument <code>format</code> a été utilisé. Cet argument permet de préciser comment la date est écrite dans la chaîne de caractères, pour que la conversion en objet de classe <code>date</code> soit possible. Cette conversion est réalisée, en interne, par la fonction<code>strptime()</code>. La page d’aide de cette fonction (<code>?strptime</code>) donne les différents codes qui spécifient les formats de date. Attention, certains de ces formats dépendent d’arguments locaux à la machine (des exemples sont donnés plus loin).</p>
<p>Les codes spécifiant les formats de date sont consignés dans le tableau suivant.</p>
<table>
<colgroup>
<col width="21%" />
<col width="46%" />
<col width="32%" />
</colgroup>
<thead>
<tr class="header">
<th>Code</th>
<th>Description</th>
<th>Exemple</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>%a</code></td>
<td>Abréviation du jour de la semaine (dépend du lieu)</td>
<td>Mer</td>
</tr>
<tr class="even">
<td><code>%A</code></td>
<td>Jour de la semaine complet (dépend du lieu)</td>
<td>Mercredi</td>
</tr>
<tr class="odd">
<td><code>%b</code></td>
<td>Abréviation du mois (dépend du lieu)</td>
<td>oct</td>
</tr>
<tr class="even">
<td><code>%B</code></td>
<td>Nom du mois complet (dépend du lieu)</td>
<td>octobre</td>
</tr>
<tr class="odd">
<td><code>%c</code></td>
<td>Date et heure (dépend du lieu) au format <code>%a %e %b %H:%M:%S %Y</code></td>
<td>Mer 21 oct 13:55:44 2020</td>
</tr>
<tr class="even">
<td><code>%C</code></td>
<td>Siècle (00-99) -1 (partie entière de la division de l’année par 100)</td>
<td>20</td>
</tr>
<tr class="odd">
<td><code>%d</code></td>
<td>Jour du mois (01–31)</td>
<td>21</td>
</tr>
<tr class="even">
<td><code>%D</code></td>
<td>Date au format <code>%m/%d/%y</code></td>
<td>10/21/20</td>
</tr>
<tr class="odd">
<td><code>%e</code></td>
<td>Jour du mois en nombre décimal (1–31)</td>
<td>21</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><code>%F</code></td>
<td>Date au format <code>%Y-%m-%d</code></td>
<td>2020-10-21</td>
</tr>
<tr class="even">
<td><code>%h</code></td>
<td>Même chose que <code>%b</code></td>
<td>oct</td>
</tr>
<tr class="odd">
<td><code>%H</code></td>
<td>Heure (00–24)</td>
<td>13</td>
</tr>
<tr class="even">
<td><code>%I</code></td>
<td>Heure (01–12)</td>
<td>01</td>
</tr>
<tr class="odd">
<td><code>%j</code></td>
<td>Jour de l’année (001–366)</td>
<td>295</td>
</tr>
<tr class="even">
<td><code>%m</code></td>
<td>Mois (01–12)</td>
<td>10</td>
</tr>
<tr class="odd">
<td><code>%M</code></td>
<td>Minute (00-59)</td>
<td>55</td>
</tr>
<tr class="even">
<td><code>%n</code></td>
<td>Retour à la ligne en <em>output</em>, caractère blanc en <em>input</em></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><code>%p</code></td>
<td>AM/PM</td>
<td>PM</td>
</tr>
<tr class="odd">
<td><code>%r</code></td>
<td>Heure au format 12 AM/PM</td>
<td><code>format(d, "%r")</code></td>
</tr>
<tr class="even">
<td><code>%R</code></td>
<td>Même chose que <code>%H:%M</code></td>
<td>13:55</td>
</tr>
<tr class="odd">
<td><code>%S</code></td>
<td>Seconde (00-61)</td>
<td>44</td>
</tr>
<tr class="even">
<td><code>%t</code></td>
<td>Tabulation en <em>output</em>, caractère blanc en <em>input</em></td>
<td></td>
</tr>
<tr class="odd">
<td><code>%T</code></td>
<td>Même chose que <code>%H:%M:%S</code></td>
<td>13:55:44</td>
</tr>
<tr class="even">
<td><code>%u</code></td>
<td>Jour de la semaine (1–7), commence le lundi</td>
<td>3</td>
</tr>
<tr class="odd">
<td><code>%U</code></td>
<td>Semaine de l’anné (00–53), dimanche comme début de semaine, et le premier dimanche de l’année définit la semaine 1</td>
<td>42</td>
</tr>
<tr class="even">
<td><code>%V</code></td>
<td>Semaine de l’année (00-53). Si la semaine (qui commence un lundi) qui contient le <span class="math inline">\(1^\textrm{er}\)</span> janvier a quatre jours ou plus dans la nouvelle année, alors elle est considérée comme la semaine 1. Sinon, elle est considérée comme la dernière de l’année précédente, et la semaine suivante est considérée comme semaine 1 (norme ISO 8601)</td>
<td>43</td>
</tr>
<tr class="odd">
<td><code>%w</code></td>
<td>Jour de la semaine (0–6), dimanche étant 0</td>
<td>3</td>
</tr>
<tr class="even">
<td><code>%W</code></td>
<td>Semaine de l’année (00–53), le lundi étant le premier jour de la semaine, et typiquement, le premier lundi de l’année définit la semaine 1 (conviention G.B.)</td>
<td>42</td>
</tr>
<tr class="odd">
<td><code>%x</code></td>
<td>Date (dépend du lieu)</td>
<td>21.10.2020</td>
</tr>
<tr class="even">
<td><code>%X</code></td>
<td>Heure (dépend du lieu)</td>
<td>13:55:44</td>
</tr>
<tr class="odd">
<td><code>%y</code></td>
<td>Année sans le siècle (00–99)</td>
<td>20</td>
</tr>
<tr class="even">
<td><code>%Y</code></td>
<td>Année (en input, uniquement de 0 à 9999)</td>
<td>2020</td>
</tr>
<tr class="odd">
<td><code>%z</code></td>
<td>offset en heures et minutes par rapport au temps UTC</td>
<td>+0200</td>
</tr>
<tr class="even">
<td><code>%Z</code></td>
<td>Abréviation du fuseau horraire (en output seulement)</td>
<td>CEST</td>
</tr>
</tbody>
</table>
</div>
<div id="dates-POSIXct" class="section level5" number="2.2.1.3.2">
<h5><span class="header-section-number">2.2.1.3.2</span> POSIXct et POSIXlt</h5>
<p>Si les dates à représenter contiennent des heures, il faut préférer le format <em>POSIXct</em> ou <em>POSIXlt</em>. Avec <em>POSIXct</em>, les dates sont stockées en secondes depuis les débuts d’Unix (<code>1970-01-01 01:00:00</code>). Avec <em>POSIXlt</em>, les dates sont stockées sous forme de liste dont les éléments correspondent à différentes composantes de la date (voir le tableau ci-dessous). Les fonctions <code>as.POSIXct()</code> et <code>as.POSIXlt()</code> permettent de convertir une chaîne de caractère représentant une date en objet <code>POSIXct</code> ou <code>POSIXlt</code>. à nouveau, la fonction <code>strptime()</code> est utilisée en interne pour réaliser la conversion des chaînes de caractères en dates.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="données.html#cb113-1" aria-hidden="true"></a><span class="co"># POSIXct</span></span>
<span id="cb113-2"><a href="données.html#cb113-2" aria-hidden="true"></a>d &lt;-<span class="st"> </span><span class="kw">as.POSIXct</span>(<span class="st">&quot;2015-10-21 13:55:44&quot;</span>)</span>
<span id="cb113-3"><a href="données.html#cb113-3" aria-hidden="true"></a><span class="kw">unclass</span>(d)</span></code></pre></div>
<pre><code>## [1] 1445428544
## attr(,&quot;tzone&quot;)
## [1] &quot;&quot;</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="données.html#cb115-1" aria-hidden="true"></a><span class="kw">unclass</span>(<span class="kw">as.POSIXct</span>(<span class="st">&quot;1970-01-01 01:00:00&quot;</span>))</span></code></pre></div>
<pre><code>## [1] 0
## attr(,&quot;tzone&quot;)
## [1] &quot;&quot;</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="données.html#cb117-1" aria-hidden="true"></a><span class="co"># POSIXlt</span></span>
<span id="cb117-2"><a href="données.html#cb117-2" aria-hidden="true"></a>d &lt;-<span class="st"> </span><span class="kw">as.POSIXlt</span>(<span class="st">&quot;2015-10-21 13:55:44&quot;</span>)</span>
<span id="cb117-3"><a href="données.html#cb117-3" aria-hidden="true"></a><span class="kw">unlist</span>(<span class="kw">unclass</span>(d))</span></code></pre></div>
<pre><code>##    sec    min   hour   mday    mon   year   wday   yday  isdst   zone gmtoff 
##   &quot;44&quot;   &quot;55&quot;   &quot;13&quot;   &quot;21&quot;    &quot;9&quot;  &quot;115&quot;    &quot;3&quot;  &quot;293&quot;    &quot;1&quot; &quot;CEST&quot;     NA</code></pre>
<p>Les éléments de la liste d’un objet de classe <code>POSIXlt</code> sont répertoriés dans le tableau suivant (voir page d’aide <code>?DateTimeClasses</code>).</p>
<table>
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Code</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>sec</code></td>
<td align="left">secondes (0–61)</td>
</tr>
<tr class="even">
<td align="left"><code>min</code></td>
<td align="left">minutes (0–59)</td>
</tr>
<tr class="odd">
<td align="left"><code>hour</code></td>
<td align="left">heures (0–23)</td>
</tr>
<tr class="even">
<td align="left"><code>mday</code></td>
<td align="left">jour du mois (1–31)</td>
</tr>
<tr class="odd">
<td align="left"><code>mon</code></td>
<td align="left">mois après le premier de l’année (0–11)</td>
</tr>
<tr class="even">
<td align="left"><code>year</code></td>
<td align="left">années depuis 1900</td>
</tr>
<tr class="odd">
<td align="left"><code>wday</code></td>
<td align="left">jour de la semaine (0–6), début de semaine le dimanche</td>
</tr>
<tr class="even">
<td align="left"><code>yday</code></td>
<td align="left">jour de l’année (0–365)</td>
</tr>
<tr class="odd">
<td align="left"><code>isdst</code></td>
<td align="left">indicateur d’heure d’été (positif si appliquable, zéro sinon ; néi inconnu)</td>
</tr>
<tr class="even">
<td align="left"><code>zone</code></td>
<td align="left">Abréviation du fuseau horaire local (<code>""</code> si inconnu, ou UTC)</td>
</tr>
<tr class="odd">
<td align="left"><code>gmtoff</code></td>
<td align="left">décalage en minutes par rapport au temps GMT (<code>NA</code> ou</td>
</tr>
</tbody>
</table>
<p>Le <em>package</em> {<code>lubridate</code>} propose également des fonctions pour gérer les dates. Il est pratique de charger le <em>package</em> en mémoire.</p>
<p>Pour convertir une chaîne de caractères représentant une date, il suffit d’utiliser une des trois fonctions suivantes : <code>ymd()</code>, <code>mdy()</code> et <code>dmy()</code>. Les trois lettres de ces fonctions font référence à l’année (<code>y</code> – <em>year</em>), le mois (<code>m</code> – <em>month</em>) et le jour (<code>d</code> – <em>day</em>). La position de ces lettres dans le nom de la fonction doit correspondre à celui des éléments correspondants dans la chaîne de caractères. Ainsi, <code>ymd()</code> s’attend à trouver d’abord l’année, puis le mois et enfin le jour dans la chaîne de caractères. Le gros avantage de ces fonctions est qu’il n’est pas nécessaire de préciser les séparateurs, une analyse est faite automatiquement pour le deviner.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="données.html#cb119-1" aria-hidden="true"></a><span class="kw">library</span>(lubridate)</span>
<span id="cb119-2"><a href="données.html#cb119-2" aria-hidden="true"></a><span class="kw">ymd</span>(<span class="st">&quot;2015-10-21&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2015-10-21&quot;</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="données.html#cb121-1" aria-hidden="true"></a><span class="kw">mdy</span>(<span class="st">&quot;10.21-15&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2015-10-21&quot;</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="données.html#cb123-1" aria-hidden="true"></a><span class="kw">dmy</span>(<span class="st">&quot;21 oct 2015&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2015-10-21&quot;</code></pre>
<p>Il est possible de préciser le fuseau horaire (à condition que le nom soit reconnu par le système d’exploitation), en renseignant l’argument <code>tz</code>.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="données.html#cb125-1" aria-hidden="true"></a><span class="kw">ymd</span>(<span class="st">&quot;2015-10-21&quot;</span>, <span class="dt">tz =</span> <span class="st">&quot;Pacific/Auckland&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2015-10-21 NZDT&quot;</code></pre>

<div class="remarque">
La fonction <code>OlsonNames()</code> retourne un vecteur contenant tous les fuseaux horaires disponibles.
</div>
<p>S’il y a des informations d’heures dans les chaînes de caractères repésentant les dates, il suffit d’ajouter <code>h</code> (heures), ou <code>hm</code> (heures et minutes) ou <code>hms</code> (heures, minutes et secondes) au nom de la fonction, en séparant par un trait de soulignement.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="données.html#cb127-1" aria-hidden="true"></a><span class="kw">ymd_hms</span>(<span class="st">&quot;2015-10-21 10:00:50&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2015-10-21 10:00:50 UTC&quot;</code></pre>
</div>
</div>
<div id="structures-base-matrices" class="section level4" number="2.2.1.4">
<h4><span class="header-section-number">2.2.1.4</span> Matrices</h4>
<p>Les matrices sont des vecteurs auxquels un attribut <code>dim</code> de dimension est ajouté. Une matrice est un vecteur pour lequel l’attribut <code>dim</code> est de longueur 2. La fonction <code>matrix()</code> permet de créer une matrice en R. Le code ci-après stoque dans <code>X</code> une matrice de 3 lignes (<code>nrow = 3</code>) et de 2 colonnes (<code>ncol = 2</code>). Cette matrice est remplie par colonnes successives par les éléments du vecteur <code>1:6</code>.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="données.html#cb129-1" aria-hidden="true"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb129-2"><a href="données.html#cb129-2" aria-hidden="true"></a>X</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    4
## [2,]    2    5
## [3,]    3    6</code></pre>
<p>Pour que la matrice soit remplie par lignes successives plutôt que par colonne, il suffit d’ajouter l’argument <code>byrow</code> à la fonction <code>matrix()</code> et de lui donner la valeur <code>TRUE</code>.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="données.html#cb131-1" aria-hidden="true"></a>Y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</span>
<span id="cb131-2"><a href="données.html#cb131-2" aria-hidden="true"></a>Y</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    2
## [2,]    3    4
## [3,]    5    6</code></pre>
<p>Lorsque la dimension dépasse 2, on parle de tableau (<em>array</em>). Par exemple, le code ci-après permet de créer un tableau de dimension <span class="math inline">\(2\times 4 \times 3\)</span>.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="données.html#cb133-1" aria-hidden="true"></a>Z &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">3</span>))</span>
<span id="cb133-2"><a href="données.html#cb133-2" aria-hidden="true"></a>Z</span></code></pre></div>
<pre><code>## , , 1
## 
##      [,1] [,2] [,3] [,4]
## [1,]    1    3    5    7
## [2,]    2    4    6    8
## 
## , , 2
## 
##      [,1] [,2] [,3] [,4]
## [1,]    9   11   13   15
## [2,]   10   12   14   16
## 
## , , 3
## 
##      [,1] [,2] [,3] [,4]
## [1,]   17   19   21   23
## [2,]   18   20   22   24</code></pre>
<p>Pour les matrices comme pour les tableaux, les données doivent toutes être du même type.</p>
<p>Les fonctions <code>nrow()</code> et <code>ncol()</code> donnent le nombre de lignes (<code>rows</code>) et de colonnes (<code>columns</code>) d’une matrice. La fonction <code>dim()</code> donne un vecteur contenant les dimensions de la matrice ou du tableau donné en argument.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="données.html#cb135-1" aria-hidden="true"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb135-2"><a href="données.html#cb135-2" aria-hidden="true"></a><span class="kw">dim</span>(X)</span></code></pre></div>
<pre><code>## [1] 3 2</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="données.html#cb137-1" aria-hidden="true"></a><span class="kw">nrow</span>(X)</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="données.html#cb139-1" aria-hidden="true"></a><span class="kw">ncol</span>(X)</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
</div>
<div id="listes" class="section level4" number="2.2.1.5">
<h4><span class="header-section-number">2.2.1.5</span> Listes</h4>
<p>Les listes dans R sont les structures les moins rigides. Elles peuvent contenir des éléments de modes différents, y compris des listes. Le mode des éléments de la liste n’est pas altéré, ce qui peut s’avérer utile dans certains cas.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="données.html#cb141-1" aria-hidden="true"></a>(personne &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;Piketty&quot;</span>, <span class="st">&quot;Thomas&quot;</span>, <span class="st">&quot;1971&quot;</span>))</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;Piketty&quot;
## 
## [[2]]
## [1] &quot;Thomas&quot;
## 
## [[3]]
## [1] &quot;1971&quot;</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="données.html#cb143-1" aria-hidden="true"></a><span class="kw">class</span>(personne)</span></code></pre></div>
<pre><code>## [1] &quot;list&quot;</code></pre>
<p>Comme pour les vecteurs, il est possible de nommer les éléments de la liste, ce qui permet une meilleure lecture et un accès aux données parfois plus pratique. La Section @ref(donnees_manipulation) apportera plus de détails à ce propos.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="données.html#cb145-1" aria-hidden="true"></a>personne &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;nom de famille&quot;</span> =<span class="st"> &quot;Piketty&quot;</span>,</span>
<span id="cb145-2"><a href="données.html#cb145-2" aria-hidden="true"></a>                 <span class="dt">prenom =</span> <span class="st">&quot;Thomas&quot;</span>,</span>
<span id="cb145-3"><a href="données.html#cb145-3" aria-hidden="true"></a>                 <span class="dt">annee =</span> <span class="dv">1971</span>)</span>
<span id="cb145-4"><a href="données.html#cb145-4" aria-hidden="true"></a>personne</span></code></pre></div>
<pre><code>## $`nom de famille`
## [1] &quot;Piketty&quot;
## 
## $prenom
## [1] &quot;Thomas&quot;
## 
## $annee
## [1] 1971</code></pre>
<p>Pour aplatir une liste, R propose une fonction : <code>unlist()</code>. Cette fonction retourne un vecteur contenant tous les composants de la liste. Il faut toutefois garder à l’esprit que R se charge alors de convertir tous les éléments dans le mode le plus général. De fait, si cette fonction peut s’avérer pratique dans le cas de scalaires par exemple, elle peut également être destructrice lorsque mal employée.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="données.html#cb147-1" aria-hidden="true"></a><span class="kw">unlist</span>(personne)</span></code></pre></div>
<pre><code>## nom de famille         prenom          annee 
##      &quot;Piketty&quot;       &quot;Thomas&quot;         &quot;1971&quot;</code></pre>
</div>
</div>
<div id="tableaux-de-données" class="section level3" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Tableaux de données</h3>
<div id="data-frames" class="section level4" number="2.2.2.1">
<h4><span class="header-section-number">2.2.2.1</span> Data Frames</h4>
<p>Les tableaux de données sont au cœur de nombreuses procédures dans R notemment lorsqu’on estimes des modèles économétriques.</p>
<p>Traditionnellement, la structure adaptée aux données rectangulaires (variables en colonnes et observations en lignes) est ce que l’on appelle les <em>data frames</em>. Du fait de l’évolution des besoins ces dernières années, les <em>data frames</em>, bien qu’elles demeurent largement utilisées, tendent à être remplacées par les <em>tibbles</em> (cf La Section <a href="#donnees-tibbles"><strong>??</strong></a> pour découvrir cette structure similaire et comprendre pourquoi les <em>tibbles</em> remplacent progressivement les <em>data frames</em>).</p>
<p>Un <em>data frame</em> est une liste composée d’un ou plusieurs vecteurs de même longueur. Le mode des vecteurs n’est pas nécessairement identique à celui des autres. Une manière simple de se représenter les tableaux de données est de penser à une matrice dans laquelle les lignes représentent des individus et les colonnes des caractéristiques propres à ces individus. La création d’un tableau de données se fait <em>via</em> la fonction <em>data.frame()</em>. La fonction <em>as.data.frame()</em> permet quant à elle de convertir un objet d’un autre type en <em>data frame</em>.</p>
<p>L’exemple ci-après utilise les données du <em>dataset</em> <code>women</code>, présent dans le <em>package</em> {<code>datasets</code>}. Il s’agit de la taille (en pouces) et du poids (en livres) moyen des femmes américaines âgées entre 30 et 39 ans.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="données.html#cb149-1" aria-hidden="true"></a>femmes &lt;-<span class="st"> </span></span>
<span id="cb149-2"><a href="données.html#cb149-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">data.frame</span>(<span class="dt">height =</span> <span class="kw">c</span>(<span class="dv">58</span>, <span class="dv">59</span>, <span class="dv">60</span>, <span class="dv">61</span>, <span class="dv">62</span>, <span class="dv">63</span>, <span class="dv">64</span>,</span>
<span id="cb149-3"><a href="données.html#cb149-3" aria-hidden="true"></a>                        <span class="dv">65</span>, <span class="dv">66</span>, <span class="dv">67</span>, <span class="dv">68</span>, <span class="dv">69</span>, <span class="dv">70</span>, <span class="dv">71</span>, <span class="dv">72</span>),</span>
<span id="cb149-4"><a href="données.html#cb149-4" aria-hidden="true"></a>           <span class="dt">weight =</span> <span class="kw">c</span>(<span class="dv">115</span>, <span class="dv">117</span>, <span class="dv">120</span>, <span class="dv">123</span>, <span class="dv">126</span>, <span class="dv">129</span>,<span class="dv">132</span>, </span>
<span id="cb149-5"><a href="données.html#cb149-5" aria-hidden="true"></a>                      <span class="dv">135</span>, <span class="dv">139</span>, <span class="dv">142</span>, <span class="dv">146</span>, <span class="dv">150</span>, <span class="dv">154</span>, <span class="dv">159</span>, <span class="dv">164</span>))</span>
<span id="cb149-6"><a href="données.html#cb149-6" aria-hidden="true"></a>femmes</span></code></pre></div>
<pre><code>##    height weight
## 1      58    115
## 2      59    117
## 3      60    120
## 4      61    123
## 5      62    126
## 6      63    129
## 7      64    132
## 8      65    135
## 9      66    139
## 10     67    142
## 11     68    146
## 12     69    150
## 13     70    154
## 14     71    159
## 15     72    164</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="données.html#cb151-1" aria-hidden="true"></a><span class="kw">is.data.frame</span>(femmes)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="données.html#cb153-1" aria-hidden="true"></a><span class="kw">class</span>(femmes)</span></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<p>Comme pour les matrices, on peut obtenir les dimensions d’un <em>data frame</em> avec la fonction <code>dim()</code>, le nombre de lignes avec <code>nrow()</code> et le nombre de colonnes avec <code>ncol()</code>.</p>
</div>
<div id="donees-tibbles" class="section level4" number="2.2.2.2">
<h4><span class="header-section-number">2.2.2.2</span> Tibbles</h4>
<p>Lorsque le volume des données devient conséquent, les <em>data frames</em> deviennt désagréables à manipuler. Par exemple, lorque l’on tente d’appeler un <em>data frame</em> dans la console, R tente d’aficher un maximum de lignes, puis finit par s’arrêter à la millième. Lorsque le nombre d’observation est important, il n’est pas rare que cet affichage provoque un très long temps d’attente. Une strucutre plus récente, les <em>tibbles</em>, gère ce genre de soucis en affichant uniquement un extrait plus court. Les <em>tibbles</em> (<em>package</em> {<code>tibble</code>}) font partie de l’ensemble de <em>packages</em> de l’environnement <em>tidyverse</em>.</p>
<p>La création d’un <em>tibble</em> est similaire à celle d’un <em>data.frame</em>.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="données.html#cb155-1" aria-hidden="true"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb155-2"><a href="données.html#cb155-2" aria-hidden="true"></a>femmes_tibble &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">height =</span> <span class="kw">c</span>(<span class="dv">58</span>, <span class="dv">59</span>, <span class="dv">60</span>, <span class="dv">61</span>, <span class="dv">62</span>, <span class="dv">63</span>, <span class="dv">64</span>, <span class="dv">65</span>,</span>
<span id="cb155-3"><a href="données.html#cb155-3" aria-hidden="true"></a>                                <span class="dv">66</span>, <span class="dv">67</span>, <span class="dv">68</span>, <span class="dv">69</span>, <span class="dv">70</span>, <span class="dv">71</span>, <span class="dv">72</span>),</span>
<span id="cb155-4"><a href="données.html#cb155-4" aria-hidden="true"></a>                     <span class="dt">weight =</span> <span class="kw">c</span>(<span class="dv">115</span>, <span class="dv">117</span>, <span class="dv">120</span>, <span class="dv">123</span>, <span class="dv">126</span>, <span class="dv">129</span>, <span class="dv">132</span>,</span>
<span id="cb155-5"><a href="données.html#cb155-5" aria-hidden="true"></a>                                <span class="dv">135</span>, <span class="dv">139</span>, <span class="dv">142</span>, <span class="dv">146</span>, <span class="dv">150</span>, <span class="dv">154</span>, <span class="dv">159</span>, <span class="dv">164</span>))</span>
<span id="cb155-6"><a href="données.html#cb155-6" aria-hidden="true"></a>femmes_tibble</span></code></pre></div>
<pre><code>## # A tibble: 15 x 2
##    height weight
##     &lt;dbl&gt;  &lt;dbl&gt;
##  1     58    115
##  2     59    117
##  3     60    120
##  4     61    123
##  5     62    126
##  6     63    129
##  7     64    132
##  8     65    135
##  9     66    139
## 10     67    142
## 11     68    146
## 12     69    150
## 13     70    154
## 14     71    159
## 15     72    164</code></pre>
<p>Lorsqu’un <em>tibble</em> est créé, le nom des colonnes n’est pas modifié s’il ne respecte pas les anciennes règles de nommage (à condition d’utiliser les accents graves pour définir le nom).</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="données.html#cb157-1" aria-hidden="true"></a><span class="kw">tibble</span>(<span class="st">`</span><span class="dt">1essai!</span><span class="st">`</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>))</span></code></pre></div>
<pre><code>## # A tibble: 5 x 1
##   `1essai!`
##       &lt;dbl&gt;
## 1         1
## 2         2
## 3         3
## 4         4
## 5         5</code></pre>
<p>Les lignes ne sont pas nommées, elles sont simplement numérotées.</p>
<p>On peut noter que les vecteurs de longueur 1 seront recyclés, c’est-à-dire que la valeur sera répétée le nombre de lignes du tableau final.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="données.html#cb159-1" aria-hidden="true"></a><span class="kw">tibble</span>(<span class="dt">col_deux =</span> <span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>),</span>
<span id="cb159-2"><a href="données.html#cb159-2" aria-hidden="true"></a>       <span class="dt">col_trois =</span> <span class="dv">0</span>,)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 2
##   col_deux col_trois
##      &lt;dbl&gt;     &lt;dbl&gt;
## 1        6         0
## 2        7         0
## 3        8         0
## 4        9         0
## 5       10         0</code></pre>
<p>Il est intéressant de noter qu’il est possible de faire appel au nom d’une colonne qui vient d’être créée, lors de la création d’un <em>tibble</em>, ce qui n’est pas réalisable avec un <em>data frame</em>.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="données.html#cb161-1" aria-hidden="true"></a><span class="kw">tibble</span>(</span>
<span id="cb161-2"><a href="données.html#cb161-2" aria-hidden="true"></a>  <span class="st">`</span><span class="dt">1essai!</span><span class="st">`</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>),</span>
<span id="cb161-3"><a href="données.html#cb161-3" aria-hidden="true"></a>  <span class="dt">col_deux =</span> <span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>),</span>
<span id="cb161-4"><a href="données.html#cb161-4" aria-hidden="true"></a>  <span class="dt">col_trois =</span> <span class="dv">0</span>,</span>
<span id="cb161-5"><a href="données.html#cb161-5" aria-hidden="true"></a>  <span class="dt">test =</span> <span class="st">`</span><span class="dt">1essai!</span><span class="st">`</span> <span class="op">+</span><span class="st"> </span>col_deux)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 4
##   `1essai!` col_deux col_trois  test
##       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
## 1         1        6         0     7
## 2         2        7         0     9
## 3         3        8         0    11
## 4         4        9         0    13
## 5         5       10         0    15</code></pre>
<p>Un <em>data frame</em> peut aisément être converti en <em>tibble</em>, à l’aide de la fonction <code>as_tibble()</code>.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="données.html#cb163-1" aria-hidden="true"></a>femmes_tibble_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(femmes)</span>
<span id="cb163-2"><a href="données.html#cb163-2" aria-hidden="true"></a>femmes_tibble_<span class="dv">2</span></span></code></pre></div>
<pre><code>## # A tibble: 15 x 2
##    height weight
##     &lt;dbl&gt;  &lt;dbl&gt;
##  1     58    115
##  2     59    117
##  3     60    120
##  4     61    123
##  5     62    126
##  6     63    129
##  7     64    132
##  8     65    135
##  9     66    139
## 10     67    142
## 11     68    146
## 12     69    150
## 13     70    154
## 14     71    159
## 15     72    164</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="données.html#cb165-1" aria-hidden="true"></a><span class="kw">class</span>(femmes_tibble_<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<p>Pour comprendre pourquoi les <em>tibbles</em> ont tendance à remplacer les <em>data frames</em>, il est possible d’avancer les raisons suivantes (il en existe d’autres, mais à ce stade de la lecture de ces notes, cela ferait intervenir des concepts qui ne seront abordés que plus loin) :</p>
<ul>
<li>Lorsque l’on affiche un <em>tibble</em> en évaluant son nom dans la console, R n’affichera que les 10 premières lignes et l’ensemble des colonnes qui peuvent s’afficher sur l’écran ;</li>
<li>Le mode des colonnes est décrit lors de l’affichage ;</li>
<li>Une coloration syntaxique est proposée pour visualiser plus facilement les contenus.</li>
</ul>
<p>Si l’on désire afficher davantage de lignes d’un <em>tibbles</em> dans la console que ce qui est proposé par défaut, il est possible de modifier les options de R, à l’aide de la fonction <code>options()</code>.</p>
<p>Si le <em>tibble</em> est composé de plus de <code>n</code> lignes et que l’on souhaite afficher les <code>m</code> premières, il faut procéder comme suit :</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="données.html#cb167-1" aria-hidden="true"></a><span class="kw">options</span>(<span class="dt">tibble.print_max =</span> n, <span class="dt">tibble.print_min =</span> m)</span></code></pre></div>
<p>L’affichage restreint le nombre de colonnes dans la console. Pour en afficher davantage, il faut modifier l’argument <code>tibble.width</code>. Par exemple, pour retourner toutes les colonnes, il faut procéder comme suit (attention, le code suivant n’est pas adapté en présence de volumes de données avec un nombre de variables très important) :</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="données.html#cb168-1" aria-hidden="true"></a><span class="kw">options</span>(<span class="dt">tibble.width =</span> <span class="ot">Inf</span>)</span></code></pre></div>
</div>
<div id="data-table" class="section level4" number="2.2.2.3">
<h4><span class="header-section-number">2.2.2.3</span> Data table</h4>
<p>Le <em>package</em> {<code>data.table</code>} propose une structure de données appelée <em>data.table</em>[^La vignette d’introduction qui accompagne le <em>package</em> est très bien faite : <a href="https://cran.r-project.org/web/packages/data.table/vignettes/datatable-intro.html" class="uri">https://cran.r-project.org/web/packages/data.table/vignettes/datatable-intro.html</a>.], qui se veut être une alternative aux objets <em>data frame</em> et <em>tibbles</em>. Il faut toutefois noter qu’un objet de classe <em>data.table</em> est également un <em>data.frame</em>. L’idée derrière les <em>data.table</em> est de réduire la longueur du code, de proposer une syntatxe plus facile à écrire et lire, mais aussi de réduire drastiquement les temps de calculs en présence de volumes de données massifs. La syntaxe se rapproche un peu du SQL, mais évite pas mal de lourdeurs de ce langage.</p>
<p>Pour utiliser les fonctions du <em>packages</em>, il est pratique de charger ce dernier.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="données.html#cb169-1" aria-hidden="true"></a><span class="kw">library</span>(data.table)</span>
<span id="cb169-2"><a href="données.html#cb169-2" aria-hidden="true"></a>femmes &lt;-<span class="st"> </span></span>
<span id="cb169-3"><a href="données.html#cb169-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">data.table</span>(<span class="dt">height =</span> <span class="kw">c</span>(<span class="dv">58</span>, <span class="dv">59</span>, <span class="dv">60</span>, <span class="dv">61</span>, <span class="dv">62</span>, <span class="dv">63</span>, <span class="dv">64</span>, <span class="dv">65</span>, <span class="dv">66</span>, </span>
<span id="cb169-4"><a href="données.html#cb169-4" aria-hidden="true"></a>                        <span class="dv">67</span>, <span class="dv">68</span>, <span class="dv">69</span>, <span class="dv">70</span>, <span class="dv">71</span>, <span class="dv">72</span>),</span>
<span id="cb169-5"><a href="données.html#cb169-5" aria-hidden="true"></a>           <span class="dt">weight =</span> <span class="kw">c</span>(<span class="dv">115</span>, <span class="dv">117</span>, <span class="dv">120</span>, <span class="dv">123</span>, <span class="dv">126</span>, <span class="dv">129</span>, <span class="dv">132</span>, <span class="dv">135</span>, </span>
<span id="cb169-6"><a href="données.html#cb169-6" aria-hidden="true"></a>                      <span class="dv">139</span>, <span class="dv">142</span>, <span class="dv">146</span>, <span class="dv">150</span>, <span class="dv">154</span>, <span class="dv">159</span>, <span class="dv">164</span>))</span>
<span id="cb169-7"><a href="données.html#cb169-7" aria-hidden="true"></a>femmes</span></code></pre></div>
<pre><code>##     height weight
##  1:     58    115
##  2:     59    117
##  3:     60    120
##  4:     61    123
##  5:     62    126
##  6:     63    129
##  7:     64    132
##  8:     65    135
##  9:     66    139
## 10:     67    142
## 11:     68    146
## 12:     69    150
## 13:     70    154
## 14:     71    159
## 15:     72    164</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="données.html#cb171-1" aria-hidden="true"></a><span class="kw">is.data.frame</span>(femmes)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="données.html#cb173-1" aria-hidden="true"></a><span class="kw">is.data.table</span>(femmes)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="données.html#cb175-1" aria-hidden="true"></a><span class="kw">class</span>(femmes)</span></code></pre></div>
<pre><code>## [1] &quot;data.table&quot; &quot;data.frame&quot;</code></pre>
</div>
</div>
</div>
<div id="importation-exportation-et-création-de-données" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Importation, exportation et création de données</h2>
<p>Pour pouvoir analyser des données, il faut pourvoir les charger en mémoire. Heureusement, il n’est pas nécessaire de les rentrer à la main, il existe des fonctions qui permettent de les importer, depuis divers formats. Il est également possible d’enregistrer les données dans plusieurs formats. Puisqu’il est souvent utile de créer des données à l’intérieur de la session (par exemple des années, des variables indicatrices, des noms de mois, etc.), cette section présente quelques fonctions utiles à la création de données.</p>
<p>Avant toute chose, il convient de préciser qu’un environnement de travail (<em>working directory</em>) est assigné à R. Si R est lancé depuis un terminal, l’environnement de travail sera par défaut le répertoire courant à partir duquel la commande de lancement de R a été évaluée. C’est dans ce répertoire, dont on peut se rappeler le chemin grâce à l’instruction <code>getwd()</code> que R ira chercher les fichiers à importer et enregistrer les données lors de l’exportation. Si on souhaite lire des fichiers qui sont hors de ce répertoire, il est nécessaire d’indiquer à R leur chemin (relatif ou absolu). Pour changer de répertoire courant, il est possible d’utiliser la fonction <code>setwd()</code>.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="données.html#cb177-1" aria-hidden="true"></a><span class="kw">getwd</span>()</span></code></pre></div>
<pre><code>## [1] &quot;/Users/ewengallic/Documents&quot;</code></pre>
<p><em>Attention</em>, l’utilisation de la fonction <code>setwd()</code> est considérée comme une <em>mauvaise pratique</em>. Deux exemples permettent de comprendre que l’utilisation de cette fonction peut s’avérer très pénible :</p>
<ul>
<li>lors d’un travail en collaboration, il est fort probable que la ou les personnes avec qui l’on travaille ne s’appellent pas comme nous ; de fait, le chemin indiquant le répertoire courant sera faux ;</li>
<li>lors de l’acquisition d’un nouvel ordinateur, il est fort possible que l’arborescence ne soit pas exactement la même ; à nouveau, le chemin indiquant le répertoire de travail ne sera plus le bon.</li>
</ul>
<p>Quelle pratique adopter, dans ce cas ? La réponse est simple : travailler à l’aide de projets. RStudio propose cette alternative[^Menu <code>File</code> &gt; <code>New Project...</code>.], et dans ce cas, le chemin vers le répertoire de travail est défini à l’extérieur, par RStudio. Il suffit alors d’utiliser des chemins relatifs lors de l’importation ou l’exportation de données, graphiques, etc., plutôt que des chemins absolus. Les deux problèmes mentionnés plus haut n’apparaitront pas.</p>

<div class="remarque">
La fonction <code>list.files()</code> est très pratique : elle permet de lister tous les documents et répertoires contenus dans le répertoire de travail, ou dans n’importe quel répertoire si l’argument <code>path</code> renseigne le chemin.
</div>
<div id="importation" class="section level3" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Importation</h3>
<p>Lorsque les données sont présentes dans un fichier texte (ASCII), R propose deux fonctions : <code>read.table()</code> et <code>scan()</code>. Pour les données stockées dans des fichiers aux formats différents, il est nécessaire de s’appuyer sur d’autres fonctions, non contenues dans le <code>package</code> {<code>base</code>}. C’est le cas pour les fichiers Excel, SAS~ou STATA.</p>
<div id="la-fonction-read.table" class="section level4" number="2.3.1.1">
<h4><span class="header-section-number">2.3.1.1</span> La fonction <code>read.table</code></h4>
<p>Cette fonction est très pratique lorsque les données sont déjà organisées dans un tableau dans le fichier à importer. Elle crée alors un <em>data frame</em> contenant les données. Dans l’exemple fictif ci-dessous, les données du fichier <em>fichier.txt</em> sont stockées dans le <em>data frame</em> <code>df</code>. Les variables seront nommées par défaut <code>V1</code>, <code>V2</code>,…</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="données.html#cb179-1" aria-hidden="true"></a>df &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;fichier.txt&quot;</span>)</span></code></pre></div>
<p>Il existe de nombreux arguments pour la fonction <code>read.table()</code>. Seuls les principaux seront abordés ici. Le lecteur ou la lectrice pourra consulter l’aide <code>?read.table()</code> pour obtenir de plus amples détails.</p>
<table>
<colgroup>
<col width="19%" />
<col width="80%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>file</code></td>
<td align="left">Le nom du fichier, doit être une chaîne de caractères. Il peut être précédé du chemin relatif ou absolu. Attention (utile pour les utilisateurs de Windows) le caractère <code>\</code> est proscrit, et doit être remplacé par <code>/</code> ou bien <code>\\</code>. à noter qu’il est possible de saisir une adresse web (URL) en guise de chaîne de caractère.</td>
</tr>
<tr class="even">
<td align="left"><code>header</code></td>
<td align="left">Valeur logique (<code>header=FALSE</code> par défaut) indiquant si la première ligne contient les noms de variables.</td>
</tr>
<tr class="odd">
<td align="left"><code>sep</code></td>
<td align="left">Le séparateur de champ dans le fichier (chaîne vide par défaut, ce qui est au final traduit par une espace comme séparation). Par exmple, <code>sep=";"</code> si les champs sont séparés par un point-virgule, ou encore <code>sep="\textbackslash t"</code> s’ils sont séparés par une tabulation.</td>
</tr>
<tr class="even">
<td align="left"><code>dec</code></td>
<td align="left">Le caractère employé pour les décimales (par défaut, <code>dec="."</code>).</td>
</tr>
<tr class="odd">
<td align="left"><code>row.names</code></td>
<td align="left">Un vecteur contenant le nom des lignes (de type caractère), ou bien le numéro ou le nom d’une variable du fichier. En omettant cet argument, les lignes sont numérotées.</td>
</tr>
<tr class="even">
<td align="left"><code>na.strings</code></td>
<td align="left">Une chaîne de caractère (ou un vecteur de chaînes de caractères) indiquant la valeur des données manquantes (par défaut, <code>na.strings="NA"</code>). Ces données manquantes seront converties en <code>NA</code>.</td>
</tr>
<tr class="odd">
<td align="left"><code>colClasses</code></td>
<td align="left">Un vecteur de caractères indiquant les modes des colonnes.</td>
</tr>
</tbody>
</table>

<div class="remarque">
<p>Il est possible d’employer l’instruction <code>file.choose()</code> pour ouvrir une boîte de dialogue au lieu d’écrire le chemin complet vers le fichier de données. Bien que cette interface puisse paraître agréable à l’utilisateur novice, elle risque de vite devenir contraignante si le fichier R est amené à être exécuté plusieurs fois, puisqu’à chaque appel, la boîte de dialogue s’ouvrira.</p>
<code>df &lt;- read.table(file.choose())</code>
</div>

<div class="remarque">
<p>Il existe des variantes de <code>read.table()</code> qui s’appuient sur cette fonction pour proposer à l’utilisateur des fonctions directement capables de lire leur fichier de données, sans avoir à changer les arguments <code>sep</code> et <code>decim</code>.</p>
<table>
<thead>
<tr class="header">
<th>Fonction</th>
<th align="center">Séparateur de champs</th>
<th align="center">Séparateur décimal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>read.csv()</code></td>
<td align="center">“<code>,</code>”</td>
<td align="center">“<code>.</code>”</td>
</tr>
<tr class="even">
<td><code>read.csv2()</code></td>
<td align="center">“<code>;</code>”</td>
<td align="center">“<code>,</code>”</td>
</tr>
<tr class="odd">
<td><code>read.delim()</code></td>
<td align="center">“<code>\t</code>”</td>
<td align="center">“<code>.</code>”</td>
</tr>
</tbody>
</table>
| <code>read.delim2()</code> | “<code>\t</code>” | “<code>,</code>” |
</div>

<div class="remarque">
<p>Le <em>package</em> {<code>readr</code>} propose des alternatives extrêmement rapides aux fonctions <code>read.table()</code> et dérivées. L’équivalent de <code>read.table()</code> est <code>read_delim()</code>. Il suffit de lui préciser le séparateur de champ (<code>delim</code>), le séparateur des miliers étant automatiquement détecté. Attention, une ligne d’en-tête doit être présente dans le fichier de données.</p>
<p><code>df &lt;- read_delim("data.csv", ";")</code></p>
<table>
<thead>
<tr class="header">
<th>Fonction</th>
<th align="center">Séparateur de champs</th>
<th align="center">Séparateur décimal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>read_csv()</code></td>
<td align="center">“<code>,</code>”</td>
<td align="center">“<code>.</code>”</td>
</tr>
<tr class="even">
<td><code>read_csv2()</code></td>
<td align="center">“<code>;</code>”</td>
<td align="center">“<code>,</code>”</td>
</tr>
<tr class="odd">
<td><code>read_delim()</code></td>
<td align="center">“<code>\t</code>”</td>
<td align="center">“<code>.</code>”</td>
</tr>
</tbody>
</table>
| <code>read_delim2()</code> | “<code>\t</code>” | “<code>,</code>” |
</div>
</div>
<div id="la-fonction-scan" class="section level4" number="2.3.1.2">
<h4><span class="header-section-number">2.3.1.2</span> La fonction <code>scan</code></h4>
<p>La fonction <code>scan()</code> est beaucoup plus souple que <code>read.table()</code>. Son emploi est requis dès que les données ne sont pas organisées comme un tableau. La nature des variables peut être spécifiée en renseignant l’argument <code>what</code>. On retrouve la plupart des arguments de la fonction <code>read.table()</code>. Le tableau ci-dessous présente les principaux; le lecteur ou la lectrice est invité•e à se reporter au fichier d’aide (<code>?scan</code>) pour obtenir de plus amples détails.</p>
<table>
<colgroup>
<col width="45%" />
<col width="54%" />
</colgroup>
<thead>
<tr class="header">
<th>Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>file</code></td>
<td align="left">Nom de fichier ou chemin complet vers le fichier (peut être une URL)</td>
</tr>
<tr class="even">
<td><code>what</code></td>
<td align="left">Type des données lues</td>
</tr>
<tr class="odd">
<td><code>nmax</code></td>
<td align="left">Nombre de données maximum à lire</td>
</tr>
<tr class="even">
<td><code>n</code></td>
<td align="left">Nombre de données à lire (pas de limite par défaut)</td>
</tr>
<tr class="odd">
<td><code>sep</code></td>
<td align="left">Champ de séparation (caractère blanc par défaut)</td>
</tr>
<tr class="even">
<td><code>dec</code></td>
<td align="left">Caractère pour les décimales (“<code>.</code>” par défaut)</td>
</tr>
<tr class="odd">
<td><code>skio</code></td>
<td align="left">Nombre de lignes à omettre avant de débuter l’importation</td>
</tr>
<tr class="even">
<td><code>na.strings</code></td>
<td align="left">Vecteur de chaînes de caractères indiquant les valeurs manquantes (<code>NA</code> par défaut)</td>
</tr>
<tr class="odd">
<td><code>flush</code></td>
<td align="left">Si <code>TRUE</code>, commence l’importation de la ligne suivante après le dernier champs requis (permet d’avoir des commentaires après le dernier champ)</td>
</tr>
</tbody>
</table>

<div class="remarque">
Si dans l’appel de <code>scan()</code>, l’argument <code>file</code> est comme suit : <code>file=""</code>, l’utilisateur est invité à entrer les données au clavier. Pour clore la saisie, il suffit de terminer par une ligne blanche.
</div>
</div>
<div id="la-fonction-read.fwf" class="section level4" number="2.3.1.3">
<h4><span class="header-section-number">2.3.1.3</span> La fonction <em>read.fwf</em></h4>
<p>Parfois, les données que l’on récupère sont dans un format à largeur fixée (<em>fixed width format</em>). C’est le cas par exemple pour les données météorologiques issues du site de la <em>National Oceanic and Atmospheric Administration</em> (NOAA). R propose une fonction pour importer rapidement ce type de données : <em>read.fwf()</em>. Un argument fait son apparition par rapport à la fonction <em>read.table()</em>, il s’agit de <em>widths</em>, qui permet d’indiquer la largeur de chaque champ.</p>
<p>Prenons un exemple. Si le fichier de données est nommé <code>data_fwf.txt</code> et est présent dans le répertoire de travail, et qu’il contient les données suivantes :</p>
<blockquote>
<p>FRANCEFR14.01
FRANCEFR23.02
FRANCEFR32.96
ITALIEIT15.90
ITALIEIT25.48
ITALIEIT34.32</p>
</blockquote>
<p>alors, l’importation de ces données dans R pourra se faire de la manière suivante :</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="données.html#cb180-1" aria-hidden="true"></a>(df_fwf &lt;-<span class="st"> </span><span class="kw">read.fwf</span>(<span class="st">&quot;data_fwf.txt&quot;</span>, <span class="dt">widths =</span> <span class="kw">c</span>(<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">4</span>)))</span></code></pre></div>

<div class="remarque">
La fonction <code>read_fwf()</code> du <em>package</em> {<code>readr</code>} est une alternative à la fonction <code>read.fwf()</code>.
</div>
</div>
<div id="importation-depuis-excel" class="section level4" number="2.3.1.4">
<h4><span class="header-section-number">2.3.1.4</span> Importation depuis Excel©</h4>
<p>Nous allons voir comment importer des données directement depuis un fichier à l’extension <code>.xls</code> ou <code>.xlsx</code>. Il existe plusieurs méthodes, qui sont bien expliquées dans les documents de référence de ce document. Nous allons uniquement aborder la manière à l’aide des fonctions <code>read.xls()</code> et <code>read_excel()</code> contenues dans les <em>packages</em> {<code>gdata</code>} et {<code>readxl</code>} respectivement. Par souci de reproductibilité, nous allons nous appuyer sur le fichier <code>iris.xls</code>, contenu dans le répertoire du <em>package</em> {<code>gdata</code>}.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="données.html#cb181-1" aria-hidden="true"></a><span class="kw">library</span>(<span class="st">&quot;gdata&quot;</span>)</span>
<span id="cb181-2"><a href="données.html#cb181-2" aria-hidden="true"></a><span class="co"># Récupérer le lien vers le fichier iris.xls</span></span>
<span id="cb181-3"><a href="données.html#cb181-3" aria-hidden="true"></a>xlsfile &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="kw">path.package</span>(<span class="st">&#39;gdata&#39;</span>),<span class="st">&#39;xls&#39;</span>,<span class="st">&#39;iris.xls&#39;</span>)</span>
<span id="cb181-4"><a href="données.html#cb181-4" aria-hidden="true"></a>iris &lt;-<span class="st"> </span><span class="kw">read.xls</span>(xlsfile) <span class="co"># Créé un fichier csv temporaire</span></span>
<span id="cb181-5"><a href="données.html#cb181-5" aria-hidden="true"></a><span class="kw">head</span>(iris)</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<p>Par défaut, la fonction <code>read.xls()</code> importe les données de la première feuille. L’argument <code>sheet</code> permet d’indiquer la feuille souhaitée, en la référençant soit par son numéro, soit par son nom.</p>

<div class="remarque">
En pratique, si le fichier contient des formules, il est préférable d’utiliser la fonction ‘collage spécial’ d’Excel pour coller les valeurs dans un nouveau fichier, ou bien d’enregistrer le fichier sous un format <code>.txt</code> dans Excel.
</div>

<div class="remarque">
<p>Pour les utilisateurs sous Windows, il est peut-être nécessaire d’indiquer le chemin vers l’interprète perl (le fichier se nomme <code>perl.exe</code> )</p>
<p><code>perl &lt;- "C:\\Program Files\\FusionInventory-Agent\\perl\\bin\\perl.exe"</code></p>
<code>iris &lt;- read.xls(xlsfile, perl = perl) # Créé un fichier csv temporaire</code>
</div>
<p>Avec <code>read_xl()</code>, la procédure est identique :</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="données.html#cb183-1" aria-hidden="true"></a><span class="kw">library</span>(<span class="st">&quot;readxl&quot;</span>)</span>
<span id="cb183-2"><a href="données.html#cb183-2" aria-hidden="true"></a><span class="co"># Récupérer le lien vers le fichier iris.xls</span></span>
<span id="cb183-3"><a href="données.html#cb183-3" aria-hidden="true"></a>xlsfile &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="kw">path.package</span>(<span class="st">&#39;gdata&#39;</span>),<span class="st">&#39;xls&#39;</span>,<span class="st">&#39;iris.xls&#39;</span>)</span>
<span id="cb183-4"><a href="données.html#cb183-4" aria-hidden="true"></a>iris &lt;-<span class="st"> </span><span class="kw">read_excel</span>(xlsfile)</span></code></pre></div>
</div>
<div id="importation-depuis-dautres-formats" class="section level4" number="2.3.1.5">
<h4><span class="header-section-number">2.3.1.5</span> Importation depuis d’autres formats</h4>
<p>Le <em>package</em> {<code>foreign</code>}, installé de base sous Windows, mais non chargé automatiquement en mémoire, permet de lire des données stockées dans de nombreux formats (par exemple DBF, STATA, SPSS, etc.). Pour les fichiers <code>sas7bdat</code>, produits par SAS©, on peut utiliser la fonction <code>read.sas7bdat()</code> du <em>package</em> {<code>sas7bdat</code>}.</p>
</div>
</div>
<div id="exportation" class="section level3" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Exportation</h3>
<p>Pour enregistrer des données depuis un <em>tibble</em>, un <em>data frame</em>, un vecteur ou une matrice, la fonction <code>write.table()</code> peut être utilisée. Par exemple, si le <em>tibble</em> se nomme <code>donnees</code>, l’instruction ressemble à :</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="données.html#cb184-1" aria-hidden="true"></a><span class="kw">write.table</span>(donnees, <span class="dt">file =</span> <span class="st">&quot;nom_fichier.txt&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)</span></code></pre></div>
<p>Il existe d’autres arguments, que le lecteur ou la lectrice pourra consulter dans l’aide de la fonction <code>write.table()</code>.</p>

<div class="remarque">
La fonction <code>write_csv()</code> du <em>package</em> {<code>readr</code>} est une alternative à la fonction <code>write.csv()</code>.
</div>
<p>La fonction <code>save()</code> permet elle aussi de sauvegarder des données en dehors de la session R, et cette fois, n’importe quelle classe d’objet peut être sauvegardée. Par exemple, si l’utilisateur souhaite sauvegarder les objets <code>d1</code>, <code>d2</code> et <code>d3</code>, il lui suffit de rentrer l’instruction suivante :</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="données.html#cb185-1" aria-hidden="true"></a><span class="kw">save</span>(d1, d2, d3, <span class="dt">file =</span> <span class="st">&quot;nom_fichier.RData&quot;</span>)</span></code></pre></div>
<p>Pour charger les fichiers d’extention <code>.RData</code>, il faut utiliser la fonction <code>load()</code> :</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="données.html#cb186-1" aria-hidden="true"></a><span class="kw">load</span>(<span class="st">&quot;nom_fichier.RData&quot;</span>)</span></code></pre></div>

<div class="remarque">
Pour sauvegarder tous les éléments de la session R, la fonction <code>save.image()</code> peut être appelée, ce qui revient au même que d’évaluer l’instruction <code>save(list = ls(all=TRUE), file=".RData")</code>.
</div>
</div>
<div id="génération" class="section level3" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> Génération</h3>
<div id="séquences-régulières" class="section level4" number="2.3.3.1">
<h4><span class="header-section-number">2.3.3.1</span> Séquences régulières</h4>
<p>La fonction de concaténation, abordée précédemment est un moyen simple de créer un vecteur de données.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="données.html#cb187-1" aria-hidden="true"></a><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<p>La fonction <code>seq()</code> est extrêmement utile. Elle crée un vecteur de séquences de nombres. Le premier argument définit la valeur du début de séquence, tandis que le second argument définit la valeur finale. L’argument <code>by</code> définit l’incrément, et vaut 1 par défaut. L’argument <code>length.out</code> permet quant à lui de définir la longueur souhaitée de la séquence, et définit donc automatiquement la valeur de l’incrément. Il faut noter que <code>by</code> et <code>length.out</code> ne peuvent évidemment pas être utilisés en même temps.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="données.html#cb189-1" aria-hidden="true"></a>(a &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 2 3 4</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="données.html#cb191-1" aria-hidden="true"></a><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="données.html#cb193-1" aria-hidden="true"></a><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">3</span>, <span class="dt">by =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>## [1] 1.0 1.5 2.0 2.5 3.0</code></pre>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="données.html#cb195-1" aria-hidden="true"></a><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">3</span>, <span class="dt">length.out =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>##  [1] 1.000000 1.222222 1.444444 1.666667 1.888889 2.111111 2.333333 2.555556
##  [9] 2.777778 3.000000</code></pre>
<p>La fonction <code>:()</code> génère une séquence de données espacées d’une unité. Attention, cette fonction, que l’on peut voir comme un opérateur, est prioritaire sur les opérations arithmétiques.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="données.html#cb197-1" aria-hidden="true"></a><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="données.html#cb199-1" aria-hidden="true"></a><span class="fl">1.5</span><span class="op">:</span><span class="dv">10</span></span></code></pre></div>
<pre><code>## [1] 1.5 2.5 3.5 4.5 5.5 6.5 7.5 8.5 9.5</code></pre>
<p>Comme mentionné en Section <a href="données.html#donnees-mode">2.1.1</a>, le stockage des données de mode <em>integer</em> prend moins de place que celles de type <em>numeric</em>. Avec les fonctions <code>seq()</code> ou <code>:()</code>, les données sont de type <code>integer</code>.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="données.html#cb201-1" aria-hidden="true"></a><span class="kw">class</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>))</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="données.html#cb203-1" aria-hidden="true"></a><span class="kw">class</span>(<span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">4</span>))</span></code></pre></div>
<pre><code>## [1] &quot;integer&quot;</code></pre>
<p>Pour créer une séquence de valeurs avec duplication du premier argument, on peut utiliser la fonction <code>rep()</code>. En jouant avec les arguments, on peut créer des réplications différentes. Voici quelques exemples.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="données.html#cb205-1" aria-hidden="true"></a><span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">3</span>) <span class="co"># Répète trois fois la valeur 1</span></span></code></pre></div>
<pre><code>## [1] 1 1 1</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="données.html#cb207-1" aria-hidden="true"></a><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">3</span>) <span class="co"># Répète trois fois la séquence 1:2</span></span></code></pre></div>
<pre><code>## [1] 1 2 1 2 1 2</code></pre>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="données.html#cb209-1" aria-hidden="true"></a><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">each =</span> <span class="dv">3</span>) <span class="co"># Répète chaque élément de la séquence 1:2 trois fois</span></span></code></pre></div>
<pre><code>## [1] 1 1 1 2 2 2</code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="données.html#cb211-1" aria-hidden="true"></a><span class="co"># Répète deux fois la séquence dans laquelle</span></span>
<span id="cb211-2"><a href="données.html#cb211-2" aria-hidden="true"></a><span class="co"># les éléments de la séquence 1:2 sont répétés trois fois</span></span>
<span id="cb211-3"><a href="données.html#cb211-3" aria-hidden="true"></a><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dt">each =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  [1] 1 1 1 2 2 2 1 1 1 2 2 2</code></pre>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="données.html#cb213-1" aria-hidden="true"></a><span class="co"># Répète la séquence 1:2 jusqu&#39;à ce que</span></span>
<span id="cb213-2"><a href="données.html#cb213-2" aria-hidden="true"></a><span class="co"># la longueur du résultat soit égale à 3 (le résultat peut être tronqué)</span></span>
<span id="cb213-3"><a href="données.html#cb213-3" aria-hidden="true"></a><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">length.out =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 1 2 1</code></pre>
<p>La fonction <code>seq_len()</code> crée une suite de nombres entiers allant de 1 au nombre passé à l’unique argument <code>length.out</code>.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="données.html#cb215-1" aria-hidden="true"></a><span class="kw">seq_len</span>(<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 1 2 3 4</code></pre>
<p>La fonction <code>sequence()</code> génère une suite de nombres. Pour chaque élément passé à l’argument <code>nvec</code>, une séquence de nombre allant de 1 à cet élément, est créée. Les séquences d’entiers ainsi créées sont concaténées.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="données.html#cb217-1" aria-hidden="true"></a><span class="kw">sequence</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 1 2 1 2 3 1 2 3 4</code></pre>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="données.html#cb219-1" aria-hidden="true"></a><span class="kw">sequence</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">5</span>))</span></code></pre></div>
<pre><code>## [1] 1 2 3 1 2 3 4 5</code></pre>
<p>La fonction <code>gl()</code> permet de créer des séries de facteurs. Elle requière deux arguments : <code>n</code>, pour indiquer le nombre de niveaux souhaité, et <code>k</code> pour indiquer le nombre de réplications voulu. Il est possible de définir les étiquettes pour chacun des niveaux, en renseignant l’argument <code>labels</code> ou encore de préciser si les niveaux des facteurs doivent être ordonnés, avec l’argument logique <code>ordered</code>. L’argument <code>length</code> permet quant à lui de définir la longueur souhaitée du résultat.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="données.html#cb221-1" aria-hidden="true"></a><span class="kw">gl</span>(<span class="dv">2</span>, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 1 1 1 1 2 2 2 2
## Levels: 1 2</code></pre>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="données.html#cb223-1" aria-hidden="true"></a><span class="kw">gl</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dt">length =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>##  [1] 1 1 1 1 2 2 2 2 1 1
## Levels: 1 2</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="données.html#cb225-1" aria-hidden="true"></a><span class="kw">gl</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Oui&quot;</span>, <span class="st">&quot;Non&quot;</span>))</span></code></pre></div>
<pre><code>## [1] Oui Oui Oui Oui Non Non Non Non
## Levels: Oui Non</code></pre>
<p>Enfin, <code>expand.grid()</code> est une fonction très utile pour générer toutes les combinaisons possibles des vecteurs donnés en arguments.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="données.html#cb227-1" aria-hidden="true"></a><span class="kw">expand.grid</span>(<span class="dt">age =</span> <span class="kw">seq</span>(<span class="dv">18</span>, <span class="dv">20</span>), <span class="dt">genre =</span> <span class="kw">c</span>(<span class="st">&quot;Femme&quot;</span>, <span class="st">&quot;Homme&quot;</span>), <span class="dt">fumeur =</span> <span class="kw">c</span>(<span class="st">&quot;Oui&quot;</span>, <span class="st">&quot;Non&quot;</span>))</span></code></pre></div>
<pre><code>##    age genre fumeur
## 1   18 Femme    Oui
## 2   19 Femme    Oui
## 3   20 Femme    Oui
## 4   18 Homme    Oui
## 5   19 Homme    Oui
## 6   20 Homme    Oui
## 7   18 Femme    Non
## 8   19 Femme    Non
## 9   20 Femme    Non
## 10  18 Homme    Non
## 11  19 Homme    Non
## 12  20 Homme    Non</code></pre>
</div>
<div id="séquences-pseudo-aléatoires" class="section level4" number="2.3.3.2">
<h4><span class="header-section-number">2.3.3.2</span> Séquences pseudo-aléatoires</h4>
<p>R propose des fonctions pour de nombreuses distributions de probabilité. Pour chaque distribution de probabilité, il y a en général quatre fonctions, dont le nom commence par une des quatre lettres suivantes : <code>r</code> (<em>random</em>), <code>d</code> (<em>density</em>), <code>p</code> (<em>probability</em>) et <code>q</code> (<em>quantile</em>). Les fonctions commençant par la lettre <code>r</code> permettent de générer des données issues d’une loi de probabilité donnée ; celles commençant par la lettre <code>d</code> correspondent aux densités de probabilité (ou fonctions de masse dans le cas d’une variable aléatoire discrète) ; celles dont la première lettre est un <code>p</code> donnent la densité de probabilité cumulée (fonctions de répartition) ; et enfin celles commençant par la lettre <code>q</code> donnent les valeur de quantiles (fonctions quantiles).</p>
<p>Prenons un exemple avec la loi <span class="math inline">\(\mathcal{N}(0,1)\)</span> :</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="données.html#cb229-1" aria-hidden="true"></a><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] -0.3507157</code></pre>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="données.html#cb231-1" aria-hidden="true"></a><span class="kw">dnorm</span>(<span class="dv">1</span>) <span class="op">==</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi) <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="données.html#cb233-1" aria-hidden="true"></a><span class="kw">pnorm</span>(<span class="fl">1.96</span>)</span></code></pre></div>
<pre><code>## [1] 0.9750021</code></pre>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="données.html#cb235-1" aria-hidden="true"></a><span class="kw">qnorm</span>(<span class="fl">0.025</span>) ; <span class="kw">qnorm</span>(<span class="fl">0.975</span>)</span></code></pre></div>
<pre><code>## [1] -1.959964</code></pre>
<pre><code>## [1] 1.959964</code></pre>
<p>R propose des fonctions pour les lois de probabilité discrètes suivantes (liste non exhaustive) :</p>
<ul>
<li>Binomiale : <code>rbinom(n, size, prob)</code> ;</li>
<li>Poisson : <code>rpois(n, lambda)</code> ;</li>
<li>Géométrique : <code>rgeom(n, prob)</code> ;</li>
<li>Hyper-géométrique : <code>rhyper(nn, m, n, k)</code> ;</li>
<li>Binomiale négative : <code>rnbinom(n, size, prob, mu)</code>.</li>
</ul>
<p>R propose des fonctions pour les lois de probabilité continues suivantes (liste non exhaustive) :</p>
<ul>
<li>Normale : <code>rnorm(n, mean = 0, sd = 1)</code></li>
<li>Student : <code>rt(n, df, ncp)</code></li>
<li>Khi-deux : <code>rchisq(n, df, ncp = 0)</code></li>
<li>Fisher : <code>rf(n, df1, df2, ncp)</code></li>
<li>Exponentielle : <code>rexp(n, rate = 1)</code></li>
<li>Uniforme : <code>runif(n, min = 0, max = 1)</code></li>
<li>Beta : <code>rbeta(n, shape1, shape2, ncp = 0)</code></li>
<li>Logistique : <code>rlogis(n, location = 0, scale = 1)</code></li>
<li>Log-Normale : <code>rlnorm(n, meanlog = 0, sdlog = 1)</code></li>
<li>Gamma : <code>rgamma(n, shape, rate = 1, scale = 1/rate)</code></li>
<li>Weibull : <code>rweibull(n, shape, scale = 1)</code></li>
</ul>
</div>
</div>
</div>
<div id="manipulation-des-données" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Manipulation des données</h2>
<p>Dans la Section <a href="données.html#structures">2.2</a>, nous avons vu comment créer différents objets en R. Cette section présente d’abord les opérateurs, puis les façons d’accéder aux données en fonction du type d’objet, les calculs sur les listes et vecteurs, et enfin les calculs matriciels.</p>
<div id="opérateurs" class="section level3" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Opérateurs</h3>
<p>Il existe trois sortes d’opérateurs en R, à savoir arithmétiques, de comparaison et logiques.</p>
<div id="opérateurs-arithmétiques" class="section level4" number="2.4.1.1">
<h4><span class="header-section-number">2.4.1.1</span> Opérateurs arithmétiques</h4>
<p>Les opérateurs arithmétiques agissent sur des vecteurs ou des matrices. Ils opèrent sur des objets de type numérique, complèxe ou logique. En voici la liste :</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="données.html#cb238-1" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb238-2"><a href="données.html#cb238-2" aria-hidden="true"></a>y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">1</span>)</span>
<span id="cb238-3"><a href="données.html#cb238-3" aria-hidden="true"></a>x <span class="op">+</span><span class="st"> </span>y  <span class="co"># Addition</span></span></code></pre></div>
<pre><code>## [1]  3  7  5 12  6</code></pre>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="données.html#cb240-1" aria-hidden="true"></a>x <span class="op">-</span><span class="st"> </span>y  <span class="co"># Soustraction</span></span></code></pre></div>
<pre><code>## [1] -1 -3  1 -4  4</code></pre>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="données.html#cb242-1" aria-hidden="true"></a>x <span class="op">*</span><span class="st"> </span>y   <span class="co"># Multiplication</span></span></code></pre></div>
<pre><code>## [1]  2 10  6 32  5</code></pre>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="données.html#cb244-1" aria-hidden="true"></a>x <span class="op">/</span><span class="st"> </span>y   <span class="co"># Division</span></span></code></pre></div>
<pre><code>## [1] 0.5 0.4 1.5 0.5 5.0</code></pre>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="données.html#cb246-1" aria-hidden="true"></a>x<span class="op">^</span>y  <span class="co"># Puissance</span></span></code></pre></div>
<pre><code>## [1]     1    32     9 65536     5</code></pre>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="données.html#cb248-1" aria-hidden="true"></a>x <span class="op">%%</span><span class="st"> </span>y  <span class="co"># Modulo</span></span></code></pre></div>
<pre><code>## [1] 1 2 1 4 0</code></pre>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="données.html#cb250-1" aria-hidden="true"></a>x <span class="op">%/%</span><span class="st"> </span>y <span class="co"># Division entière</span></span></code></pre></div>
<pre><code>## [1] 0 0 1 0 5</code></pre>
</div>
<div id="opérateurs-de-comparaison" class="section level4" number="2.4.1.2">
<h4><span class="header-section-number">2.4.1.2</span> Opérateurs de comparaison</h4>
<p>Les opérateurs de comparaison agissent sur des vecteurs, des matrices, des tableaux de données et des listes. Le type de données n’est pas restreint comme pour les opérateurs arithmétiques.</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="données.html#cb252-1" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">seq_len</span>(<span class="dv">5</span>)</span>
<span id="cb252-2"><a href="données.html#cb252-2" aria-hidden="true"></a>x <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>  <span class="co"># Inférieur à</span></span></code></pre></div>
<pre><code>## [1]  TRUE FALSE FALSE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="données.html#cb254-1" aria-hidden="true"></a>x <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span>  <span class="co"># Inférieur ou égal à</span></span></code></pre></div>
<pre><code>## [1]  TRUE  TRUE FALSE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="données.html#cb256-1" aria-hidden="true"></a>x <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>   <span class="co"># Supérieur à</span></span></code></pre></div>
<pre><code>## [1] FALSE FALSE  TRUE  TRUE  TRUE</code></pre>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="données.html#cb258-1" aria-hidden="true"></a>x <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2</span>  <span class="co"># Supérieur ou égal à</span></span></code></pre></div>
<pre><code>## [1] FALSE  TRUE  TRUE  TRUE  TRUE</code></pre>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="données.html#cb260-1" aria-hidden="true"></a>x <span class="op">==</span><span class="st"> </span><span class="dv">2</span>  <span class="co"># Égal à</span></span></code></pre></div>
<pre><code>## [1] FALSE  TRUE FALSE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="données.html#cb262-1" aria-hidden="true"></a>x <span class="op">!=</span><span class="st"> </span><span class="dv">2</span>  <span class="co"># Différent de</span></span></code></pre></div>
<pre><code>## [1]  TRUE FALSE  TRUE  TRUE  TRUE</code></pre>
<p>Attention, il faut être prudent avec la fonction d’égalité. En effet, un exemple simple (voir <span class="citation">Paradis (<a href="#ref-Paradis_2002_R" role="doc-biblioref">2002</a>)</span>) montre que deux objets qui nous semblent identiques ne le sont pas aux yeux de la machine, à cause des approximations effectuées lors des calculs. Il convient alors dans certains cas d’utiliser la fonction <code>all.equal()</code> plutôt que l’opérateur logique <code>==</code> ou la fonction <code>identical()</code>.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="données.html#cb264-1" aria-hidden="true"></a><span class="fl">0.9</span> <span class="op">==</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="données.html#cb266-1" aria-hidden="true"></a><span class="kw">all.equal</span>(<span class="fl">0.9</span>, <span class="dv">1</span><span class="fl">-0.1</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="données.html#cb268-1" aria-hidden="true"></a><span class="kw">identical</span>(<span class="fl">0.9</span>, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="données.html#cb270-1" aria-hidden="true"></a><span class="fl">0.9</span> <span class="op">==</span><span class="st"> </span>(<span class="fl">1.1</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.2</span>)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="données.html#cb272-1" aria-hidden="true"></a><span class="kw">all.equal</span>(<span class="fl">0.9</span>, <span class="fl">1.1-0.2</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="données.html#cb274-1" aria-hidden="true"></a><span class="kw">identical</span>(<span class="fl">0.9</span>, <span class="fl">1.1-0.2</span>)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>En fait, la fonction <code>all.equal()</code> donne une égalité approximative, à l’aide d’un seuil de tolérance !</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="données.html#cb276-1" aria-hidden="true"></a><span class="kw">all.equal</span>(<span class="fl">0.9</span>, <span class="fl">1.1-0.2</span>, <span class="dt">tolerance =</span> <span class="fl">1e-16</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Mean relative difference: 1.233581e-16&quot;</code></pre>
</div>
<div id="opérateurs-logiques" class="section level4" number="2.4.1.3">
<h4><span class="header-section-number">2.4.1.3</span> Opérateurs logiques</h4>
<p>Les opérateurs logiques opèrent sur un ou deux objets de type logique. Les opérateurs <code>ET</code> et <code>OU</code> existent en R sous deux formes : la forme simple (<code>&amp;</code> et <code>|</code>) et la forme double (<code>&amp;&amp;</code> et <code>||</code>). La forme simple opère sur chaque élément des objets, et retourne le résultat de l’opération pour chaque élément. La forme double, quant à elle, opère uniquement sur le premier élément des objets.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="données.html#cb278-1" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">FALSE</span>)</span>
<span id="cb278-2"><a href="données.html#cb278-2" aria-hidden="true"></a>y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>)</span>
<span id="cb278-3"><a href="données.html#cb278-3" aria-hidden="true"></a><span class="op">!</span>x  <span class="co"># &#39;Non&#39; logique</span></span></code></pre></div>
<pre><code>## [1] FALSE FALSE  TRUE  TRUE</code></pre>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="données.html#cb280-1" aria-hidden="true"></a>x<span class="op">&amp;</span>y <span class="co"># &#39;Et&#39; logique</span></span></code></pre></div>
<pre><code>## [1]  TRUE FALSE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="données.html#cb282-1" aria-hidden="true"></a>x<span class="op">&amp;&amp;</span>y    <span class="co"># &#39;Et&#39; logique (revient à faire x[1] &amp; y[1])</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="données.html#cb284-1" aria-hidden="true"></a>x<span class="op">|</span>y <span class="co"># &#39;Ou&#39; logique</span></span></code></pre></div>
<pre><code>## [1]  TRUE  TRUE  TRUE FALSE</code></pre>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="données.html#cb286-1" aria-hidden="true"></a>x<span class="op">||</span>y    <span class="co"># &#39;Ou&#39; logique (revient à faire x[1] | y[1])</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="données.html#cb288-1" aria-hidden="true"></a><span class="kw">xor</span>(x, y)   <span class="co"># &#39;Ou&#39; exlusif</span></span></code></pre></div>
<pre><code>## [1] FALSE  TRUE  TRUE FALSE</code></pre>
<p>Il existe deux fonctions importantes pour les vecteurs de type <code>logical</code> : <code>any()</code> et <code>all()</code> qui indiquent respectivement, si au moins un des éléments du vecteur vaut <code>TRUE</code> et si tous les éléments du vecteur valent <code>TRUE</code>.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="données.html#cb290-1" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>)</span>
<span id="cb290-2"><a href="données.html#cb290-2" aria-hidden="true"></a><span class="kw">any</span>(x)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="données.html#cb292-1" aria-hidden="true"></a>y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">FALSE</span>)</span>
<span id="cb292-2"><a href="données.html#cb292-2" aria-hidden="true"></a><span class="kw">any</span>(y)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="données.html#cb294-1" aria-hidden="true"></a><span class="kw">all</span>(<span class="op">!</span>y)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="attention-au-recyclage" class="section level4" number="2.4.1.4">
<h4><span class="header-section-number">2.4.1.4</span> Attention au recyclage</h4>
<p>Jusqu’ici, les exemples fournis au sujet des opérateurs ne concernaient que des objets de même longueur. Dans le cas des <em>vecteurs</em>, si un des deux objets concernés par l’opération est de taille inférieure à celle de l’autre, R effectue un recyclage, c’est à dire qu’il va compléter le vecteur le plus court à l’aide des valeurs de ce même vecteur, afin d’obtenir deux objets de même taille. On peut voir que R affiche un message d’avertissement lors d’une telle opération.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="données.html#cb296-1" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb296-2"><a href="données.html#cb296-2" aria-hidden="true"></a>y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>)</span>
<span id="cb296-3"><a href="données.html#cb296-3" aria-hidden="true"></a>x <span class="op">+</span><span class="st"> </span>y</span></code></pre></div>
<pre><code>## [1] 2 4 6 5 7 9 8</code></pre>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="données.html#cb298-1" aria-hidden="true"></a><span class="co"># R a ajouté le vecteur c(1, 2, 3, 1, 2, 3, 1) à y</span></span></code></pre></div>
</div>
</div>
<div id="manip-acces" class="section level3" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Accès aux valeurs, modifications</h3>
<p>Pour accéder aux éléments d’un objet, R propose plusieurs méthodes, qui peuvent varier selon le type d’objet.</p>
<div id="accès-par-indices" class="section level4" number="2.4.2.1">
<h4><span class="header-section-number">2.4.2.1</span> Accès par indices</h4>
<p>Un moyen simple d’accéder aux éléments d’un objet est d’utiliser le système d’indexation. Cette indexation peut être de type numérique ou logique. Dans le cas d’un vecteur, on extrait une composante en utilisant la fonction <code>"["()</code>, dont les arguments en dehors du vecteur pour lequel on souhaite réaliser une extraction peuvent être un vecteur d’indices d’éléments à extraire ou ne pas extraire, un vecteur d’éléments de type logique indiquant si l’élément doit être extrait ou non.</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="données.html#cb299-1" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">0</span>)</span>
<span id="cb299-2"><a href="données.html#cb299-2" aria-hidden="true"></a><span class="st">&quot;[&quot;</span>(x, <span class="dv">2</span>)  <span class="co"># Extraire le second élément de x</span></span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="données.html#cb301-1" aria-hidden="true"></a>x[<span class="dv">2</span>]    <span class="co"># Une écriture plus commode pour extraire le second élément de x</span></span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="données.html#cb303-1" aria-hidden="true"></a>x[<span class="op">-</span><span class="dv">2</span>]   <span class="co"># Tous les éléments de x sauf le second</span></span></code></pre></div>
<pre><code>## [1] 4 3 5 0</code></pre>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="données.html#cb305-1" aria-hidden="true"></a>x[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>]  <span class="co"># Les troisième et quatrième éléments de x</span></span></code></pre></div>
<pre><code>## [1] 3 5</code></pre>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="données.html#cb307-1" aria-hidden="true"></a>i &lt;-<span class="st"> </span><span class="dv">3</span><span class="op">:</span><span class="dv">4</span></span>
<span id="cb307-2"><a href="données.html#cb307-2" aria-hidden="true"></a>x[i] <span class="co"># On peut utiliser une variable contenant un vecteur d&#39;indices</span></span></code></pre></div>
<pre><code>## [1] 3 5</code></pre>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="données.html#cb309-1" aria-hidden="true"></a>x[<span class="kw">c</span>(F, T, F, F, F)] <span class="co"># Le second élément de x</span></span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="données.html#cb311-1" aria-hidden="true"></a>x[x<span class="op">&lt;</span><span class="dv">1</span>]  <span class="co"># Les éléments de x inférieurs à 1</span></span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="données.html#cb313-1" aria-hidden="true"></a>x<span class="op">&lt;</span><span class="dv">1</span> <span class="co"># Il s&#39;agit bien d&#39;un vecteur de logiques</span></span></code></pre></div>
<pre><code>## [1] FALSE FALSE FALSE FALSE  TRUE</code></pre>
<p>La fonction <code>which()</code> retourne les positions des éléments d’un vecteur logique pour lesquels la valeur vaut <code>TRUE</code>. Les fonctions <code>which.min()</code> et <code>which.max()</code> retournent respectivement la position du (premier) minimum et du premier maximum d’un vecteur numérique ou logique.</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="données.html#cb315-1" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">6</span>)</span>
<span id="cb315-2"><a href="données.html#cb315-2" aria-hidden="true"></a><span class="kw">which</span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">7</span> <span class="op">&amp;</span><span class="st"> </span>x <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 2 3 6</code></pre>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="données.html#cb317-1" aria-hidden="true"></a><span class="kw">which.min</span>(x)</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="données.html#cb319-1" aria-hidden="true"></a><span class="kw">which.max</span>(x)</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="données.html#cb321-1" aria-hidden="true"></a>x[<span class="kw">which.max</span>(x)]</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<p>Le remplacement d’un élément s’effectue simplement en utilisant la flèche d’assignation. On peut modifir plusieurs éléments à la fois.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="données.html#cb323-1" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">seq_len</span>(<span class="dv">5</span>)</span>
<span id="cb323-2"><a href="données.html#cb323-2" aria-hidden="true"></a>x[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb323-3"><a href="données.html#cb323-3" aria-hidden="true"></a>x</span></code></pre></div>
<pre><code>## [1] 1 3 3 4 5</code></pre>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="données.html#cb325-1" aria-hidden="true"></a>x[<span class="dv">2</span>] &lt;-<span class="st"> </span>x[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb325-2"><a href="données.html#cb325-2" aria-hidden="true"></a>x</span></code></pre></div>
<pre><code>## [1] 1 0 0 4 5</code></pre>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="données.html#cb327-1" aria-hidden="true"></a>x[<span class="kw">which</span>(x <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)] &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb327-2"><a href="données.html#cb327-2" aria-hidden="true"></a>x</span></code></pre></div>
<pre><code>## [1]  1 10 10  4  5</code></pre>
<p>Pour les <em>matrices</em> ou les <em>tableaux de données</em>, l’extraction par indice se fait dans le même esprit, mais il faut indiquer un vecteur d’indices (<code>i</code>) pour les lignes et un pour les colonnes (<code>j</code>), de la manière suivante : <code>x[i, j]</code>, avec <code>x</code> la matrice ou le tableau de donnée. En omettant le vecteur d’indices pour les lignes ou les colonnes, R retourne toutes les lignes ou les colonnes respectivement. Enfin, en ajoutant le symbole “moins” (<code>-</code>) devant le vecteur d’indices de lignes ou de colonnes, on demande à R de ne pas retourner les éléments dont les indices sont mentionnés.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="données.html#cb329-1" aria-hidden="true"></a>(x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">3</span>))</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9</code></pre>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="données.html#cb331-1" aria-hidden="true"></a>x[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># Élément de la ligne 1 et de la colonne 2</span></span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="données.html#cb333-1" aria-hidden="true"></a>i &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>) ; j &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb333-2"><a href="données.html#cb333-2" aria-hidden="true"></a>x[i,j]  <span class="co"># Éléments des lignes 1 et 3 de la troisième colonne</span></span></code></pre></div>
<pre><code>## [1] 7 9</code></pre>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="données.html#cb335-1" aria-hidden="true"></a>x[, <span class="dv">2</span>]  <span class="co"># Éléments de la seconde colonne</span></span></code></pre></div>
<pre><code>## [1] 4 5 6</code></pre>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="données.html#cb337-1" aria-hidden="true"></a>x[<span class="dv">1</span> ,]  <span class="co"># Éléments de la première ligne</span></span></code></pre></div>
<pre><code>## [1] 1 4 7</code></pre>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="données.html#cb339-1" aria-hidden="true"></a>x[, <span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)]    <span class="co"># x sans les colonnes 1 et 3</span></span></code></pre></div>
<pre><code>## [1] 4 5 6</code></pre>
<p>Avec le dernier exemple, on voit que R retourne un vecteur et non une matrice. Si on souhaite obtenir une matrice à une seule colonne, il suffit d’ajouter l’argument <code>drop</code> auquel on donne la valeur <code>FALSE</code>.</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="données.html#cb341-1" aria-hidden="true"></a>x[, <span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), drop =<span class="st"> </span><span class="ot">FALSE</span>]</span></code></pre></div>
<pre><code>##      [,1]
## [1,]    4
## [2,]    5
## [3,]    6</code></pre>
<p>Pour modifier une valeur, c’est à nouveau avec la flèche d’assignation.</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="données.html#cb343-1" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb343-2"><a href="données.html#cb343-2" aria-hidden="true"></a>x[<span class="dv">1</span>,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb343-3"><a href="données.html#cb343-3" aria-hidden="true"></a>x</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    0    7
## [2,]    2    5    8
## [3,]    3    6    9</code></pre>
<p>On peut noter qu’en utilisant <code>which()</code> sur une matrice, on peut demander à R de retourner les indices sous forme de couples :</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="données.html#cb345-1" aria-hidden="true"></a><span class="kw">which</span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>, <span class="dt">arr.ind =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>##      row col
## [1,]   3   2
## [2,]   1   3
## [3,]   2   3
## [4,]   3   3</code></pre>
<p>Il est également possible d’utiliser des vecteurs logiques.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="données.html#cb347-1" aria-hidden="true"></a>(x_logique &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>), <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow =</span> <span class="dv">3</span>))</span></code></pre></div>
<pre><code>##       [,1]  [,2]  [,3]
## [1,]  TRUE FALSE  TRUE
## [2,] FALSE  TRUE FALSE
## [3,]  TRUE FALSE  TRUE</code></pre>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="données.html#cb349-1" aria-hidden="true"></a>x[x_logique]</span></code></pre></div>
<pre><code>## [1] 1 3 5 7 9</code></pre>
<p>Comme indiqué dans la Section <a href="données.html#structures-base-matrices">2.2.1.4</a>, les matrices et les tableaux sont des vecteurs, qui correspondent à un empilement des vecteurs colonnes. Ainsi, on peut extraire les éléments de la matrice à l’aide d’un vecteur d’indices ou de valeurs logiques.</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="données.html#cb351-1" aria-hidden="true"></a>x[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">7</span>)]</span></code></pre></div>
<pre><code>## [1] 1 3 7</code></pre>
<p>Pour les <em>tableaux de dimension supérieure à 2</em>, il suffit juste d’ajouter un argument par dimension supplémentaire. Voici un exemple avec un tableau de dimension 3 :</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="données.html#cb353-1" aria-hidden="true"></a>z &lt;-<span class="kw">array</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, <span class="dt">dim =</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">3</span>))</span>
<span id="cb353-2"><a href="données.html#cb353-2" aria-hidden="true"></a>z[<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">3</span>]  <span class="co"># Élément de la ligne 2, colonne 4 de la dimension 3</span></span></code></pre></div>
<pre><code>## [1] 24</code></pre>
<p>Enfin, pour les <em>listes</em>, l’emploi de la fonction <code>"["()</code> retourne une liste, puisque les listes sont constituées de listes.</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="données.html#cb355-1" aria-hidden="true"></a>personne &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;Piketty&quot;</span>, <span class="st">&quot;Thomas&quot;</span>, <span class="st">&quot;1971&quot;</span>)</span>
<span id="cb355-2"><a href="données.html#cb355-2" aria-hidden="true"></a>personne[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;Piketty&quot;</code></pre>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="données.html#cb357-1" aria-hidden="true"></a><span class="kw">class</span>(personne[<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] &quot;list&quot;</code></pre>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="données.html#cb359-1" aria-hidden="true"></a>personne[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)]</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;Piketty&quot;
## 
## [[2]]
## [1] &quot;1971&quot;</code></pre>
<p>Pour obtenir le contenu d’un ou plusieurs éléments de la liste, on fait donc appel à une autre fonction : <code>"[["()</code>. Comme pour la fonction avec les crochets simples, on peut l’employer d’une manière plus commode en l’accolant au nom de la liste contenant les éléments que l’on souhaite extraire.</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="données.html#cb361-1" aria-hidden="true"></a><span class="st">&quot;[[&quot;</span>(personne, <span class="dv">1</span>)  <span class="co"># Premier élément de la liste</span></span></code></pre></div>
<pre><code>## [1] &quot;Piketty&quot;</code></pre>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="données.html#cb363-1" aria-hidden="true"></a>personne[[<span class="dv">1</span>]]   <span class="co"># idem</span></span></code></pre></div>
<pre><code>## [1] &quot;Piketty&quot;</code></pre>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="données.html#cb365-1" aria-hidden="true"></a>personne[[<span class="dv">1</span>,<span class="dv">2</span>]] <span class="co"># Ne fonctionne pas</span></span></code></pre></div>
<pre><code>## Error in personne[[1, 2]]: nombre d&#39;indices incorrect</code></pre>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="données.html#cb367-1" aria-hidden="true"></a>personne[[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]]  <span class="co"># Ne fonctionne pas non plus ici</span></span></code></pre></div>
<pre><code>## Error in personne[[c(1, 2)]]: indice hors limites</code></pre>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="données.html#cb369-1" aria-hidden="true"></a>personne[<span class="dv">1</span>,<span class="dv">2</span>] <span class="co"># Ne fonctionne pas</span></span></code></pre></div>
<pre><code>## Error in personne[1, 2]: nombre de dimensions incorrect</code></pre>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="données.html#cb371-1" aria-hidden="true"></a>personne[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]    <span class="co"># Retourne une liste de dim 2 contenant :</span></span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;Piketty&quot;
## 
## [[2]]
## [1] &quot;Thomas&quot;</code></pre>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="données.html#cb373-1" aria-hidden="true"></a>    <span class="co"># - le premier élément de la liste</span></span>
<span id="cb373-2"><a href="données.html#cb373-2" aria-hidden="true"></a>    <span class="co"># - le second élément de la liste</span></span></code></pre></div>
<p>Grâce à la propriété d’indexation récursive, il est possible d’accéder aux éléments des objets de la liste. Par exemple, si le troisième élément de la liste <code>l</code> est un vecteur, et que l’on souhaite récupérer son premier élément, on peut écrire procéder de deux manières :</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="données.html#cb374-1" aria-hidden="true"></a>(l &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;foo_1&quot;</span>, <span class="st">&quot;foo_2&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;foo_3&quot;</span>, <span class="st">&quot;foo_4&quot;</span>)))</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;foo_1&quot;
## 
## [[2]]
## [1] &quot;foo_2&quot;
## 
## [[3]]
## [1] &quot;foo_3&quot; &quot;foo_4&quot;</code></pre>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="données.html#cb376-1" aria-hidden="true"></a>l[[<span class="dv">3</span>]]  <span class="co"># Troisième élément de la liste</span></span></code></pre></div>
<pre><code>## [1] &quot;foo_3&quot; &quot;foo_4&quot;</code></pre>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="données.html#cb378-1" aria-hidden="true"></a>l[[<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>)]] <span class="co"># Premier élément du troisième élément</span></span></code></pre></div>
<pre><code>## [1] &quot;foo_3&quot;</code></pre>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="données.html#cb380-1" aria-hidden="true"></a>l[[<span class="dv">3</span>]][<span class="dv">1</span>]   <span class="co"># Premier élément du troisième élément</span></span></code></pre></div>
<pre><code>## [1] &quot;foo_3&quot;</code></pre>
<p>Pour modifier l’élément d’une liste ou son contenu, on utilise encore la flèche d’assignation. Attention, ceci peut être destructif. En effet, si on indique à R que l’on souhaite modifier le contenu d’un élément, en utilisant la fonction <code>"[["()</code>, le résultat sera le même qu’en utilisant la fonction <code>"["()</code>.</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="données.html#cb382-1" aria-hidden="true"></a>l &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">1</span>, <span class="ot">TRUE</span>, <span class="st">&quot;foo&quot;</span>, <span class="kw">list</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">ncol =</span> <span class="dv">2</span>), <span class="st">&quot;foo_2&quot;</span>))</span>
<span id="cb382-2"><a href="données.html#cb382-2" aria-hidden="true"></a>l[[<span class="dv">4</span>]] &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb382-3"><a href="données.html#cb382-3" aria-hidden="true"></a>l  <span class="co"># La liste en position 4 a été remplacée par un vecteur de longueur 1</span></span></code></pre></div>
<pre><code>## [[1]]
## [1] 1
## 
## [[2]]
## [1] TRUE
## 
## [[3]]
## [1] &quot;foo&quot;
## 
## [[4]]
## [1] 2</code></pre>
</div>
<div id="accès-par-noms" class="section level4" number="2.4.2.2">
<h4><span class="header-section-number">2.4.2.2</span> Accès par noms</h4>
<p>Comme précisé dans la Section <a href="données.html#structures">2.2</a>, les éléments d’un <em>vecteur</em> peuvent posséder un nom. Il est alors possible d’accéder à un élément par son nom.</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="données.html#cb384-1" aria-hidden="true"></a>personne &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">nom =</span> <span class="st">&quot;Piketty&quot;</span>, <span class="dt">prenom =</span> <span class="st">&quot;Thomas&quot;</span>, <span class="st">&quot;annee de naissance&quot;</span> =<span class="st"> &quot;1971&quot;</span>)</span>
<span id="cb384-2"><a href="données.html#cb384-2" aria-hidden="true"></a>personne[<span class="st">&quot;nom&quot;</span>]</span></code></pre></div>
<pre><code>##       nom 
## &quot;Piketty&quot;</code></pre>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="données.html#cb386-1" aria-hidden="true"></a><span class="kw">names</span>(personne)  <span class="co"># Accès aux noms des éléments du vecteur</span></span></code></pre></div>
<pre><code>## [1] &quot;nom&quot;                &quot;prenom&quot;             &quot;annee de naissance&quot;</code></pre>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="données.html#cb388-1" aria-hidden="true"></a><span class="kw">names</span>(personne) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;nom&quot;</span>, <span class="st">&quot;prenom&quot;</span>, <span class="st">&quot;naissance&quot;</span>)  <span class="co"># Modification des noms</span></span>
<span id="cb388-2"><a href="données.html#cb388-2" aria-hidden="true"></a>personne</span></code></pre></div>
<pre><code>##       nom    prenom naissance 
## &quot;Piketty&quot;  &quot;Thomas&quot;    &quot;1971&quot;</code></pre>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="données.html#cb390-1" aria-hidden="true"></a><span class="kw">names</span>(personne) &lt;-<span class="st"> </span><span class="ot">NULL</span> <span class="co"># Suppression des noms</span></span>
<span id="cb390-2"><a href="données.html#cb390-2" aria-hidden="true"></a>personne</span></code></pre></div>
<pre><code>## [1] &quot;Piketty&quot; &quot;Thomas&quot;  &quot;1971&quot;</code></pre>
<p>Si l’objet est une <em>liste</em> ou un <em>tableau de données</em>, on peut aussi utiliser le symbole dollar (<code>$</code>).</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="données.html#cb392-1" aria-hidden="true"></a>personne_liste &lt;-<span class="st"> </span></span>
<span id="cb392-2"><a href="données.html#cb392-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">list</span>(<span class="st">&#39;nom de famille&#39;</span> =<span class="st"> &quot;Piketty&quot;</span>, <span class="dt">prenom =</span> <span class="st">&quot;Thomas&quot;</span>, <span class="dt">annee =</span> <span class="dv">1971</span>)</span>
<span id="cb392-3"><a href="données.html#cb392-3" aria-hidden="true"></a>personne_liste[[<span class="st">&quot;nom de famille&quot;</span>]]</span></code></pre></div>
<pre><code>## [1] &quot;Piketty&quot;</code></pre>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="données.html#cb394-1" aria-hidden="true"></a>personne_liste<span class="op">$</span><span class="st">&quot;nom de famille&quot;</span>  <span class="co"># Le nom contenant au moins une espace,</span></span></code></pre></div>
<pre><code>## [1] &quot;Piketty&quot;</code></pre>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="données.html#cb396-1" aria-hidden="true"></a>    <span class="co"># Il est nécessaire d&#39;employer des guillemets</span></span>
<span id="cb396-2"><a href="données.html#cb396-2" aria-hidden="true"></a>personne_liste<span class="op">$</span>prenom</span></code></pre></div>
<pre><code>## [1] &quot;Thomas&quot;</code></pre>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="données.html#cb398-1" aria-hidden="true"></a><span class="kw">names</span>(personne_liste)  <span class="co"># Accès aux noms des éléments de la liste</span></span></code></pre></div>
<pre><code>## [1] &quot;nom de famille&quot; &quot;prenom&quot;         &quot;annee&quot;</code></pre>
<p>Dans le cas des <em>matrices</em> et des <em>tableaux de données</em>, il est possible de donner un nom aux lignes (pas avec les <em>tibbles</em>) et aux colonnes, avec les fonctions <code>rownames()</code> et <code>colnames()</code> respectivement. La fonction <code>dimnames()</code> retourne une liste dont le premier élément est une liste contenant le vecteur des noms de lignes, et le second élément une liste contenant le vecteur des noms de colonnes.</p>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="données.html#cb400-1" aria-hidden="true"></a>femmes &lt;-</span>
<span id="cb400-2"><a href="données.html#cb400-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">height =</span><span class="kw">c</span>(<span class="dv">58</span>, <span class="dv">59</span>, <span class="dv">60</span>, <span class="dv">61</span>, <span class="dv">62</span>, <span class="dv">63</span>, <span class="dv">64</span>, <span class="dv">65</span>, <span class="dv">66</span>,</span>
<span id="cb400-3"><a href="données.html#cb400-3" aria-hidden="true"></a>                   <span class="dv">67</span>, <span class="dv">68</span>,<span class="dv">69</span>, <span class="dv">70</span>, <span class="dv">71</span>, <span class="dv">72</span>),</span>
<span id="cb400-4"><a href="données.html#cb400-4" aria-hidden="true"></a>         <span class="dt">weight =</span><span class="kw">c</span>(<span class="dv">115</span>, <span class="dv">117</span>, <span class="dv">120</span>, <span class="dv">123</span>, <span class="dv">126</span>, <span class="dv">129</span>, <span class="dv">132</span>, </span>
<span id="cb400-5"><a href="données.html#cb400-5" aria-hidden="true"></a>                   <span class="dv">135</span>, <span class="dv">139</span>,<span class="dv">142</span>, <span class="dv">146</span>, <span class="dv">150</span>, <span class="dv">154</span>, <span class="dv">159</span>, <span class="dv">164</span>))</span>
<span id="cb400-6"><a href="données.html#cb400-6" aria-hidden="true"></a><span class="kw">colnames</span>(femmes)</span></code></pre></div>
<pre><code>## [1] &quot;height&quot; &quot;weight&quot;</code></pre>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="données.html#cb402-1" aria-hidden="true"></a><span class="kw">rownames</span>(femmes)</span></code></pre></div>
<pre><code>##  [1] &quot;1&quot;  &quot;2&quot;  &quot;3&quot;  &quot;4&quot;  &quot;5&quot;  &quot;6&quot;  &quot;7&quot;  &quot;8&quot;  &quot;9&quot;  &quot;10&quot; &quot;11&quot; &quot;12&quot; &quot;13&quot; &quot;14&quot; &quot;15&quot;</code></pre>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="données.html#cb404-1" aria-hidden="true"></a><span class="kw">dimnames</span>(femmes)</span></code></pre></div>
<pre><code>## [[1]]
##  [1] &quot;1&quot;  &quot;2&quot;  &quot;3&quot;  &quot;4&quot;  &quot;5&quot;  &quot;6&quot;  &quot;7&quot;  &quot;8&quot;  &quot;9&quot;  &quot;10&quot; &quot;11&quot; &quot;12&quot; &quot;13&quot; &quot;14&quot; &quot;15&quot;
## 
## [[2]]
## [1] &quot;height&quot; &quot;weight&quot;</code></pre>

<div class="remarque">
Lorsqu’on extrait des éléments d’un objet à l’aide des noms, les attributs de l’objet d’origine ne sont pas altérés.
</div>
<p>Pour remplacer des valeurs, on utilise encore la flèche d’assignation. R produit un message d’erreur si l’élément de remplacement n’est pas de la bonne longueur pour le <em>tibble</em> ou le <em>data frame</em>.</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="données.html#cb406-1" aria-hidden="true"></a>tb &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq_len</span>(<span class="dv">3</span>), <span class="dt">y =</span> <span class="kw">rep</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">z =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">3</span>))</span>
<span id="cb406-2"><a href="données.html#cb406-2" aria-hidden="true"></a>tb<span class="op">$</span>x &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, <span class="dv">3</span>)</span>
<span id="cb406-3"><a href="données.html#cb406-3" aria-hidden="true"></a>tb</span></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##   x         y     z
##   &lt;lgl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 NA        2     1
## 2 NA        2     4
## 3 NA        2     3</code></pre>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="données.html#cb408-1" aria-hidden="true"></a>tb<span class="op">$</span>x &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## Error: Assigned data `rep(1, 4)` must be compatible with existing data.
## x Existing data has 3 rows.
## x Assigned data has 4 rows.
## ℹ Only vectors of size 1 are recycled.</code></pre>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="données.html#cb410-1" aria-hidden="true"></a>tb  <span class="co"># La modification n&#39;a pas été faite</span></span></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##   x         y     z
##   &lt;lgl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 NA        2     1
## 2 NA        2     4
## 3 NA        2     3</code></pre>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="données.html#cb412-1" aria-hidden="true"></a><span class="co"># Attention</span></span>
<span id="cb412-2"><a href="données.html#cb412-2" aria-hidden="true"></a><span class="kw">is.list</span>(tb<span class="op">$</span>x)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="données.html#cb414-1" aria-hidden="true"></a>tb<span class="op">$</span>x &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb414-2"><a href="données.html#cb414-2" aria-hidden="true"></a>tb<span class="op">$</span>x    <span class="co"># La colonne &quot;x&quot; a changé de structure !</span></span></code></pre></div>
<pre><code>## [[1]]
## [1] 4
## 
## [[2]]
## [1] 3
## 
## [[3]]
## [1] 2</code></pre>
</div>
</div>
<div id="chaînes-de-caractères" class="section level3" number="2.4.3">
<h3><span class="header-section-number">2.4.3</span> Chaînes de caractères</h3>
<p>Savoir manipuler les chaînes de caractères permet de gagner énormément de temps dans le traitement de données texte, mais permet également de produire des sorties, graphiques ou non, plus lisibles et compréhensibles que les affichages par défaut proposés par R. Le lecteur ou la lectrice intéressé•e par la manipulation avancée des chaînes de caractères en R est invité à consulter l’<em>ebook</em> de Gaston Sanchez <span class="citation">(Sanchez <a href="#ref-Sanchez_2013_Handling" role="doc-biblioref">2013</a>)</span>.</p>
<div id="concaténation" class="section level4" number="2.4.3.1">
<h4><span class="header-section-number">2.4.3.1</span> Concaténation</h4>
<p>La fonction <code>cat()</code> concatène et affiche à l’écran des objets. Les arguments qui sont fournis sont convertis en vecteurs de chaînes de caractères, qui sont ensuite concaténés en un seul vecteur de caractères. Les éléments de ce vecteur sont ensuite joints entre eux, et éventuellement séparés par un caractère différent de l’espace, si l’argument <code>sep</code> est modifié.</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="données.html#cb416-1" aria-hidden="true"></a><span class="kw">cat</span>(<span class="st">&quot;Hello&quot;</span>, <span class="st">&quot;World&quot;</span>, <span class="st">&quot;!&quot;</span>)</span></code></pre></div>
<pre><code>## Hello World !</code></pre>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="données.html#cb418-1" aria-hidden="true"></a><span class="co"># En ajoutant un passage à la ligne entre chaque élément</span></span>
<span id="cb418-2"><a href="données.html#cb418-2" aria-hidden="true"></a><span class="kw">cat</span>(<span class="st">&quot;Hello&quot;</span>, <span class="st">&quot;World&quot;</span>, <span class="st">&quot;!&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Hello
## World
## !</code></pre>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="données.html#cb420-1" aria-hidden="true"></a><span class="kw">cat</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>))</span></code></pre></div>
<pre><code>## 1 2 3 4 5 6</code></pre>

<div class="remarque">
<p>Le caractère <code>\</code> (barre oblique inversée, ou <em>backslash</em>) est le caractère d’échappement en R. Il permet d’afficher certains caractères, comme les guillemets dans une chaîne elle-même définie à l’aide de guillemets, ou bien les caractères de contrôle, comme la tabulation, le saut de ligne, etc. Le fichier d’aide  de R fournir de plus amples détails. Le tableau ci-dessous fournit quelques exemple courants.</p>
<table>
<thead>
<tr class="header">
<th>Caractère</th>
<th>Description</th>
<th>Caractère</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>\n</code></td>
<td>Nouvelle ligne</td>
<td><code>\r</code></td>
<td>Retour à la ligne</td>
</tr>
<tr class="even">
<td><code>\t</code></td>
<td>Tabulation</td>
<td><code>\b</code></td>
<td>Retour arrière</td>
</tr>
<tr class="odd">
<td><code>\\</code></td>
<td>Barre olbique inversée</td>
<td><code>\'</code></td>
<td>Apostrophe</td>
</tr>
<tr class="even">
<td><code>\"</code></td>
<td>Apostrophe double</td>
<td><code>\‘</code></td>
<td>Accent grave</td>
</tr>
</tbody>
</table>
</div>
<p>La fonction <code>str_c()</code> du <em>package</em> {<code>stringr</code>} convertit en chaîne de caractères les éléments passés en argument puis les concatène. Il est tout à fait possible de stocker le résultat dans un objet, dans la mesure où le résultat de l’évaluation de <code>str_c()</code>, contrairement à celui de l’évaluation de <code>cat()</code> est une chaîne de caractères. L’argument <code>sep</code> permet de définir la chaîne de caractères séparant les termes (rien par défaut).</p>
<p>Il est nécessaire de charger le <em>package</em> avant d’appeler les fonctions qu’il contient (et de l’installer lors de la première utilisation).</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="données.html#cb422-1" aria-hidden="true"></a><span class="kw">library</span>(stringr)</span>
<span id="cb422-2"><a href="données.html#cb422-2" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">str_c</span>(<span class="st">&quot;Hello&quot;</span>, <span class="st">&quot;World&quot;</span>, <span class="st">&quot;!&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb422-3"><a href="données.html#cb422-3" aria-hidden="true"></a>x</span></code></pre></div>
<pre><code>## [1] &quot;Hello World !&quot;</code></pre>
<p>La fonction <code>str_c()</code> dispose aussi de l’argument <code>collapse</code>, qui est utile pour joindre les éléments d’un vecteur dans une même chaîne de caractères.</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="données.html#cb424-1" aria-hidden="true"></a><span class="kw">str_c</span>(<span class="kw">c</span>(<span class="st">&quot;Marseille&quot;</span>, <span class="st">&quot;Bouches-du-Rhône&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;Marseille&quot;        &quot;Bouches-du-Rhône&quot;</code></pre>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="données.html#cb426-1" aria-hidden="true"></a><span class="co"># Il n&#39;y a qu&#39;un argument, donc le séparateur est inutile !</span></span>
<span id="cb426-2"><a href="données.html#cb426-2" aria-hidden="true"></a><span class="kw">str_c</span>(<span class="kw">c</span>(<span class="st">&quot;Marseille&quot;</span>, <span class="st">&quot;Bouches-du-Rhône&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;, &quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Marseille&quot;        &quot;Bouches-du-Rhône&quot;</code></pre>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="données.html#cb428-1" aria-hidden="true"></a><span class="co"># En ajoutant l&#39;argument collapse</span></span>
<span id="cb428-2"><a href="données.html#cb428-2" aria-hidden="true"></a><span class="kw">str_c</span>(<span class="kw">c</span>(<span class="st">&quot;Marseille&quot;</span>, <span class="st">&quot;Bouches-du-Rhône&quot;</span>), <span class="dt">collapse =</span> <span class="st">&quot;, &quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Marseille, Bouches-du-Rhône&quot;</code></pre>

<div class="remarque">
La fonction <code>str_c()</code> s’appuie en fait sur la fonction <code>paste()</code> du <em>package</em> {<code>base</code>}. Par défaut, la chaîne de séparation utilisée dans <code>paste()</code> est une espace. La fonction <code>paste0()</code> permet quant à elle de concaténer les chaînes sans séparateur.
Il existe cependant de légères différences entre les deux fonctions, comme la festion des éléments <code>NULL</code> et <code>character(0)</code> :
</div>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="données.html#cb430-1" aria-hidden="true"></a><span class="kw">paste</span>(<span class="st">&quot;You&quot;</span>, <span class="st">&quot;shall&quot;</span>, <span class="kw">character</span>(<span class="dv">0</span>), <span class="st">&quot;not&quot;</span>, <span class="ot">NULL</span>, <span class="st">&quot;pass&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;You shall  not  pass&quot;</code></pre>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="données.html#cb432-1" aria-hidden="true"></a><span class="kw">str_c</span>(<span class="st">&quot;You&quot;</span>, <span class="st">&quot;shall&quot;</span>, <span class="kw">character</span>(<span class="dv">0</span>), <span class="st">&quot;not&quot;</span>, <span class="ot">NULL</span>, <span class="st">&quot;pass&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;You shall not pass&quot;</code></pre>
<p>Si les objets donnés en argument à la fonction <code>str_c()</code> sont de tailles différentes, un recyclage est effectué par R.</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="données.html#cb434-1" aria-hidden="true"></a><span class="kw">str_c</span>(<span class="st">&quot;Hello&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Julien-Yacine&quot;</span>, <span class="st">&quot;Sonia&quot;</span>, <span class="st">&quot;Victor&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;HelloJulien-Yacine&quot; &quot;HelloSonia&quot;         &quot;HelloVictor&quot;</code></pre>
<p>Attention, R convertit les valeurs manquantes (<code>NA</code>) en chaînes de caractères <code>"NA"</code>.</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="données.html#cb436-1" aria-hidden="true"></a><span class="kw">str_c</span>(<span class="st">&quot;Hello&quot;</span>, <span class="ot">NA</span>)</span></code></pre></div>
<pre><code>## [1] NA</code></pre>

<div class="remarque">
Quand on souhaite accéder à une variable en renseignant son nom en utilisant la fonction <code>str_c()</code>, il faut faire appel à la fonction <code>get()</code>.
</div>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="données.html#cb438-1" aria-hidden="true"></a>variable_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb438-2"><a href="données.html#cb438-2" aria-hidden="true"></a><span class="co"># Affiche la chaîne &quot;variable_1&quot;</span></span>
<span id="cb438-3"><a href="données.html#cb438-3" aria-hidden="true"></a><span class="kw">str_c</span>(<span class="st">&quot;variable_&quot;</span>, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] &quot;variable_1&quot;</code></pre>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="données.html#cb440-1" aria-hidden="true"></a><span class="co"># Affiche le contenu de la variable nommée &quot;variable_1&quot;</span></span>
<span id="cb440-2"><a href="données.html#cb440-2" aria-hidden="true"></a><span class="kw">get</span>(<span class="kw">str_c</span>(<span class="st">&quot;variable_&quot;</span>, <span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
</div>
<div id="conversion-en-majuscules-ou-minuscules" class="section level4" number="2.4.3.2">
<h4><span class="header-section-number">2.4.3.2</span> Conversion en majuscules ou minuscules</h4>
<p>Afin de passer une chaîne de caractères en majuscules ou en minuscules, le <em>package</em> {<code>stringr</code>} propose les fonctions <code>str_to_upper()</code> et <code>str_to_lower()</code>.</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="données.html#cb442-1" aria-hidden="true"></a>x &lt;-<span class="st"> &quot;Bonjour !&quot;</span></span>
<span id="cb442-2"><a href="données.html#cb442-2" aria-hidden="true"></a><span class="kw">str_to_upper</span>(x)</span></code></pre></div>
<pre><code>## [1] &quot;BONJOUR !&quot;</code></pre>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="données.html#cb444-1" aria-hidden="true"></a><span class="kw">str_to_lower</span>(x)</span></code></pre></div>
<pre><code>## [1] &quot;bonjour !&quot;</code></pre>
</div>
<div id="compter-le-nombre-de-caractères-dune-chaîne" class="section level4" number="2.4.3.3">
<h4><span class="header-section-number">2.4.3.3</span> Compter le nombre de caractères d’une chaîne</h4>
<p>La fonction <code>str_length()</code> du <em>package</em> {<code>stringr</code>} indique le nombre de caractères contenus dans une chaîne.</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="données.html#cb446-1" aria-hidden="true"></a><span class="kw">str_length</span>(<span class="st">&quot;Bonjour&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<p>La fonction <code>str_length()</code> s’appuie sur la fonction <code>nchar()</code> du <em>package</em> {<code>base</code>}. On peut noter que la longueur de <code>NA</code> vaut NA avec <code>str_length()</code> et <code>2</code> avec la fonction native <code>nchar()</code>.</p>
<pre class="donnees_manip_strings_stringr_length"><code>texte &lt;- c(&quot;Mais enfin&quot;, &quot;c&#39;est quoi&quot;, &quot;un gigowatt ?&quot;, NA)
str_length(string = texte)
nchar(x = texte)</code></pre>
</div>
<div id="extraction-de-sous-chaînes" class="section level4" number="2.4.3.4">
<h4><span class="header-section-number">2.4.3.4</span> Extraction de sous-chaînes</h4>
<p>Pour extraire une sous-chaîne, on peut utiliser la fonction <code>str_sub()</code> du <em>package</em> {<code>stringr</code>}, qui prend en arguments une chaîne de caractères, la position du début et celle de la fin de l’élément à extraire. Attention, l’indice du premier élément, tout comme pour les vecteurs, est 1 en R.</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="données.html#cb449-1" aria-hidden="true"></a>x &lt;-<span class="st"> &quot;Debt is one person&#39;s liability, but another person&#39;s asset.&quot;</span></span>
<span id="cb449-2"><a href="données.html#cb449-2" aria-hidden="true"></a><span class="kw">str_sub</span>(x, <span class="dv">1</span>, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Debt&quot;</code></pre>
<p>Il est possible d’utiliser la flèche d’assignation après la fonction <code>str_sub()</code> pour remplacer la sous-chaîne extraite par une autre. Si la chaîne de remplacement est trop longue, elle n’est pas tronquée pour avoir la même longueur que celle qui est extraite.</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="données.html#cb451-1" aria-hidden="true"></a><span class="kw">str_sub</span>(x, <span class="dv">1</span>, <span class="dv">4</span>) &lt;-<span class="st"> &quot;Remplacement&quot;</span></span>
<span id="cb451-2"><a href="données.html#cb451-2" aria-hidden="true"></a>x</span></code></pre></div>
<pre><code>## [1] &quot;Remplacement is one person&#39;s liability, but another person&#39;s asset.&quot;</code></pre>
<p>L’argument <code>string</code> de la fonction <code>str_sub()</code> peut être un vecteur. Dans ce cas, la fonction est appliquée à chaque élément du vecteur.</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="données.html#cb453-1" aria-hidden="true"></a><span class="kw">str_sub</span>(<span class="kw">c</span>(<span class="st">&quot;Rouge&quot;</span>, <span class="st">&quot;Vert&quot;</span>, <span class="st">&quot;Bleu&quot;</span>), <span class="dv">2</span>, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] &quot;ou&quot; &quot;er&quot; &quot;le&quot;</code></pre>
<p>Lors du remplacement, R peut avoir recours au recyclage.</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="données.html#cb455-1" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Rouge&quot;</span>, <span class="st">&quot;Vert&quot;</span>, <span class="st">&quot;Bleu&quot;</span>)</span>
<span id="cb455-2"><a href="données.html#cb455-2" aria-hidden="true"></a><span class="kw">str_sub</span>(x, <span class="dv">2</span>, <span class="dv">3</span>) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;!!&quot;</span>, <span class="st">&quot;@@&quot;</span>)</span>
<span id="cb455-3"><a href="données.html#cb455-3" aria-hidden="true"></a>x</span></code></pre></div>
<pre><code>## [1] &quot;R!!ge&quot; &quot;V@@t&quot;  &quot;B!!u&quot;</code></pre>
<p>En fournissant aux arguments <code>start</code> et <code>end</code> des valeurs négatives, on indique à R de lire la chaîne à l’envers :</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="données.html#cb457-1" aria-hidden="true"></a>texte &lt;-<span class="st"> &quot;le train de tes injures roule sur le rail de mon indifférence&quot;</span></span>
<span id="cb457-2"><a href="données.html#cb457-2" aria-hidden="true"></a><span class="kw">str_sub</span>(<span class="dt">string =</span> texte, <span class="dt">start =</span> <span class="dv">4</span>, <span class="dt">end =</span> <span class="dv">8</span>)</span></code></pre></div>
<pre><code>## [1] &quot;train&quot;</code></pre>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="données.html#cb459-1" aria-hidden="true"></a><span class="co"># Compter à partir du dernier caractère</span></span>
<span id="cb459-2"><a href="données.html#cb459-2" aria-hidden="true"></a><span class="kw">str_sub</span>(<span class="dt">string =</span> texte, <span class="dt">start =</span> <span class="dv">-12</span>, <span class="dt">end =</span> <span class="dv">-1</span>)</span></code></pre></div>
<pre><code>## [1] &quot;indifférence&quot;</code></pre>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="données.html#cb461-1" aria-hidden="true"></a><span class="kw">str_sub</span>(<span class="dt">string =</span> texte, <span class="dt">start =</span> <span class="dv">-16</span>)</span></code></pre></div>
<pre><code>## [1] &quot;mon indifférence&quot;</code></pre>
<p>La fonction <code>str_sub()</code> s’appuie sur la fonction <code>substr()</code> du <em>package</em> {<code>base</code>}, mais propose quelques améliorations.</p>
<p>Dans le cas du remplacement d’une chaîne extraitre par une autre, on distingue trois cas :</p>
<ul>
<li>la chaîne de remplacement est de même longueur que celle extraite : <code>str_sub()</code> et <code>substr()</code> se comportent de la même manière ;</li>
<li>a chaîne de remplacement est plus courte que celle extraite : avec <code>substr()</code>, la chaîne de remplacement est complétée par la fin de celle extraite, tandis qu’avec <code>str_sub()</code>, la chaîne extraite est retirée et remplacée par celle de remplacement ;</li>
<li>la chaîne de remplacement est plus longue que celle extraite : avec <code>substr()</code>, la chaîne de remplacement est tronquée, tandis qu’elle ne l’est pas avec <code>str_sub()</code>.</li>
</ul>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="données.html#cb463-1" aria-hidden="true"></a>texte &lt;-<span class="st"> &quot;le train de tes injures roule sur le rail de mon indifférence&quot;</span></span>
<span id="cb463-2"><a href="données.html#cb463-2" aria-hidden="true"></a><span class="co"># On copie le contenu de texte dans une nouvelle variable</span></span>
<span id="cb463-3"><a href="données.html#cb463-3" aria-hidden="true"></a>texte_<span class="dv">2</span> &lt;-<span class="st"> </span>texte</span>
<span id="cb463-4"><a href="données.html#cb463-4" aria-hidden="true"></a></span>
<span id="cb463-5"><a href="données.html#cb463-5" aria-hidden="true"></a><span class="co"># Remplacement plus court que la chaîne extraite</span></span>
<span id="cb463-6"><a href="données.html#cb463-6" aria-hidden="true"></a><span class="kw">str_sub</span>(<span class="dt">string =</span> texte, <span class="dt">start =</span> <span class="dv">17</span>, <span class="dt">end =</span> <span class="dv">23</span>)</span></code></pre></div>
<pre><code>## [1] &quot;injures&quot;</code></pre>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="données.html#cb465-1" aria-hidden="true"></a><span class="kw">str_sub</span>(<span class="dt">string =</span> texte, <span class="dt">start =</span> <span class="dv">17</span>, <span class="dt">end =</span> <span class="dv">23</span>) &lt;-<span class="st"> &quot;jurons&quot;</span></span>
<span id="cb465-2"><a href="données.html#cb465-2" aria-hidden="true"></a><span class="kw">substr</span>(<span class="dt">x =</span> texte_<span class="dv">2</span>, <span class="dt">start =</span> <span class="dv">17</span>, <span class="dt">stop =</span> <span class="dv">23</span>) &lt;-<span class="st"> &quot;jurons&quot;</span></span>
<span id="cb465-3"><a href="données.html#cb465-3" aria-hidden="true"></a>texte ; texte_<span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] &quot;le train de tes jurons roule sur le rail de mon indifférence&quot;</code></pre>
<pre><code>## [1] &quot;le train de tes juronss roule sur le rail de mon indifférence&quot;</code></pre>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="données.html#cb468-1" aria-hidden="true"></a><span class="co"># Remplacement plus long que la chaîne extraite</span></span>
<span id="cb468-2"><a href="données.html#cb468-2" aria-hidden="true"></a><span class="kw">str_sub</span>(<span class="dt">string =</span> texte, <span class="dt">start =</span> <span class="dv">1</span>, <span class="dt">end =</span> <span class="dv">8</span>)</span></code></pre></div>
<pre><code>## [1] &quot;le train&quot;</code></pre>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="données.html#cb470-1" aria-hidden="true"></a><span class="kw">str_sub</span>(<span class="dt">string =</span> texte, <span class="dt">start =</span> <span class="dv">1</span>, <span class="dt">end =</span> <span class="dv">8</span>) &lt;-<span class="st"> &quot;la locomotive&quot;</span></span>
<span id="cb470-2"><a href="données.html#cb470-2" aria-hidden="true"></a><span class="kw">substr</span>(<span class="dt">x =</span> texte_<span class="dv">2</span>, <span class="dt">start =</span> <span class="dv">1</span>, <span class="dt">stop =</span> <span class="dv">8</span>) &lt;-<span class="st"> &quot;la locomotive&quot;</span></span>
<span id="cb470-3"><a href="données.html#cb470-3" aria-hidden="true"></a>texte ; texte_<span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] &quot;la locomotive de tes jurons roule sur le rail de mon indifférence&quot;</code></pre>
<pre><code>## [1] &quot;la locom de tes juronss roule sur le rail de mon indifférence&quot;</code></pre>
</div>
<div id="manip-strings-regex" class="section level4" number="2.4.3.5">
<h4><span class="header-section-number">2.4.3.5</span> Recherche de chaînes de caractères</h4>
<p>Quand on souhaite trouver un motif (<em>pattern</em>) dans un vecteur de chaînes de caractères, on peut utiliser la fonction <code>str_detect()</code> du <em>package</em> <code>stringr</code>. Elle retourne les indices des éléments du vecteur dans lesquels le motif a été trouvé.</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="données.html#cb473-1" aria-hidden="true"></a><span class="kw">str_detect</span>(<span class="dt">string =</span> <span class="kw">c</span>(<span class="st">&quot;Pomme&quot;</span>, <span class="st">&quot;Poire&quot;</span>, <span class="st">&quot;Ananas&quot;</span>), <span class="dt">pattern =</span> <span class="st">&quot;o&quot;</span>)</span></code></pre></div>
<pre><code>## [1]  TRUE  TRUE FALSE</code></pre>
<p>Pour remplacer la première occurrence du motif trouvé par une autre chaîne (qui n’est pas tenue d’être de la même longueur de caractères), on peut utiliser la fonction <code>str_replace()</code>.</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="données.html#cb475-1" aria-hidden="true"></a><span class="kw">str_replace</span>(<span class="dt">string =</span> <span class="kw">c</span>(<span class="st">&quot;Pomme&quot;</span>, <span class="st">&quot;Poire&quot;</span>, <span class="st">&quot;Ananas&quot;</span>), <span class="dt">pattern =</span> <span class="st">&quot;a&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot;@@&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Pomme&quot;   &quot;Poire&quot;   &quot;An@@nas&quot;</code></pre>
<p>Si on désire remplacer toutes les occurrences trouvées, il faut alors utiliser la fonction <code>str_replace_all()</code>.</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="données.html#cb477-1" aria-hidden="true"></a><span class="kw">str_replace_all</span>(<span class="dt">string =</span> <span class="kw">c</span>(<span class="st">&quot;Pomme&quot;</span>, <span class="st">&quot;Poire&quot;</span>, <span class="st">&quot;Ananas&quot;</span>), <span class="dt">pattern =</span> <span class="st">&quot;a&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot;@@&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Pomme&quot;    &quot;Poire&quot;    &quot;An@@n@@s&quot;</code></pre>
<p>Si on souhaite ignorer la casse, il suffit de faire appel à la fonction <code>regex()</code> en précisant à l’aide de l’argument <code>ignore_case</code> que l’on souhaite ne pas prendre en compte la casse :</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="données.html#cb479-1" aria-hidden="true"></a><span class="kw">str_detect</span>(<span class="dt">string =</span> <span class="kw">c</span>(<span class="st">&quot;Obi-Wan Kenobi&quot;</span>, <span class="st">&quot;Darth Vader&quot;</span>), <span class="dt">pattern =</span> <span class="st">&quot;w&quot;</span>)</span></code></pre></div>
<pre><code>## [1] FALSE FALSE</code></pre>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="données.html#cb481-1" aria-hidden="true"></a><span class="kw">str_detect</span>(<span class="dt">string =</span> <span class="kw">c</span>(<span class="st">&quot;Obi-Wan Kenobi&quot;</span>, <span class="st">&quot;Darth Vader&quot;</span>), </span>
<span id="cb481-2"><a href="données.html#cb481-2" aria-hidden="true"></a>           <span class="dt">pattern =</span> <span class="kw">regex</span>(<span class="st">&quot;w&quot;</span>, <span class="dt">ignore_case =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>## [1]  TRUE FALSE</code></pre>
<p>Pour briser une chaîne en fonction d’un motif, le <em>package</em> {<code>stringr</code>} propose la fonction <code>str_split()</code>.</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="données.html#cb483-1" aria-hidden="true"></a>x =<span class="st"> &quot;Criquette ! Vous, ici ? Dans votre propre salle de bain ? Quelle surprise !&quot;</span></span>
<span id="cb483-2"><a href="données.html#cb483-2" aria-hidden="true"></a><span class="kw">str_split</span>(<span class="dt">string =</span> x, <span class="dt">pattern =</span> <span class="st">&quot; &quot;</span>)</span></code></pre></div>
<pre><code>## [[1]]
##  [1] &quot;Criquette&quot; &quot;!&quot;         &quot;Vous,&quot;     &quot;ici&quot;       &quot;?&quot;         &quot;Dans&quot;     
##  [7] &quot;votre&quot;     &quot;propre&quot;    &quot;salle&quot;     &quot;de&quot;        &quot;bain&quot;      &quot;?&quot;        
## [13] &quot;Quelle&quot;    &quot;surprise&quot;  &quot;!&quot;</code></pre>
<p>Une des rares fonctions du <em>package</em> <code>stringr</code> ne commençant pas par le préfixe <code>str</code> est la fonction <code>word()</code>. Comme son nom le laisse présager, elle permet d’extraire des mots dans une phrase. Les mots sont repérés par défaut par une espace, mais il est possible de préciser un séparateur différent avec l’argument <code>sep</code>. L’argument <code>start</code> attend une valeur entière donnant la position du premier mot à extraire (celle du premier mot de la phrase, par défaut). Si la valeur est négative, le comptage s’effectue de la droite vers la gauche. L’argument <code>end</code> attend l’entier donnant la position du dernier mot à extraire (vaut la valeur de <code>start</code> s’il est omis). Encore une fois, si la valeur est négative, le comptage s’effectue de la droite vers la gauche.</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="données.html#cb485-1" aria-hidden="true"></a>phrase &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mademoiselle Deray, il est interdit de manger de la choucroute ici.&quot;</span>,</span>
<span id="cb485-2"><a href="données.html#cb485-2" aria-hidden="true"></a>            <span class="st">&quot;Oh si si, prenez un chewing-gum, Émile.&quot;</span>)</span>
<span id="cb485-3"><a href="données.html#cb485-3" aria-hidden="true"></a><span class="kw">word</span>(phrase) <span class="co"># Extraction du premier mot</span></span></code></pre></div>
<pre><code>## [1] &quot;Mademoiselle&quot; &quot;Oh&quot;</code></pre>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="données.html#cb487-1" aria-hidden="true"></a><span class="kw">word</span>(phrase, <span class="dv">2</span>) <span class="co"># Extraction du second mot</span></span></code></pre></div>
<pre><code>## [1] &quot;Deray,&quot; &quot;si&quot;</code></pre>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="données.html#cb489-1" aria-hidden="true"></a><span class="kw">word</span>(phrase, <span class="dv">-1</span>) <span class="co"># Extraction du dernier mot</span></span></code></pre></div>
<pre><code>## [1] &quot;ici.&quot;   &quot;Émile.&quot;</code></pre>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="données.html#cb491-1" aria-hidden="true"></a><span class="kw">word</span>(phrase, <span class="dv">2</span>, <span class="dv">-1</span>) <span class="co"># Extraction du second au dernier mot</span></span></code></pre></div>
<pre><code>## [1] &quot;Deray, il est interdit de manger de la choucroute ici.&quot;
## [2] &quot;si si, prenez un chewing-gum, Émile.&quot;</code></pre>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="données.html#cb493-1" aria-hidden="true"></a><span class="co"># Du premier au dernier mot, du second au dernier, et du troisième au dernier</span></span>
<span id="cb493-2"><a href="données.html#cb493-2" aria-hidden="true"></a><span class="co"># pour le premier élément de phrase</span></span>
<span id="cb493-3"><a href="données.html#cb493-3" aria-hidden="true"></a><span class="kw">word</span>(phrase[<span class="dv">1</span>], <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">-1</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Mademoiselle Deray, il est interdit de manger de la choucroute ici.&quot;
## [2] &quot;Deray, il est interdit de manger de la choucroute ici.&quot;             
## [3] &quot;il est interdit de manger de la choucroute ici.&quot;</code></pre>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="données.html#cb495-1" aria-hidden="true"></a><span class="co"># Premier mot, Premier et second mot, Premier et troisième mot</span></span>
<span id="cb495-2"><a href="données.html#cb495-2" aria-hidden="true"></a><span class="co"># pour le second élément de phrase</span></span>
<span id="cb495-3"><a href="données.html#cb495-3" aria-hidden="true"></a><span class="kw">word</span>(phrase[<span class="dv">2</span>], <span class="dv">1</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Oh&quot;        &quot;Oh si&quot;     &quot;Oh si si,&quot;</code></pre>

<div class="remarque">
La fonction <code>str_detect()</code> s’appuie sur la fonction <code>grepl()</code> du <em>package</em> {base} ; les fonctions <code>str_replace()</code> et <code>str_replace_all()</code> sur la fonction <code>sub()</code> du <em>package</em> {<code>base</code>}. La fonction <code>str_split()</code> correspond à la fonction <code>strsplit()</code> du <em>package</em> {<code>base</code>}.
</div>
<p>Des recherches bien plus complèxes et puissantes peuvent être effectuées avec R, et sont présentées dans la Section <a href="regex.html#regex">7</a>.</p>
</div>
<div id="nettoyage-complétion" class="section level4" number="2.4.3.6">
<h4><span class="header-section-number">2.4.3.6</span> Nettoyage, complétion</h4>
<div id="la-fonction-str_dup" class="section level5" number="2.4.3.6.1">
<h5><span class="header-section-number">2.4.3.6.1</span> La fonction <code>str_dup()</code></h5>
<p>La fonction <code>str_dup()</code> du <em>package</em> {<code>stringr</code>} permet de dupliquer du texte. Elle est vectorisée à la fois pour le vecteur de texte à fournir à l’argument <code>string</code> et au vecteur d’entiers à fournir à l’argument <code>times</code>.</p>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="données.html#cb497-1" aria-hidden="true"></a>texte &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;bla&quot;</span>, <span class="st">&quot;ah&quot;</span>, <span class="st">&quot;eh&quot;</span>)</span>
<span id="cb497-2"><a href="données.html#cb497-2" aria-hidden="true"></a><span class="kw">str_dup</span>(texte, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] &quot;blabla&quot; &quot;ahah&quot;   &quot;eheh&quot;</code></pre>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="données.html#cb499-1" aria-hidden="true"></a><span class="kw">str_dup</span>(texte, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] &quot;bla&quot;    &quot;ahah&quot;   &quot;eheheh&quot;</code></pre>
</div>
<div id="la-fonction-str_pad" class="section level5" number="2.4.3.6.2">
<h5><span class="header-section-number">2.4.3.6.2</span> La fonction <code>str_pad()</code></h5>
<p>Certains fichiers de données ont des largeurs fixes pour chaque colonne. Si on désire créer facilement ce genre de fichiers, la fonction <code>str_pad()</code> du <em>package</em> <code>stringr</code> peut se révéler très pratique. En effet, elle permet de définir un caractère à insérer avant ou après une chaîne, ou bien avant et après, et de le répéter un nombre donné de fois. On précise la longueur des chaînes retournées avec l’argument <code>width</code>, le caractère à insérer pour éventuellement compléter la chaîne avec l’argument <code>pad</code> et le côté sur lequel insérer ce caractère avec l’argument <code>side</code> pouvant prendre les valeurs <code>"left"</code>, <code>"right"</code> ou <code>"both"</code>.</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="données.html#cb501-1" aria-hidden="true"></a>coords &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">lat =</span> <span class="st">&quot;48.11&quot;</span>, <span class="dt">long =</span> <span class="st">&quot;-1.6794&quot;</span>)</span>
<span id="cb501-2"><a href="données.html#cb501-2" aria-hidden="true"></a><span class="kw">str_pad</span>(<span class="dt">string =</span> coords, <span class="dt">width =</span> <span class="dv">7</span>, <span class="dt">side =</span> <span class="st">&quot;left&quot;</span>, <span class="dt">pad =</span> <span class="st">&quot; &quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;  48.11&quot; &quot;-1.6794&quot;</code></pre>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="données.html#cb503-1" aria-hidden="true"></a><span class="co"># Les chaînes plus longues que la valeur fournie à width sont inchangées</span></span>
<span id="cb503-2"><a href="données.html#cb503-2" aria-hidden="true"></a><span class="kw">str_pad</span>(<span class="kw">c</span>(<span class="st">&quot;Gauthier&quot;</span>, <span class="st">&quot;Pascaline&quot;</span>), <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Gauthier&quot;  &quot;Pascaline&quot;</code></pre>
<p>Cette fonction est également utile lorsque l’on veut créer des noms de fichiers préfixés par un nombre, de manière à permettre leur rangement par ordre croissant dans l’explorateur de fichier (<code>10.txt</code> viendra avant <code>9.txt</code> tandis que <code>09.txt</code> viendra avant <code>10.txt</code>).</p>
</div>
<div id="la-fonction-str_trim" class="section level5" number="2.4.3.6.3">
<h5><span class="header-section-number">2.4.3.6.3</span> La fonction <code>str_trim()</code></h5>
<p>Pour retirer des caractères blancs (e.g., espaces, sauts de ligne, retours à la ligne, quadratins, etc.), on peut utiliser des méthodes abordées dans la Section @ref(manip_strings_regex), ou bien la fonction <code>str_trim()</code> du <em>package</em> {<code>stringr</code>}. Elle retire tous les caractères blancs à gauche et à droite d’une chaîne de caractères. L’argument <code>side</code> permet de choisir le côté pour lequel on désire retirer les caractères blancs. Il peut prendre les valeurs <code>both</code> (par défaut), <code>left</code> ou <code>right</code>.</p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="données.html#cb505-1" aria-hidden="true"></a>texte &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;</span><span class="ch">\n\n</span><span class="st">Pardon, du sucre ?&quot;</span>, <span class="st">&quot;Oui, seize   </span><span class="ch">\n</span><span class="st"> &quot;</span>, <span class="st">&quot;...</span><span class="ch">\t\t</span><span class="st">...</span><span class="ch">\t</span><span class="st">&quot;</span>)</span>
<span id="cb505-2"><a href="données.html#cb505-2" aria-hidden="true"></a><span class="kw">str_trim</span>(texte, <span class="dt">side =</span> <span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Pardon, du sucre ?&quot; &quot;Oui, seize&quot;         &quot;...\t\t...&quot;</code></pre>
</div>
</div>
</div>
<div id="dates-1" class="section level3" number="2.4.4">
<h3><span class="header-section-number">2.4.4</span> Dates</h3>
<p>Comme indiqué dans la Section <a href="données.html#structure-dates">2.2.1.3</a>, les dates en R peuvent être de trois classes différentes, <code>Date</code>, <code>POSIXct</code> et <code>POSIXlt</code>. Dans cette Section, nous allons voir comment manipuler ces dates, à l’aide des fonctions du <em>package</em> {<code>lubridate</code>}.</p>
<div id="extraction" class="section level4" number="2.4.4.1">
<h4><span class="header-section-number">2.4.4.1</span> Extraction</h4>
<p>Le <em>package</em> {<code>lubridate</code>} propose quelques fonctions pour accéder aux éléments d’une date.</p>
<table>
<colgroup>
<col width="45%" />
<col width="54%" />
</colgroup>
<thead>
<tr class="header">
<th>Fonction</th>
<th>Extraction</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>second()</code></td>
<td>secondes (0–59)</td>
</tr>
<tr class="even">
<td><code>minute()</code></td>
<td>minutes (0–59)</td>
</tr>
<tr class="odd">
<td><code>hour()</code></td>
<td>heures (0–23)</td>
</tr>
<tr class="even">
<td><code>day()</code>, <code>mday()</code></td>
<td>jour du mois (1–31)</td>
</tr>
<tr class="odd">
<td><code>wday()</code></td>
<td>jour de la semaine (1–7), le dimanche étant le 1</td>
</tr>
<tr class="even">
<td><code>yday()</code></td>
<td>jour de l’année (1–366)</td>
</tr>
<tr class="odd">
<td><code>week()</code></td>
<td>numéro de la semaine dans l’année. Les semaines sont définies comme les pé- riodes complètes de 7 jours s’étant déroulées depuis le premier janvier, plus 1</td>
</tr>
<tr class="even">
<td><code>isoweek()</code></td>
<td>Semaine de l’année (00-53). Si la semaine (qui commence un lundi) qui contient le 1er janvier a 4 jours ou plus dans la nouvelle année, alors elle est considérée comme la semaine 1. Sinon, elle est considérée comme la dernière de l’année précédente, et la suivante est considérée comme semaine 1</td>
</tr>
<tr class="odd">
<td><code>month()</code></td>
<td>mois (1–12)</td>
</tr>
<tr class="even">
<td><code>year()</code></td>
<td>année, uniquement celles après l’an 1</td>
</tr>
<tr class="odd">
<td><code>tz()</code></td>
<td>fuseau horraire</td>
</tr>
</tbody>
</table>
<p>Les fonctions <code>wday()</code> et <code>month()</code> permettent aussi d’afficher le jour de la semaine et le mois, respectivement, en chaîne de caractères, en donnant leur nom dans le langage par défaut de votre session R. Pour cela, il faut attribuer la valeur <code>TRUE</code> a l’argument <code>label</code>. Si on souhaite les abréviations, il faut donner la valeur <code>TRUE</code> à l’argument <code>abbr</code> en sus.</p>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="données.html#cb507-1" aria-hidden="true"></a><span class="kw">library</span>(lubridate)</span>
<span id="cb507-2"><a href="données.html#cb507-2" aria-hidden="true"></a>(d &lt;-<span class="st"> </span><span class="kw">ymd_hms</span>(<span class="st">&quot;2020-03-17 23:59:59&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;2020-03-17 23:59:59 UTC&quot;</code></pre>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="données.html#cb509-1" aria-hidden="true"></a>lubridate<span class="op">::</span><span class="kw">wday</span>(d, <span class="dt">label =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] Mar
## Levels: Dim &lt; Lun &lt; Mar &lt; Mer &lt; Jeu &lt; Ven &lt; Sam</code></pre>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="données.html#cb511-1" aria-hidden="true"></a>lubridate<span class="op">::</span><span class="kw">wday</span>(d, <span class="dt">label =</span> <span class="ot">TRUE</span>, <span class="dt">abbr =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] Mar
## Levels: Dim &lt; Lun &lt; Mar &lt; Mer &lt; Jeu &lt; Ven &lt; Sam</code></pre>
<p>Il arrive que l’on préfère obtenir ces noms dans une autre langue (lorsque l’on doit réaliser des graphiques en anglais, par exemple). Deux options simples peuvent être mises en place : la traduction “à la main”, en créant un tableau de correspondande entre la langue par défaut de la session R et celle désirée. La seconde solution est plus pratique. Elle consiste à faire appel à l’argument <code>locale</code> des fonctions de {<code>lubridate</code>}. Il suffit de fournir à cet argument le nom du local à utiliser. Le seul hic, est que ce nom est dépendant du système… Il faut donc le prendre en compte lors de la rédaction de codes, pour que le script puisse être lancé sur un système Unix ou Windows.</p>
<p>Sous Unix, on peut afficher l’ensemble des noms disponibles avec la commande système suivante (évaluée directement depuis la console R) :</p>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="données.html#cb513-1" aria-hidden="true"></a><span class="kw">system</span>(<span class="st">&quot;locale -a&quot;</span>, <span class="dt">intern =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>Pour Windows, il faut consulter la liste des noms est disponible sur la documentation en ligne de Microsoft : il faut chercher dans un moteur de recherche l’expression : <code>"MSDN Language Strings"</code>[^comme indiqué sur <a href="https://stackoverflow.com/a/26604195">cette réponse</a> sur StakOverflow.].</p>
<p>Ainsi, pour obtenir l’affichage du nom du jour de la semaine en anglais, on écrira :</p>
<ul>
<li>Sous Unix :</li>
</ul>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="données.html#cb514-1" aria-hidden="true"></a><span class="kw">wday</span>(<span class="kw">ymd</span>(<span class="st">&quot;2020-03-17&quot;</span>), <span class="dt">label =</span> <span class="ot">TRUE</span>, <span class="dt">abbr =</span> <span class="ot">FALSE</span>,</span>
<span id="cb514-2"><a href="données.html#cb514-2" aria-hidden="true"></a>     <span class="dt">locale =</span> <span class="st">&quot;en_US&quot;</span>)</span></code></pre></div>
<ul>
<li>Sous Windows:</li>
</ul>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="données.html#cb515-1" aria-hidden="true"></a><span class="kw">wday</span>(<span class="kw">ymd</span>(<span class="st">&quot;2020-03-17&quot;</span>), <span class="dt">label =</span> <span class="ot">TRUE</span>, <span class="dt">abbr =</span> <span class="ot">FALSE</span>,</span>
<span id="cb515-2"><a href="données.html#cb515-2" aria-hidden="true"></a>     <span class="dt">locale =</span> <span class="st">&quot;english_us&quot;</span>)</span></code></pre></div>
<p>Si on désire que le script soit exportable sur différents systèmes d’exploitation, on peut prévoir, à l’aide d’une instruction conditionnelle (ces aspects seront abordés dans un autre chapitre), les deux cas de figure : Unix ou Windows. En effet, l’expression <code>.Platform$OS.type</code> permet d’afficher le type de système d’exploitation :</p>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="données.html#cb516-1" aria-hidden="true"></a>.Platform<span class="op">$</span>OS.type</span></code></pre></div>
<pre><code>## [1] &quot;unix&quot;</code></pre>
<p>Aussi, pour que le code soit exportable, on peut écrire :</p>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="données.html#cb518-1" aria-hidden="true"></a><span class="cf">if</span>(.Platform<span class="op">$</span>OS.type <span class="op">==</span><span class="st"> &quot;unix&quot;</span>){</span>
<span id="cb518-2"><a href="données.html#cb518-2" aria-hidden="true"></a>  <span class="kw">wday</span>(<span class="kw">ymd</span>(<span class="st">&quot;2020-03-17&quot;</span>), <span class="dt">label =</span> <span class="ot">TRUE</span>, <span class="dt">abbr =</span> <span class="ot">FALSE</span>,</span>
<span id="cb518-3"><a href="données.html#cb518-3" aria-hidden="true"></a>     <span class="dt">locale =</span> <span class="st">&quot;en_US&quot;</span>)</span>
<span id="cb518-4"><a href="données.html#cb518-4" aria-hidden="true"></a>}<span class="cf">else</span>{</span>
<span id="cb518-5"><a href="données.html#cb518-5" aria-hidden="true"></a>  <span class="kw">wday</span>(<span class="kw">ymd</span>(<span class="st">&quot;2020-03-17&quot;</span>), <span class="dt">label =</span> <span class="ot">TRUE</span>, <span class="dt">abbr =</span> <span class="ot">FALSE</span>,</span>
<span id="cb518-6"><a href="données.html#cb518-6" aria-hidden="true"></a>     <span class="dt">locale =</span> <span class="st">&quot;english_us&quot;</span>)</span>
<span id="cb518-7"><a href="données.html#cb518-7" aria-hidden="true"></a>}</span></code></pre></div>
<p>Lorsque les formats de dates ne respectent pas les standards habituels (c’est le cas par exemple avec des dates que l’on peut obtenir <em>via</em> l’API de Twitter), les fonctions du type <code>ymd_hms()</code> ne parviendront pas à reconnaître le format. Le <em>package</em> {<code>lubridate</code>} dispose d’une fonction qui permettra de définir soi-même le format de la date : <code>parse_date_time()</code></p>
<p>Admettons que nous ayons une date sous forme de chaîne de caractères écrite de la sorte :</p>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="données.html#cb519-1" aria-hidden="true"></a>x &lt;-<span class="st"> &quot;Fri Dec 25 20:12:00 +0001 2020&quot;</span></span></code></pre></div>
<p>Il faut indiquer à l’argument <code>orders</code> l’ordre dans lequel les différents éléments composant la date apparaissent. La Section (dates-POSIXct) recense tous les éléments de dates dans un tableau. Ces éléments sont utiles ici. On comprend que la date contient le jour de la semaine abrégé (<code>%a</code>), le mois abrégé (<code>%b</code>), puis le numéro du jour dans le mois (<code>%d</code>) etc. De plus, les abréviations correspondent au local anglais, il faut dont indquer à l’argument <code>locale</code> que la date est rédigée en anglais.</p>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="données.html#cb520-1" aria-hidden="true"></a><span class="kw">parse_date_time</span>(x, <span class="dt">orders =</span> <span class="st">&quot;%a %b %d %H:%M:%S %z %Y&quot;</span>, <span class="dt">locale =</span> <span class="st">&quot;en_US&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2020-12-25 20:11:24 UTC&quot;</code></pre>
</div>
<div id="opérations" class="section level4" number="2.4.4.2">
<h4><span class="header-section-number">2.4.4.2</span> Opérations</h4>
<p>Avant de présenter quelques exemples, créons quelques variables de dates. Rappelons-nous qu’avec les fonctions ne prenant pas en compte l’heure, la minute et la seconde, les objets créés avec les fonctions du <em>package</em> {<code>lubridate</code>} sont de classe <code>Date</code>. Si ces éléments sont pris en compte, les objets sont de type <code>POSIXct</code>.</p>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="données.html#cb522-1" aria-hidden="true"></a><span class="co"># Quelques dates</span></span>
<span id="cb522-2"><a href="données.html#cb522-2" aria-hidden="true"></a>d_date_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">ymd</span>(<span class="st">&quot;2019-09-01&quot;</span>)</span>
<span id="cb522-3"><a href="données.html#cb522-3" aria-hidden="true"></a>d_date_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">ymd</span>(<span class="st">&quot;2020-10-21&quot;</span>)</span>
<span id="cb522-4"><a href="données.html#cb522-4" aria-hidden="true"></a><span class="kw">class</span>(d_date_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Date&quot;</code></pre>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="données.html#cb524-1" aria-hidden="true"></a>d_posix_ct_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">ymd_hms</span>(<span class="st">&quot;2020-03-17 12:32:28&quot;</span>)</span>
<span id="cb524-2"><a href="données.html#cb524-2" aria-hidden="true"></a>d_posix_ct_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">ymd_hms</span>(<span class="st">&quot;2020-05-11 13:55:44&quot;</span>)</span>
<span id="cb524-3"><a href="données.html#cb524-3" aria-hidden="true"></a><span class="kw">class</span>(d_posix_ct_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] &quot;POSIXct&quot; &quot;POSIXt&quot;</code></pre>
<p>Pour ajouter ou retirer des durées de temps, il faut se rappeler comment sont stockées les dates. Avec les objets de mode <code>Date</code>, il s’agit d’un nombre de jours. Aussi, additioner un nombre <span class="math inline">\(n\)</span> à un objet de type <code>date</code> retourne la date <span class="math inline">\(n\)</span> jours plus tard. Pour les objets de classe <code>POSIXct</code> ou <code>POSIXlt</code>, comme R stock la date en secondes, l’ajout d’un nombre <span class="math inline">\(n\)</span> retourne la date augmentée de <span class="math inline">\(n\)</span> secondes.</p>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="données.html#cb526-1" aria-hidden="true"></a>d_date_<span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] &quot;2020-10-21&quot;</code></pre>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="données.html#cb528-1" aria-hidden="true"></a>d_date_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">10</span></span></code></pre></div>
<pre><code>## [1] &quot;2020-10-31&quot;</code></pre>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="données.html#cb530-1" aria-hidden="true"></a>d_date_<span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">10</span></span></code></pre></div>
<pre><code>## [1] &quot;2020-10-11&quot;</code></pre>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="données.html#cb532-1" aria-hidden="true"></a>d_posix_ct_<span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] &quot;2020-05-11 13:55:44 UTC&quot;</code></pre>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="données.html#cb534-1" aria-hidden="true"></a>d_posix_ct_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">10</span></span></code></pre></div>
<pre><code>## [1] &quot;2020-05-11 13:55:54 UTC&quot;</code></pre>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="données.html#cb536-1" aria-hidden="true"></a>d_posix_ct_<span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">10</span></span></code></pre></div>
<pre><code>## [1] &quot;2020-05-11 13:55:34 UTC&quot;</code></pre>
<p>Toujours dû à ce stockage interne en jours ou secondes, il est possible de comparer facilement deux dates entre-elles, avec les opérateurs classiques.</p>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="données.html#cb538-1" aria-hidden="true"></a>d_date_<span class="dv">1</span> <span class="op">&gt;</span><span class="st"> </span>d_date_<span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="données.html#cb540-1" aria-hidden="true"></a>d_posix_ct_<span class="dv">2</span> <span class="op">&gt;</span><span class="st"> </span>d_posix_ct_<span class="dv">1</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="données.html#cb542-1" aria-hidden="true"></a>d_posix_ct_<span class="dv">2</span> <span class="op">==</span><span class="st"> </span>d_posix_ct_<span class="dv">1</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
</div>
<div id="intervalles-de-dates" class="section level4" number="2.4.4.3">
<h4><span class="header-section-number">2.4.4.3</span> Intervalles de dates</h4>
<p>La fonction <code>interval()</code> du <em>package</em> <code>lubridate</code> crée un intervalle de temps entre deux dates. On peut également utiliser l’opérateur <code>%--%</code>.</p>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="données.html#cb544-1" aria-hidden="true"></a>debut &lt;-<span class="st"> </span><span class="kw">ymd_hms</span>(<span class="st">&quot;2020-03-17 07:00:00&quot;</span>, <span class="dt">tz =</span> <span class="st">&quot;Australia/Perth&quot;</span>)</span>
<span id="cb544-2"><a href="données.html#cb544-2" aria-hidden="true"></a>fin &lt;-<span class="st"> </span><span class="kw">ymd_hms</span>(<span class="st">&quot;2020-05-11 23:00:00&quot;</span>, <span class="dt">tz =</span> <span class="st">&quot;Australia/Perth&quot;</span>)</span>
<span id="cb544-3"><a href="données.html#cb544-3" aria-hidden="true"></a></span>
<span id="cb544-4"><a href="données.html#cb544-4" aria-hidden="true"></a>(intervalle_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">interval</span>(debut, fin))</span></code></pre></div>
<pre><code>## [1] 2020-03-17 07:00:00 AWST--2020-05-11 23:00:00 AWST</code></pre>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="données.html#cb546-1" aria-hidden="true"></a>debut <span class="op">%--%</span><span class="st"> </span>fin</span></code></pre></div>
<pre><code>## [1] 2020-03-17 07:00:00 AWST--2020-05-11 23:00:00 AWST</code></pre>
<p>La durée d’un intervalle s’obtient avec la fonction <code>int_length()</code>. Le résultat est exprimé en secondes.</p>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="données.html#cb548-1" aria-hidden="true"></a><span class="kw">int_length</span>(intervalle_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 4809600</code></pre>
<p>Pour exprimer cette différence de dates dans un format plus compréhensible pour un humain, {<code>lubridate</code>} propose deux approches : les durées (<em>durations</em>) et les époques (<em>periods</em>). La différence entre les deux est que les <em>durations</em> ne tiennent pas en compte des fluctuations de la ligne du temps, comme les années bissextiles, tandis que les <em>periods</em> le font.</p>
<p>Les fonctions qui crééent les durées possèdent le nom au pluriel de ces durées précédé du préfixe <code>d</code> ; les fonctions qui créent les époques laissent quant à elle tomber le préxixe.</p>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="données.html#cb550-1" aria-hidden="true"></a><span class="kw">minutes</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1] &quot;10M 0S&quot;</code></pre>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="données.html#cb552-1" aria-hidden="true"></a><span class="kw">dminutes</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1] &quot;600s (~10 minutes)&quot;</code></pre>
<p>Pour illustrer la différence entre les <em>durations</em> et les <em>periods</em>, regardons un exemple avec la fonction <code>leap_year()</code> qui retourne un logique indiquant si l’année passée en argument est bissextile.</p>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="données.html#cb554-1" aria-hidden="true"></a><span class="kw">leap_year</span>(<span class="dv">2000</span>) <span class="co"># 2000 était une année bissextile</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="données.html#cb556-1" aria-hidden="true"></a><span class="co"># Ajout d&#39;une durée d&#39;un an, soit 365 jours</span></span>
<span id="cb556-2"><a href="données.html#cb556-2" aria-hidden="true"></a><span class="kw">ymd</span>(<span class="st">&quot;2000-01-01&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">dyears</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2000-12-31 06:00:00 UTC&quot;</code></pre>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="données.html#cb558-1" aria-hidden="true"></a><span class="co"># Ajout d&#39;une période d&#39;un an, soit 366 jours dans ce cas</span></span>
<span id="cb558-2"><a href="données.html#cb558-2" aria-hidden="true"></a><span class="kw">ymd</span>(<span class="st">&quot;2000-01-01&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">years</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2001-01-01&quot;</code></pre>
<p>Après ce détour, nous pouvons revenir à ce qui nous intéresse à l’origine : obtenir la durée d’un intervalle entre deux dates exprimée dans un format plus compréhensible pour un humain. On peut obtenir la durée d’un intervalle exprimée en jours, en mois, en semaines, etc. en le divisant par une durée.</p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="données.html#cb560-1" aria-hidden="true"></a>intervalle &lt;-<span class="st"> </span><span class="kw">interval</span>(<span class="kw">ymd_hms</span>(<span class="st">&quot;2020-03-17 10:00:00&quot;</span>),</span>
<span id="cb560-2"><a href="données.html#cb560-2" aria-hidden="true"></a>                           <span class="kw">ymd_hms</span>(<span class="st">&quot;2020-05-11 08:00:00&quot;</span>))</span>
<span id="cb560-3"><a href="données.html#cb560-3" aria-hidden="true"></a><span class="co"># Nombre de jours de confinement durant la pandémie de Covid-19</span></span>
<span id="cb560-4"><a href="données.html#cb560-4" aria-hidden="true"></a>intervalle <span class="op">/</span><span class="st"> </span><span class="kw">ddays</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 54.91667</code></pre>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="données.html#cb562-1" aria-hidden="true"></a><span class="co"># Nombre de durées de 2 jours</span></span>
<span id="cb562-2"><a href="données.html#cb562-2" aria-hidden="true"></a>intervalle <span class="op">/</span><span class="st"> </span><span class="kw">ddays</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 27.45833</code></pre>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="données.html#cb564-1" aria-hidden="true"></a><span class="co"># Nombre d&#39;heures</span></span>
<span id="cb564-2"><a href="données.html#cb564-2" aria-hidden="true"></a>intervalle <span class="op">/</span><span class="st"> </span><span class="kw">dhours</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 1318</code></pre>
<p>L’ensemble des <em>durations</em> est donné dans le tableau ci-dessous.</p>
<table>
<thead>
<tr class="header">
<th align="left">Fonction</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"></td>
<td align="left">dseconds()</td>
</tr>
<tr class="even">
<td align="left">dminutes()</td>
<td align="left">Minutes</td>
</tr>
<tr class="odd">
<td align="left">dhours()</td>
<td align="left">Heures</td>
</tr>
<tr class="even">
<td align="left">ddays()</td>
<td align="left">Jours</td>
</tr>
<tr class="odd">
<td align="left">dweeks()</td>
<td align="left">Semaines</td>
</tr>
<tr class="even">
<td align="left">dmonths()</td>
<td align="left">Mois</td>
</tr>
<tr class="odd">
<td align="left">dyears()</td>
<td align="left">Années</td>
</tr>
<tr class="even">
<td align="left">dmilliseconds()</td>
<td align="left">Milisecondes</td>
</tr>
<tr class="odd">
<td align="left">dmicroseconds()</td>
<td align="left">Microsecondes</td>
</tr>
<tr class="even">
<td align="left">dnanoseconds()</td>
<td align="left">Nanosecondes</td>
</tr>
<tr class="odd">
<td align="left">dpicoseconds()</td>
<td align="left">Picosecondes</td>
</tr>
</tbody>
</table>
<p>On peut chercher si deux intervalles se chevauchent, avec la fonction <code>int_overlaps()</code>.</p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="données.html#cb566-1" aria-hidden="true"></a>debut_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">ymd_hms</span>(<span class="st">&quot;2020-03-01 08:00:00&quot;</span>, <span class="dt">tz =</span> <span class="st">&quot;Australia/Perth&quot;</span>)</span>
<span id="cb566-2"><a href="données.html#cb566-2" aria-hidden="true"></a>fin_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">ymd_hms</span>(<span class="st">&quot;2020-10-01 10:00:00&quot;</span>, <span class="dt">tz =</span> <span class="st">&quot;Australia/Perth&quot;</span>)</span>
<span id="cb566-3"><a href="données.html#cb566-3" aria-hidden="true"></a></span>
<span id="cb566-4"><a href="données.html#cb566-4" aria-hidden="true"></a>debut_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">ymd_hms</span>(<span class="st">&quot;2020-10-02 09:00:00&quot;</span>, <span class="dt">tz =</span> <span class="st">&quot;Australia/Perth&quot;</span>)</span>
<span id="cb566-5"><a href="données.html#cb566-5" aria-hidden="true"></a>fin_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">ymd_hms</span>(<span class="st">&quot;2020-10-02 10:00:00&quot;</span>, <span class="dt">tz =</span> <span class="st">&quot;Australia/Perth&quot;</span>)</span>
<span id="cb566-6"><a href="données.html#cb566-6" aria-hidden="true"></a></span>
<span id="cb566-7"><a href="données.html#cb566-7" aria-hidden="true"></a>intervalle_<span class="dv">1</span></span></code></pre></div>
<pre><code>## [1] 2020-03-17 07:00:00 AWST--2020-05-11 23:00:00 AWST</code></pre>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="données.html#cb568-1" aria-hidden="true"></a>(intervalle_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">interval</span>(debut_<span class="dv">2</span>, fin_<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 2020-03-01 08:00:00 AWST--2020-10-01 10:00:00 AWST</code></pre>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="données.html#cb570-1" aria-hidden="true"></a>(intervalle_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">interval</span>(debut_<span class="dv">3</span>, fin_<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## [1] 2020-10-02 09:00:00 AWST--2020-10-02 10:00:00 AWST</code></pre>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="données.html#cb572-1" aria-hidden="true"></a><span class="kw">int_overlaps</span>(intervalle_<span class="dv">1</span>, intervalle_<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="données.html#cb574-1" aria-hidden="true"></a><span class="kw">int_overlaps</span>(intervalle_<span class="dv">1</span>, intervalle_<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>On peut utiliser les fonctions ensemblistes sur des intervalles (<code>union()</code> (union), <code>intersect()</code> (intersection), <code>setdiff()</code> (différence), <code>setequal()</code> (égalité) et <code>%within%</code> (tester si une date est dans un intervalle)).</p>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="données.html#cb576-1" aria-hidden="true"></a>lubridate<span class="op">::</span><span class="kw">union</span>(intervalle_<span class="dv">1</span>, intervalle_<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 2020-03-01 08:00:00 AWST--2020-10-01 10:00:00 AWST</code></pre>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="données.html#cb578-1" aria-hidden="true"></a>lubridate<span class="op">::</span><span class="kw">intersect</span>(intervalle_<span class="dv">1</span>, intervalle_<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] NA--NA</code></pre>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb580-1"><a href="données.html#cb580-1" aria-hidden="true"></a>lubridate<span class="op">::</span><span class="kw">setdiff</span>(intervalle_<span class="dv">1</span>, intervalle_<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 2020-03-17 07:00:00 AWST--2020-05-11 23:00:00 AWST</code></pre>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="données.html#cb582-1" aria-hidden="true"></a>base<span class="op">::</span><span class="kw">setequal</span>(intervalle_<span class="dv">1</span>, intervalle_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="données.html#cb584-1" aria-hidden="true"></a>debut_<span class="dv">2</span> <span class="op">%within%</span><span class="st"> </span>intervalle_<span class="dv">1</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>Après avoir utilisé ces fonctions ensemblistes, on peut être amené à vouloir extraire les bornes de l’intervalle. Il faut alors utiliser les fonctions <code>int_start()</code> et <code>int_end()</code> pour les bornes inférieures et supérieures respectivement.</p>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb586-1"><a href="données.html#cb586-1" aria-hidden="true"></a>(intervalle &lt;-<span class="st"> </span>lubridate<span class="op">::</span><span class="kw">setdiff</span>(intervalle_<span class="dv">1</span>, intervalle_<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 2020-03-17 07:00:00 AWST--2020-05-11 23:00:00 AWST</code></pre>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="données.html#cb588-1" aria-hidden="true"></a><span class="kw">int_start</span>(intervalle)</span></code></pre></div>
<pre><code>## [1] &quot;2020-03-17 07:00:00 AWST&quot;</code></pre>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="données.html#cb590-1" aria-hidden="true"></a><span class="kw">int_end</span>(intervalle)</span></code></pre></div>
<pre><code>## [1] &quot;2020-05-11 23:00:00 AWST&quot;</code></pre>
<p>La fonction <code>int_flip()</code> échange les bornes de l’intervalle. Le nouvel intervalle possède la même longueur, mais une direction opposée.</p>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="données.html#cb592-1" aria-hidden="true"></a><span class="kw">int_flip</span>(intervalle_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 2020-05-11 23:00:00 AWST--2020-03-17 07:00:00 AWST</code></pre>
<p>La fonction <code>int_shift()</code> décale le début et la fin de l’intervalle, en fonction de la valeur fournie à l’argument <code>by</code>, qui doit être un objet de durée, que l’on peut obtenir avec la fonction <code>duration()</code>.</p>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="données.html#cb594-1" aria-hidden="true"></a><span class="kw">int_shift</span>(intervalle_<span class="dv">1</span>, <span class="kw">duration</span>(<span class="dt">days =</span> <span class="dv">5</span>))</span></code></pre></div>
<pre><code>## [1] 2020-03-22 07:00:00 AWST--2020-05-16 23:00:00 AWST</code></pre>
<p>La fonction <code>int_aligns()</code> permet de tester si deux intervalles ont une borne commune, sans prendre en compte la direction de chaque intervalle. Ainsi, la fonction teste si les moments les plus anciens ou plus récents de chaque intervallent arrivent au même moment.</p>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="données.html#cb596-1" aria-hidden="true"></a>int_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">interval</span>(<span class="kw">ymd</span>(<span class="st">&quot;2019-10-01&quot;</span>), <span class="kw">ymd</span>(<span class="st">&quot;2019-10-05&quot;</span>))</span>
<span id="cb596-2"><a href="données.html#cb596-2" aria-hidden="true"></a>int_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">interval</span>(<span class="kw">ymd</span>(<span class="st">&quot;2019-10-04&quot;</span>), <span class="kw">ymd</span>(<span class="st">&quot;2019-10-01&quot;</span>))</span>
<span id="cb596-3"><a href="données.html#cb596-3" aria-hidden="true"></a>int_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">interval</span>(<span class="kw">ymd</span>(<span class="st">&quot;2020-10-01&quot;</span>), <span class="kw">ymd</span>(<span class="st">&quot;2020-10-05&quot;</span>))</span>
<span id="cb596-4"><a href="données.html#cb596-4" aria-hidden="true"></a></span>
<span id="cb596-5"><a href="données.html#cb596-5" aria-hidden="true"></a><span class="kw">int_aligns</span>(int_<span class="dv">1</span>, int_<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="données.html#cb598-1" aria-hidden="true"></a><span class="kw">int_aligns</span>(int_<span class="dv">1</span>, int_<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
</div>
<div id="séquence-de-dates" class="section level4" number="2.4.4.4">
<h4><span class="header-section-number">2.4.4.4</span> Séquence de dates</h4>
<p>Il est possible d’utiliser la fonction <code>seq()</code> avec des dates, qu’elles soient stockées au format <code>date</code>, <code>POSIXct</code> ou <code>POSIXlt</code>. Le lecteur ou la lectrice s’asurera de bien comprendre les exemples suivants.</p>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb600-1"><a href="données.html#cb600-1" aria-hidden="true"></a><span class="co"># Avec des objets de class date</span></span>
<span id="cb600-2"><a href="données.html#cb600-2" aria-hidden="true"></a><span class="kw">seq</span>(<span class="kw">ymd</span>(<span class="st">&quot;2020-09-01&quot;</span>), <span class="dt">length =</span> <span class="dv">4</span>, <span class="dt">by =</span> <span class="st">&quot;day&quot;</span>) </span></code></pre></div>
<pre><code>## [1] &quot;2020-09-01&quot; &quot;2020-09-02&quot; &quot;2020-09-03&quot; &quot;2020-09-04&quot;</code></pre>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb602-1"><a href="données.html#cb602-1" aria-hidden="true"></a><span class="co"># Tous les deux jours</span></span>
<span id="cb602-2"><a href="données.html#cb602-2" aria-hidden="true"></a><span class="kw">seq</span>(<span class="kw">ymd</span>(<span class="st">&quot;2020-09-01&quot;</span>), <span class="dt">length =</span> <span class="dv">4</span>, <span class="dt">by =</span> <span class="st">&quot;2 days&quot;</span>) </span></code></pre></div>
<pre><code>## [1] &quot;2020-09-01&quot; &quot;2020-09-03&quot; &quot;2020-09-05&quot; &quot;2020-09-07&quot;</code></pre>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="données.html#cb604-1" aria-hidden="true"></a><span class="co"># En spécifiant le début et la date maximum</span></span>
<span id="cb604-2"><a href="données.html#cb604-2" aria-hidden="true"></a><span class="kw">seq</span>(<span class="kw">ymd</span>(<span class="st">&quot;2020-09-01&quot;</span>), <span class="kw">ymd</span>(<span class="st">&quot;2020-09-08&quot;</span>) , <span class="dt">by =</span> <span class="st">&quot;2 days&quot;</span>) </span></code></pre></div>
<pre><code>## [1] &quot;2020-09-01&quot; &quot;2020-09-03&quot; &quot;2020-09-05&quot; &quot;2020-09-07&quot;</code></pre>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="données.html#cb606-1" aria-hidden="true"></a><span class="co"># Avec des objets de classe POSIXct</span></span>
<span id="cb606-2"><a href="données.html#cb606-2" aria-hidden="true"></a><span class="kw">seq</span>(<span class="kw">ymd_hms</span>(<span class="st">&quot;2020-03-17 12:32:28 &quot;</span>), <span class="dt">by =</span> <span class="st">&quot;9 months&quot;</span>, <span class="dt">length =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2020-03-17 12:32:28 UTC&quot; &quot;2020-12-17 12:32:28 UTC&quot;</code></pre>
</div>
<div id="fuseaux-horaires" class="section level4" number="2.4.4.5">
<h4><span class="header-section-number">2.4.4.5</span> Fuseaux horaires</h4>
<p>Il peut être utile de faire des conversions d’heures, pour obtenir la valeur dans un autre fuseau horaire. La fonction <code>with_tz()</code> le permet.</p>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="données.html#cb608-1" aria-hidden="true"></a><span class="co"># Une heure à Paris</span></span>
<span id="cb608-2"><a href="données.html#cb608-2" aria-hidden="true"></a>(d &lt;-<span class="st"> </span><span class="kw">ymd_hms</span>(<span class="st">&quot;2020-10-30 20:00:00&quot;</span>, <span class="dt">tz =</span> <span class="st">&quot;Europe/Paris&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;2020-10-30 20:00:00 CET&quot;</code></pre>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="données.html#cb610-1" aria-hidden="true"></a><span class="co"># L&#39;heure équivalente à New York City</span></span>
<span id="cb610-2"><a href="données.html#cb610-2" aria-hidden="true"></a><span class="kw">with_tz</span>(d, <span class="st">&quot;America/New_York&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2020-10-30 15:00:00 EDT&quot;</code></pre>
<p>La fonction <code>force_tz()</code> permet de remplacer le fuseau horaire d’une date.</p>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb612-1"><a href="données.html#cb612-1" aria-hidden="true"></a>(d &lt;-<span class="st"> </span><span class="kw">ymd_hms</span>(<span class="st">&quot;2020-10-30 20:00:00&quot;</span>, <span class="dt">tz =</span> <span class="st">&quot;Europe/Paris&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;2020-10-30 20:00:00 CET&quot;</code></pre>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb614-1"><a href="données.html#cb614-1" aria-hidden="true"></a><span class="kw">force_tz</span>(d, <span class="st">&quot;America/New_York&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2020-10-30 20:00:00 EDT&quot;</code></pre>
</div>
</div>
<div id="calculs-matriciels" class="section level3" number="2.4.5">
<h3><span class="header-section-number">2.4.5</span> Calculs matriciels</h3>
<p>Cette section aborde les opérations effectuées sur des matrices.</p>
<div id="addition-soustraction" class="section level4" number="2.4.5.1">
<h4><span class="header-section-number">2.4.5.1</span> Addition, soustraction</h4>
<p>L’addition et la soustraction de deux matrices <span class="math inline">\(A\)</span> et <span class="math inline">\(B\)</span> de même type ou d’une matrice et d’un scalaire <span class="math inline">\(a\)</span> se font avec les opérateurs <code>+</code> et <code>-</code> respectivement.</p>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb616-1"><a href="données.html#cb616-1" aria-hidden="true"></a>(A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">ncol =</span> <span class="dv">3</span>))</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]    3    2    1
## [3,]    2    1    3</code></pre>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb618-1"><a href="données.html#cb618-1" aria-hidden="true"></a>(B &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">5</span>), <span class="dt">ncol =</span> <span class="dv">3</span>))</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    4    5    6
## [2,]    6    5    4
## [3,]    4    6    5</code></pre>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb620-1"><a href="données.html#cb620-1" aria-hidden="true"></a>(C &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">1</span>), <span class="dt">ncol =</span> <span class="dv">1</span>))</span></code></pre></div>
<pre><code>##      [,1]
## [1,]    0
## [2,]    3
## [3,]    1</code></pre>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb622-1"><a href="données.html#cb622-1" aria-hidden="true"></a>a &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb622-2"><a href="données.html#cb622-2" aria-hidden="true"></a>A<span class="op">+</span>a</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    3    4    5
## [2,]    5    4    3
## [3,]    4    3    5</code></pre>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb624-1"><a href="données.html#cb624-1" aria-hidden="true"></a>A<span class="op">+</span>B</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    5    7    9
## [2,]    9    7    5
## [3,]    6    7    8</code></pre>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb626-1"><a href="données.html#cb626-1" aria-hidden="true"></a>A<span class="op">-</span>a</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]   -1    0    1
## [2,]    1    0   -1
## [3,]    0   -1    1</code></pre>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb628-1"><a href="données.html#cb628-1" aria-hidden="true"></a>A<span class="op">-</span>B</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]   -3   -3   -3
## [2,]   -3   -3   -3
## [3,]   -2   -5   -2</code></pre>
</div>
<div id="multiplication-division" class="section level4" number="2.4.5.2">
<h4><span class="header-section-number">2.4.5.2</span> Multiplication, division</h4>
<p>La multiplication et la division par un scalaire (<span class="math inline">\(aA\)</span> et <span class="math inline">\(A/a\)</span>) se font en utilisant les opérateurs <code>*</code> et <code>/</code>respectivement.</p>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb630-1"><a href="données.html#cb630-1" aria-hidden="true"></a>a<span class="op">*</span>A</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    2    4    6
## [2,]    6    4    2
## [3,]    4    2    6</code></pre>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb632-1"><a href="données.html#cb632-1" aria-hidden="true"></a>A<span class="op">/</span>a</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]  0.5  1.0  1.5
## [2,]  1.5  1.0  0.5
## [3,]  1.0  0.5  1.5</code></pre>
<p>La transposée d’une matrice (<span class="math inline">\(A^\top\)</span>) s’obtient grâce à la fonction <code>t()</code>.</p>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="données.html#cb634-1" aria-hidden="true"></a><span class="kw">t</span>(A)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    3    2
## [2,]    2    2    1
## [3,]    3    1    3</code></pre>
<p>La conjuguée d’une matrice (<span class="math inline">\(\overline{A}\)</span>) s’obtient avec <code>Conj()</code>.</p>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="données.html#cb636-1" aria-hidden="true"></a><span class="kw">Conj</span>(A)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]    3    2    1
## [3,]    2    1    3</code></pre>
<p>Pour multiplier deux matrices (<span class="math inline">\(AB\)</span>), l’opérateur en R est <code>%*%</code>.</p>
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb638-1"><a href="données.html#cb638-1" aria-hidden="true"></a>A<span class="op">%*%</span>C</span></code></pre></div>
<pre><code>##      [,1]
## [1,]    9
## [2,]    7
## [3,]    6</code></pre>
<p>Il ne faut pas confondre avec l’opérateur <code>*</code>, qui, lorsqu’il est employé entre deux matrices, effectue la multiplication terme à terme.</p>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb640-1"><a href="données.html#cb640-1" aria-hidden="true"></a>A<span class="op">*</span>B</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    4   10   18
## [2,]   18   10    4
## [3,]    8    6   15</code></pre>
<p>L’inversion d’une matrice (<span class="math inline">\(A^{-1}\)</span>) s’effectue avec la fonction <code>solve()</code>.</p>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="données.html#cb642-1" aria-hidden="true"></a><span class="kw">solve</span>(A)</span></code></pre></div>
<pre><code>##             [,1]  [,2]       [,3]
## [1,] -0.41666667  0.25  0.3333333
## [2,]  0.58333333  0.25 -0.6666667
## [3,]  0.08333333 -0.25  0.3333333</code></pre>
<p>Ce qui permet d’effectuer une division matricielle (<span class="math inline">\(BA^{1}\)</span>).</p>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="données.html#cb644-1" aria-hidden="true"></a>B <span class="op">%/%</span><span class="st"> </span><span class="kw">solve</span>(A)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]  -10   19   18
## [2,]   10   20   -7
## [3,]   48  -25   15</code></pre>
<p>La fonction <code>crossprod()</code> effectue le produit avec transposition (<span class="math inline">\(A^\top B\)</span>).</p>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb646-1"><a href="données.html#cb646-1" aria-hidden="true"></a><span class="kw">crossprod</span>(A,B)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]   30   32   28
## [2,]   24   26   25
## [3,]   30   38   37</code></pre>
<p>Elle réalise l’opération plus rapidement que l’instruction suivante :</p>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb648-1"><a href="données.html#cb648-1" aria-hidden="true"></a><span class="kw">t</span>(A) <span class="op">%*%</span><span class="st"> </span>B</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]   30   32   28
## [2,]   24   26   25
## [3,]   30   38   37</code></pre>
</div>
<div id="déterminant-trace" class="section level4" number="2.4.5.3">
<h4><span class="header-section-number">2.4.5.3</span> Déterminant, trace</h4>
<p>Le calcul du déterminant d’une matrice (<span class="math inline">\(\textrm{det}(A)\)</span>) s’obtient avec la fonction <code>det()</code>.</p>
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb650-1"><a href="données.html#cb650-1" aria-hidden="true"></a><span class="kw">det</span>(A)</span></code></pre></div>
<pre><code>## [1] -12</code></pre>
<p>En utilisant la fonction <code>diag()</code>, qui donne les éléments de la diagonale de la matrice passée en argument, on peut facilement obtenir la trace de la matrice (<span class="math inline">\(tr(A)\)</span>).</p>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb652-1"><a href="données.html#cb652-1" aria-hidden="true"></a><span class="kw">diag</span>(A)</span></code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb654-1"><a href="données.html#cb654-1" aria-hidden="true"></a><span class="kw">sum</span>(<span class="kw">diag</span>(A))</span></code></pre></div>
<pre><code>## [1] 6</code></pre>
</div>
</div>
<div id="tableaux_de_donnees" class="section level3" number="2.4.6">
<h3><span class="header-section-number">2.4.6</span> Tableaux de données</h3>
<p>Cette partie montre comment manipuler la structure de données la plus fréquemment rencontrée en économétrie : les tableaux de données. Il sera considéré que ces tableaux de données sont sous la forme de <em>tibbles</em> plutôt que <em>data frame</em>. Les manipulations sont principalement effectuées à l’aide de fonctions issues de l’environnement tidyverse, et plus particulièrement du <em>package</em> {<code>dplyr</code>}. Les descriptionsdes fonctions du <em>package</em> {<code>dplyr</code>} sont fortement inspirées de la <a href="https://cran.rstudio.com/web/packages/dplyr/vignettes/introduction.html">vignette du <em>package</em></a>.</p>
<div id="lopérateur-pipe" class="section level4" number="2.4.6.1">
<h4><span class="header-section-number">2.4.6.1</span> L’opérateur Pipe</h4>
<p>Avant de commencer à présenter les manipulations de données, il peut être intéressant d’introduire un opérateur : Pipe (<code>%&gt;%</code>). Cet opérateur provient du <em>package</em> {<code>magrittr</code>}. Avant de présenter cet opérateur en soi, et afin de montrer son utilité, quelques exemples ne l’<em>utilisant pas</em> sont présentés. Les explications sont issues de celles de <span class="citation">Grolemund and Wickham (<a href="#ref-grolemund_2018_r" role="doc-biblioref">2018</a>)</span>.</p>
<p>Admettons qu’il soit nécessaire d’effectuer plusieurs opérations à la suite, sur un tableau de données. Par exemple, considérons un tableau dont chaque ligne contient les ventes mensuelles (en colonnes, une par mois) des bars du Cours Julien à Marseille (en lignes) et que l’on souhaite réaliser les opérations suivantes :</p>
<ol style="list-style-type: decimal">
<li>Calculer la moyenne du chiffre d’affaires (CA) à l’année pour chaque bar ;</li>
<li>Ordonner les observations par valeurs croissante des moyennes ;</li>
<li>Afficher le top 5 des bars avec le plus gros CA.</li>
</ol>
<p>Nous allons présenter trois manières différentes de procéder, puis nous regarderons la solution avec le fameux opérateur pipe dont on tait encore ici l’utilité (quel suspens !).</p>
<p><em>Première méthode</em></p>
<p>La première méthode consiste à *sauvegarder un nouvel objet à chaque étape (inutile de tenter d’évaluer le code qui suit, il ne fonctionnera pas : il s’agit d’un exemple totalement fictif) :</p>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb656-1"><a href="données.html#cb656-1" aria-hidden="true"></a>top_ca_bars_anuel_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">calcul</span>(ca_bars_cours_ju, <span class="dt">type =</span> <span class="st">&quot;moyenne&quot;</span>)</span>
<span id="cb656-2"><a href="données.html#cb656-2" aria-hidden="true"></a>top_ca_bars_anuel_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">ordonner</span>(top_ca_bars_anuel_<span class="dv">2</span>,</span>
<span id="cb656-3"><a href="données.html#cb656-3" aria-hidden="true"></a>                            <span class="dt">type =</span> <span class="st">&quot;decroissantes&quot;</span>, <span class="dt">variable =</span> <span class="st">&quot;ca_annuel&quot;</span>)</span>
<span id="cb656-4"><a href="données.html#cb656-4" aria-hidden="true"></a>top_ca_bars_anuel_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">head</span>(top_ca_bars_anuel_<span class="dv">2</span>, <span class="dv">5</span>)</span></code></pre></div>
<p>Cette manière de faire requière de créer de nombreux objets intermédiaires avant d’arriver au résultat. On peut noter que le nom de ces objets intermédiaires peut ne pas être facile à trouver/comprendre. Toutefois, s’il est possible de trouver des noms sensés, cette méthode peut être adaptée à la situation. On note également que le code devient plus difficile à lire du fait des nombreux noms de variables inintéressantes.</p>

<div class="remarque">
Si le tableau initial contient un volume de données importantes, la création des objets intermédiaire n’occupera pas un espace en mémoire important (R gère cela plutôt bien).
</div>
<p><em>Deuxième méthode</em></p>
<p>La deuxième méthode consiste à écraser l’objet original à chaque étape :</p>
<div class="sourceCode" id="cb657"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb657-1"><a href="données.html#cb657-1" aria-hidden="true"></a>top_ca_bars_anuel_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">calcul</span>(ca_bars_cours_ju, <span class="dt">type =</span> <span class="st">&quot;moyenne&quot;</span>)</span>
<span id="cb657-2"><a href="données.html#cb657-2" aria-hidden="true"></a>top_ca_bars_anuel_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">ordonner</span>(top_ca_bars_anuel_<span class="dv">1</span>,</span>
<span id="cb657-3"><a href="données.html#cb657-3" aria-hidden="true"></a>                            <span class="dt">type =</span> <span class="st">&quot;decroissantes&quot;</span>, <span class="dt">variable =</span> <span class="st">&quot;ca_annuel&quot;</span>)</span>
<span id="cb657-4"><a href="données.html#cb657-4" aria-hidden="true"></a>top_ca_bars_anuel_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">head</span>(top_ca_bars_anuel_<span class="dv">1</span>, <span class="dv">5</span>)</span></code></pre></div>
<p>Si cette solution est moins pénible à rédiger que la précédente, on peut noter qu’elle ne facilite toutefois pas le debogage et que le nom de l’objet modifié a été inscrit 5 fois (et vient donc perturber la lecture rapide du code).</p>
<p><em>Troisième méthode</em></p>
<p>La troisième méthode, absolument hideuse à mes yeux (celle par laquelle j’ai commencé il y a quelques années, <em>mea culpa</em>), consiste à rédiger une composition de fonction :</p>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb658-1"><a href="données.html#cb658-1" aria-hidden="true"></a>top_ca_bars_anuel_<span class="dv">1</span> &lt;-<span class="st"> </span></span>
<span id="cb658-2"><a href="données.html#cb658-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">head</span>(</span>
<span id="cb658-3"><a href="données.html#cb658-3" aria-hidden="true"></a>    <span class="kw">ordonner</span>(</span>
<span id="cb658-4"><a href="données.html#cb658-4" aria-hidden="true"></a>      <span class="kw">calcul</span>(</span>
<span id="cb658-5"><a href="données.html#cb658-5" aria-hidden="true"></a>        ca_bars_cours_ju, <span class="dt">type =</span> <span class="st">&quot;moyenne&quot;</span>),</span>
<span id="cb658-6"><a href="données.html#cb658-6" aria-hidden="true"></a>      <span class="dt">type =</span> <span class="st">&quot;decroissantes&quot;</span>, <span class="dt">variable =</span> <span class="st">&quot;ca_annuel&quot;</span></span>
<span id="cb658-7"><a href="données.html#cb658-7" aria-hidden="true"></a>    ), </span>
<span id="cb658-8"><a href="données.html#cb658-8" aria-hidden="true"></a>    <span class="dv">5</span></span>
<span id="cb658-9"><a href="données.html#cb658-9" aria-hidden="true"></a>  )</span></code></pre></div>
<p>Non seulement le temps de rédaction de ce type de code peut être long, mais la lecture du code produit est de surcroît ardue : il faut lire de l’intérieur vers l’extérieur, ce qui est d’autant plus difficile que les arguments de chaque fonction sont éloignés du nom de la fonction.</p>
<p><em>Roulements de tambour : l’opérateur Pipe</em></p>
<p>L’opérateur permet de réaliser l’opération chaînée de la manière suivante :</p>
<div class="sourceCode" id="cb659"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb659-1"><a href="données.html#cb659-1" aria-hidden="true"></a>top_ca_bars_anuel_<span class="dv">1</span> &lt;-<span class="st"> </span></span>
<span id="cb659-2"><a href="données.html#cb659-2" aria-hidden="true"></a><span class="st">  </span>ca_bars_cours_ju <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb659-3"><a href="données.html#cb659-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">calcul</span>(<span class="dt">type =</span> <span class="st">&quot;moyenne&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb659-4"><a href="données.html#cb659-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">ordonner</span>(<span class="dt">type =</span> <span class="st">&quot;decroissantes&quot;</span>, <span class="dt">variable =</span> <span class="st">&quot;ca_annuel&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb659-5"><a href="données.html#cb659-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">head</span>(<span class="dv">5</span>)</span></code></pre></div>
<p>Le membre à gauche de l’opérateur est donné comme premier argument de la fonction à droite de l’opérateur.</p>
<p>Avec cette solution, la lecture est rapide pour une personne humaine et le débogage est facilité. Attention à veiller à ne pas enchaîner de trop nombreuses opérations qui feraient perdre ces avantages.</p>
<p>Si on souhaite appeler explicitement le membre de gauche, on peut utiliser le point <code>.</code> comme suit :</p>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb660-1"><a href="données.html#cb660-1" aria-hidden="true"></a>top_ca_bars_anuel_<span class="dv">1</span> &lt;-<span class="st"> </span></span>
<span id="cb660-2"><a href="données.html#cb660-2" aria-hidden="true"></a><span class="st">  </span>ca_bars_cours_ju <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb660-3"><a href="données.html#cb660-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">calcul</span>(<span class="dt">donnes =</span> ., <span class="dt">type =</span> <span class="st">&quot;moyenne&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb660-4"><a href="données.html#cb660-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">ordonner</span>(<span class="dt">donnees =</span> ., <span class="dt">type =</span> <span class="st">&quot;decroissantes&quot;</span>, <span class="dt">variable =</span> <span class="st">&quot;ca_annuel&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb660-5"><a href="données.html#cb660-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">head</span>(<span class="dt">x =</span> ., <span class="dv">5</span>)</span></code></pre></div>
<p>Comme cet opérateur fait partie de l’environnement <code>tidyverse</code> et que la majorité des fonctions admettent en premier argument les données, il n’est pas nécessaire de rajouter le point au premier argument de la fonction à droite de l’opérateur.</p>
<p>Il convient de préciser que si la fonction à droite du Pipe n’admet pas pour premier argument les données, il est nécessaire de préciser l’argument de la fonction qui recevra les données, comme suit :</p>
<div class="sourceCode" id="cb661"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb661-1"><a href="données.html#cb661-1" aria-hidden="true"></a>donnees <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">fonction</span>(<span class="dt">premier_argument =</span> <span class="st">&quot;foo&quot;</span>, <span class="dt">donnees =</span> .)</span></code></pre></div>
</div>
<div id="sélection" class="section level4" number="2.4.6.2">
<h4><span class="header-section-number">2.4.6.2</span> Sélection</h4>
<p>Dans la Section <a href="données.html#manip-acces">2.4.2</a>, il a été vu que l’accès aux données d’un <em>tibble</em> peut se faire à l’aide du système d’indexation ou bien par celui de nommage, en utilisant la fonction <code>[()</code>. Le <em>package</em> <code>dplyr</code> propose une autre manière de procéder pour sélectionner des colonnes, ou pour filtrer les données. Ces méthodes ont le mérite d’être faciles à lire. Reprenons le <em>tibble</em> donné en exemple dans la Section <a href="données.html#manip-acces">2.4.2</a>.</p>
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb662-1"><a href="données.html#cb662-1" aria-hidden="true"></a>femmes &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb662-2"><a href="données.html#cb662-2" aria-hidden="true"></a>  <span class="dt">height =</span><span class="kw">c</span>(<span class="dv">58</span>, <span class="dv">59</span>, <span class="dv">60</span>, <span class="dv">61</span>, <span class="dv">62</span>, <span class="dv">63</span>, <span class="dv">64</span>, <span class="dv">65</span>, <span class="dv">66</span>,</span>
<span id="cb662-3"><a href="données.html#cb662-3" aria-hidden="true"></a>            <span class="dv">67</span>, <span class="dv">68</span>,<span class="dv">69</span>, <span class="dv">70</span>, <span class="dv">71</span>, <span class="dv">72</span>),</span>
<span id="cb662-4"><a href="données.html#cb662-4" aria-hidden="true"></a>  <span class="dt">weight =</span><span class="kw">c</span>(<span class="dv">115</span>, <span class="dv">117</span>, <span class="dv">120</span>, <span class="dv">123</span>, <span class="dv">126</span>, <span class="dv">129</span>, <span class="dv">132</span>, <span class="dv">135</span>,</span>
<span id="cb662-5"><a href="données.html#cb662-5" aria-hidden="true"></a>            <span class="dv">139</span>,<span class="dv">142</span>, <span class="dv">146</span>, <span class="dv">150</span>, <span class="dv">154</span>, <span class="dv">159</span>, <span class="dv">164</span>))</span></code></pre></div>
<p>La sélection des colonnes se fait en utilisant la fonction <code>select()</code>. On peut noter que le nom des colonnes ne doit pas être entouré de guillemets. Le premier argument correspond au <em>tibble</em>, le second et les suivants à la ou les colonnes désirées. L’odre d’apparition des colonnes correspond à celui fourni à la fonction <code>select()</code>.</p>
<div class="sourceCode" id="cb663"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb663-1"><a href="données.html#cb663-1" aria-hidden="true"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb663-2"><a href="données.html#cb663-2" aria-hidden="true"></a><span class="kw">select</span>(femmes, height)</span></code></pre></div>
<pre><code>## # A tibble: 15 x 1
##    height
##     &lt;dbl&gt;
##  1     58
##  2     59
##  3     60
##  4     61
##  5     62
##  6     63
##  7     64
##  8     65
##  9     66
## 10     67
## 11     68
## 12     69
## 13     70
## 14     71
## 15     72</code></pre>
<p>Si le nom d’une colonne ne respecte pas les conventions de nommage, il est possible d’y accéder avec <code>select()</code> en entourant le nom de la colonne d’accents graves :</p>
<div class="sourceCode" id="cb665"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb665-1"><a href="données.html#cb665-1" aria-hidden="true"></a>tb_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="st">`</span><span class="dt">Un nom</span><span class="st">`</span> =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="st">`</span><span class="dt">Un autre</span><span class="st">`</span> =<span class="st"> </span>LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>])</span>
<span id="cb665-2"><a href="données.html#cb665-2" aria-hidden="true"></a><span class="kw">select</span>(tb_<span class="dv">2</span>, <span class="st">`</span><span class="dt">Un nom</span><span class="st">`</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 1
##   `Un nom`
##      &lt;int&gt;
## 1        1
## 2        2
## 3        3</code></pre>
<p>Il arrive de vouloir extraire une variable par son nom, ce dernier étant le contenu d’une variable externe (dans une boucle par exemple). La pratique suivante n’est pas recommandée, car ambigüe :</p>
<div class="sourceCode" id="cb667"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb667-1"><a href="données.html#cb667-1" aria-hidden="true"></a>nom_variable &lt;-<span class="st"> &quot;x&quot;</span></span>
<span id="cb667-2"><a href="données.html#cb667-2" aria-hidden="true"></a><span class="kw">select</span>(tb, nom_variable)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 1
##   x        
##   &lt;list&gt;   
## 1 &lt;dbl [1]&gt;
## 2 &lt;dbl [1]&gt;
## 3 &lt;dbl [1]&gt;</code></pre>
<p>On peut aussi noter, à travers l’exemple suivant, que le résultats obtenu n’est pas nécessairement celui attendu (le nom de la colonne et le nom de la variable qui contient la chaîne de caractères sont identiques) :</p>
<div class="sourceCode" id="cb669"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb669-1"><a href="données.html#cb669-1" aria-hidden="true"></a>nom_variable &lt;-<span class="st"> &quot;x&quot;</span></span>
<span id="cb669-2"><a href="données.html#cb669-2" aria-hidden="true"></a>tb_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">nom_variable =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span>
<span id="cb669-3"><a href="données.html#cb669-3" aria-hidden="true"></a><span class="kw">select</span>(tb_<span class="dv">2</span>, nom_variable)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 1
##   nom_variable
##   &lt;chr&gt;       
## 1 A           
## 2 B           
## 3 C</code></pre>
<p>Une solution consiste à faire précéder le nom de la variable qui contient le nom de la (ou les) colonne(s) que l’on souhaite sélectionner :</p>
<div class="sourceCode" id="cb671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb671-1"><a href="données.html#cb671-1" aria-hidden="true"></a><span class="kw">select</span>(tb_<span class="dv">2</span>, <span class="op">!!</span>nom_variable)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 1
##       x
##   &lt;int&gt;
## 1     1
## 2     2
## 3     3</code></pre>
<p>Pour <em>retirer une colonne</em>, il suffit de faire précéder le nom de la colonne par le signe moins :</p>
<div class="sourceCode" id="cb673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb673-1"><a href="données.html#cb673-1" aria-hidden="true"></a>tb &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">4</span>), <span class="dt">y =</span> x<span class="op">^</span><span class="dv">2</span>, <span class="dt">z =</span> LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">t =</span> letters[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])</span>
<span id="cb673-2"><a href="données.html#cb673-2" aria-hidden="true"></a><span class="kw">select</span>(tb, <span class="op">-</span>x)</span></code></pre></div>
<pre><code>## # A tibble: 4 x 3
##       y z     t    
##   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
## 1     1 A     a    
## 2     4 B     b    
## 3     9 C     c    
## 4    16 D     d</code></pre>
<p>Pour <em>retirer plusieurs colonnes</em>, il suffit de placer les noms de colonnes dans un vecteur à l’aide de la fonction c() et de faire précéder l’appel de cette fonction du signe moins :</p>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb675-1"><a href="données.html#cb675-1" aria-hidden="true"></a><span class="kw">select</span>(tb, <span class="op">-</span><span class="kw">c</span>(x, z))</span></code></pre></div>
<pre><code>## # A tibble: 4 x 2
##       y t    
##   &lt;dbl&gt; &lt;chr&gt;
## 1     1 a    
## 2     4 b    
## 3     9 c    
## 4    16 d</code></pre>
<p>ou de manière équivalente, en listant chaque variable à retirer et en les faisant précéder du signe moins :</p>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="données.html#cb677-1" aria-hidden="true"></a><span class="kw">select</span>(tb, <span class="op">-</span>x, <span class="op">-</span>z)</span></code></pre></div>
<pre><code>## # A tibble: 4 x 2
##       y t    
##   &lt;dbl&gt; &lt;chr&gt;
## 1     1 a    
## 2     4 b    
## 3     9 c    
## 4    16 d</code></pre>
<p>Pour <em>sélectionner des lignes</em>, la fonction <code>slice()</code> du <em>package</em> {<code>dplyr</code>} attend de recevoir les indices des lignes à extraire :</p>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb679-1"><a href="données.html#cb679-1" aria-hidden="true"></a>tb &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">4</span>), <span class="dt">z =</span> LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">t =</span> letters[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])</span>
<span id="cb679-2"><a href="données.html#cb679-2" aria-hidden="true"></a><span class="kw">slice</span>(tb, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>))</span></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##       x z     t    
##   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
## 1     1 A     a    
## 2     3 C     c    
## 3     4 D     d</code></pre>

<div class="remarque">
La numérotation des lignes a été changée, elle a été recommencée à zéro.
</div>
<p>Si la fonction <code>slice()</code> reçoit des entiers négatifs, les lignes dont l’indice est donné par la valeur absolue de ces entiers seront retirées :</p>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="données.html#cb681-1" aria-hidden="true"></a>tb &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">4</span>), <span class="dt">z =</span> LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">t =</span> letters[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])</span>
<span id="cb681-2"><a href="données.html#cb681-2" aria-hidden="true"></a><span class="kw">slice</span>(tb, <span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##       x z     t    
##   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
## 1     2 B     b</code></pre>
</div>
<div id="filtrage" class="section level4" number="2.4.6.3">
<h4><span class="header-section-number">2.4.6.3</span> Filtrage</h4>
<p>Le filtrage par masque a été abordé dans la Section <a href="données.html#manip-acces">2.4.2</a>. Encore une fois, le <em>package</em> {<code>dplyr</code>} propose une fonction très simple d’emploi pour sélectionner des lignes : <code>filter()</code>. Le premier argument est le nom du <em>tibble</em>, le second et les suivants correspondent aux expressions à évaluer à l’intérieur du <code>tibble</code>. Il est possible de fournir une expression logique complèxe au deuxième argument ou aux suivants. S’il y a plus de deux arguments, une expression logique sera constuite avec les arguments à partir du deuxième, en les liant par un ET logique.</p>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb683-1"><a href="données.html#cb683-1" aria-hidden="true"></a><span class="co"># Les femmes dont la taille vaut exactement 60 pouces</span></span>
<span id="cb683-2"><a href="données.html#cb683-2" aria-hidden="true"></a>femmes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb683-3"><a href="données.html#cb683-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(height <span class="op">==</span><span class="st"> </span><span class="dv">60</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   height weight
##    &lt;dbl&gt;  &lt;dbl&gt;
## 1     60    120</code></pre>
<div class="sourceCode" id="cb685"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb685-1"><a href="données.html#cb685-1" aria-hidden="true"></a><span class="co"># Les femmes dont la masse vaut plus de 120 libres</span></span>
<span id="cb685-2"><a href="données.html#cb685-2" aria-hidden="true"></a><span class="co"># et dont la taille est inférieure ou égale à 62 pouces</span></span>
<span id="cb685-3"><a href="données.html#cb685-3" aria-hidden="true"></a>femmes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb685-4"><a href="données.html#cb685-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(weight <span class="op">&gt;</span><span class="st"> </span><span class="dv">120</span>, height <span class="op">&lt;=</span><span class="st"> </span><span class="dv">62</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   height weight
##    &lt;dbl&gt;  &lt;dbl&gt;
## 1     61    123
## 2     62    126</code></pre>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb687-1"><a href="données.html#cb687-1" aria-hidden="true"></a><span class="co"># De manière équivalente :</span></span>
<span id="cb687-2"><a href="données.html#cb687-2" aria-hidden="true"></a>femmes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb687-3"><a href="données.html#cb687-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(weight <span class="op">&gt;</span><span class="st"> </span><span class="dv">120</span> <span class="op">&amp;</span><span class="st"> </span>height <span class="op">&lt;=</span><span class="st"> </span><span class="dv">62</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   height weight
##    &lt;dbl&gt;  &lt;dbl&gt;
## 1     61    123
## 2     62    126</code></pre>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="données.html#cb689-1" aria-hidden="true"></a><span class="co"># Les femmes dont la masse vaut 150 ou 159 livres</span></span>
<span id="cb689-2"><a href="données.html#cb689-2" aria-hidden="true"></a><span class="co"># ou dont la taille est égale à 62 pouces</span></span>
<span id="cb689-3"><a href="données.html#cb689-3" aria-hidden="true"></a>femmes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb689-4"><a href="données.html#cb689-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(weight <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">150</span>,<span class="dv">159</span>) <span class="op">|</span><span class="st"> </span>height <span class="op">==</span><span class="st"> </span><span class="dv">62</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 2
##   height weight
##    &lt;dbl&gt;  &lt;dbl&gt;
## 1     62    126
## 2     69    150
## 3     71    159</code></pre>
</div>
<div id="retirer-les-valeurs-dupliquées" class="section level4" number="2.4.6.4">
<h4><span class="header-section-number">2.4.6.4</span> Retirer les valeurs dupliquées</h4>
<p>Pour se séparer des observations contenues plusieurs fois dans un <em>tibble</em>, on utilise la fonction <code>unique()</code>.</p>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb691-1"><a href="données.html#cb691-1" aria-hidden="true"></a><span class="co"># Les observations 1 et 7, ainsi que 3 et 6 sont dupliquées</span></span>
<span id="cb691-2"><a href="données.html#cb691-2" aria-hidden="true"></a>df &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> letters[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">1</span>)],</span>
<span id="cb691-3"><a href="données.html#cb691-3" aria-hidden="true"></a>                 <span class="dt">y =</span> letters[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>)])</span>
<span id="cb691-4"><a href="données.html#cb691-4" aria-hidden="true"></a></span>
<span id="cb691-5"><a href="données.html#cb691-5" aria-hidden="true"></a><span class="kw">unique</span>(df)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 2
##   x     y    
##   &lt;chr&gt; &lt;chr&gt;
## 1 a     a    
## 2 b     e    
## 3 c     b    
## 4 a     d    
## 5 d     c</code></pre>
</div>
<div id="modification-des-colonnes" class="section level4" number="2.4.6.5">
<h4><span class="header-section-number">2.4.6.5</span> Modification des colonnes</h4>
<p>La Section <a href="données.html#manip-acces">2.4.2</a> a posé les bases au sujet de la modification d’objets. Cette section apporte quelques informations supplémentaires.</p>
<p>Une des premières modifications que l’on peut apporter à un <em>tibble</em> est de renommer ses colonnes. On peut s’en sortir sans fournir trop d’efforts à l’aide de la fonction <code>colnames()</code> et de la flèche d’assignation :</p>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb693-1"><a href="données.html#cb693-1" aria-hidden="true"></a><span class="kw">colnames</span>(femmes)</span></code></pre></div>
<pre><code>## [1] &quot;height&quot; &quot;weight&quot;</code></pre>
<div class="sourceCode" id="cb695"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb695-1"><a href="données.html#cb695-1" aria-hidden="true"></a><span class="kw">colnames</span>(femmes)[<span class="kw">which</span>(<span class="kw">colnames</span>(femmes) <span class="op">==</span><span class="st"> &quot;height&quot;</span>)] &lt;-<span class="st"> &quot;taille&quot;</span></span>
<span id="cb695-2"><a href="données.html#cb695-2" aria-hidden="true"></a><span class="kw">colnames</span>(femmes)</span></code></pre></div>
<pre><code>## [1] &quot;taille&quot; &quot;weight&quot;</code></pre>
<p>Cependant, cette syntaxe est assez lourde. La fonction <code>rename()</code> du <em>package</em> {<code>dplyr</code>} propose de réaliser la même tâche de manière plus lisible :</p>
<div class="sourceCode" id="cb697"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb697-1"><a href="données.html#cb697-1" aria-hidden="true"></a>femmes &lt;-</span>
<span id="cb697-2"><a href="données.html#cb697-2" aria-hidden="true"></a><span class="st">  </span>femmes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb697-3"><a href="données.html#cb697-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">masse =</span> weight)</span>
<span id="cb697-4"><a href="données.html#cb697-4" aria-hidden="true"></a><span class="kw">colnames</span>(femmes)</span></code></pre></div>
<pre><code>## [1] &quot;taille&quot; &quot;masse&quot;</code></pre>
<p>Pour renommer plusieurs colonnes avec la fonction <code>rename()</code>, il suffit d’ajouter des arguments :</p>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb699-1"><a href="données.html#cb699-1" aria-hidden="true"></a><span class="kw">rename</span>(femmes, <span class="dt">poids =</span> masse, <span class="dt">hauteur =</span> taille)</span></code></pre></div>
<pre><code>## # A tibble: 15 x 2
##    hauteur poids
##      &lt;dbl&gt; &lt;dbl&gt;
##  1      58   115
##  2      59   117
##  3      60   120
##  4      61   123
##  5      62   126
##  6      63   129
##  7      64   132
##  8      65   135
##  9      66   139
## 10      67   142
## 11      68   146
## 12      69   150
## 13      70   154
## 14      71   159
## 15      72   164</code></pre>
<p>On peut noter qu’avec la fonction <code>select()</code>, il est possible de sélectionner une variable et de la renommer directement :</p>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb701-1"><a href="données.html#cb701-1" aria-hidden="true"></a>femmes <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb701-2"><a href="données.html#cb701-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(<span class="dt">poids =</span> masse, <span class="dt">hauteur =</span> taille) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb701-3"><a href="données.html#cb701-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">head</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   poids hauteur
##   &lt;dbl&gt;   &lt;dbl&gt;
## 1   115      58
## 2   117      59</code></pre>
<p>Pour ajouter une colonne, ou pour appliquer des changements à tous les éléments d’une colonne, on peut utiliser la flèche d’assignation :</p>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb703-1"><a href="données.html#cb703-1" aria-hidden="true"></a><span class="co"># Nombre de chomeurs et d&#39;actifs en millions de personnes</span></span>
<span id="cb703-2"><a href="données.html#cb703-2" aria-hidden="true"></a>chomeurs &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">annee =</span> <span class="dv">2012</span><span class="op">:</span><span class="dv">2008</span>,</span>
<span id="cb703-3"><a href="données.html#cb703-3" aria-hidden="true"></a><span class="dt">nb_chomeurs =</span> <span class="kw">c</span>(<span class="fl">2.811</span>, <span class="fl">2.604</span>, <span class="fl">2.635</span>, <span class="fl">2.573</span>, <span class="fl">2.064</span>),</span>
<span id="cb703-4"><a href="données.html#cb703-4" aria-hidden="true"></a><span class="dt">pop_active =</span> <span class="kw">c</span>(<span class="fl">28.328</span>, <span class="fl">28.147</span>, <span class="fl">28.157</span>, <span class="fl">28.074</span>, <span class="fl">27.813</span>))</span>
<span id="cb703-5"><a href="données.html#cb703-5" aria-hidden="true"></a></span>
<span id="cb703-6"><a href="données.html#cb703-6" aria-hidden="true"></a>chomeurs<span class="op">$</span>taux_chomage_<span class="dv">0</span> &lt;-<span class="st"> </span>chomeurs<span class="op">$</span>nb_chomeurs <span class="op">/</span><span class="st"> </span>chomeurs<span class="op">$</span>pop_active <span class="op">*</span><span class="st"> </span><span class="dv">100</span></span></code></pre></div>
<p>Comme on peut le voir, il est assez laborieux de devoir réécrire le nom du <em>tibble</em> pour accéder à ses colonnes afin de faire des modifications ou des créations de variables (bien qu’avec uniquement deux variables à utiliser, cela reste encore faisable sans trop de pénibilité). Le <em>package</em> {<code>dplyr</code>} propose la fonction <code>mutate()</code> pour créer ou modifier une ou plusieurs colonnes.</p>
<div class="sourceCode" id="cb704"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb704-1"><a href="données.html#cb704-1" aria-hidden="true"></a>chomeurs &lt;-<span class="st"> </span></span>
<span id="cb704-2"><a href="données.html#cb704-2" aria-hidden="true"></a><span class="st">  </span>chomeurs <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb704-3"><a href="données.html#cb704-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">tx_chomage_1 =</span> nb_chomeurs<span class="op">/</span>pop_active<span class="op">*</span><span class="dv">100</span>,</span>
<span id="cb704-4"><a href="données.html#cb704-4" aria-hidden="true"></a>         <span class="dt">log_nb_chomeurs =</span> <span class="kw">log</span>(nb_chomeurs))</span>
<span id="cb704-5"><a href="données.html#cb704-5" aria-hidden="true"></a>chomeurs</span></code></pre></div>
<pre><code>## # A tibble: 5 x 6
##   annee nb_chomeurs pop_active taux_chomage_0 tx_chomage_1 log_nb_chomeurs
##   &lt;int&gt;       &lt;dbl&gt;      &lt;dbl&gt;          &lt;dbl&gt;        &lt;dbl&gt;           &lt;dbl&gt;
## 1  2012        2.81       28.3           9.92         9.92           1.03 
## 2  2011        2.60       28.1           9.25         9.25           0.957
## 3  2010        2.64       28.2           9.36         9.36           0.969
## 4  2009        2.57       28.1           9.17         9.17           0.945
## 5  2008        2.06       27.8           7.42         7.42           0.725</code></pre>
<p>Avec la fonction <code>mutate()</code>, il est possible de faire référence directement à la variable créé :</p>
<div class="sourceCode" id="cb706"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb706-1"><a href="données.html#cb706-1" aria-hidden="true"></a>chomeurs &lt;-<span class="st"> </span></span>
<span id="cb706-2"><a href="données.html#cb706-2" aria-hidden="true"></a><span class="st">  </span>chomeurs <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb706-3"><a href="données.html#cb706-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">tx_chomage_2 =</span> nb_chomeurs<span class="op">/</span>pop_active<span class="op">*</span><span class="dv">100</span>,</span>
<span id="cb706-4"><a href="données.html#cb706-4" aria-hidden="true"></a>         <span class="dt">log_tx_chomage =</span> <span class="kw">log</span>(tx_chomage_<span class="dv">2</span>))</span>
<span id="cb706-5"><a href="données.html#cb706-5" aria-hidden="true"></a>chomeurs</span></code></pre></div>
<pre><code>## # A tibble: 5 x 8
##   annee nb_chomeurs pop_active taux_chomage_0 tx_chomage_1 log_nb_chomeurs
##   &lt;int&gt;       &lt;dbl&gt;      &lt;dbl&gt;          &lt;dbl&gt;        &lt;dbl&gt;           &lt;dbl&gt;
## 1  2012        2.81       28.3           9.92         9.92           1.03 
## 2  2011        2.60       28.1           9.25         9.25           0.957
## 3  2010        2.64       28.2           9.36         9.36           0.969
## 4  2009        2.57       28.1           9.17         9.17           0.945
## 5  2008        2.06       27.8           7.42         7.42           0.725
## # … with 2 more variables: tx_chomage_2 &lt;dbl&gt;, log_tx_chomage &lt;dbl&gt;</code></pre>
<p>Pour modifier une colonne, il suffit de créer une colonne portant le même nom :</p>
<div class="sourceCode" id="cb708"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb708-1"><a href="données.html#cb708-1" aria-hidden="true"></a>chomeurs <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb708-2"><a href="données.html#cb708-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">annee =</span> annee <span class="op">/</span><span class="st"> </span><span class="dv">1000</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 8
##   annee nb_chomeurs pop_active taux_chomage_0 tx_chomage_1 log_nb_chomeurs
##   &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;          &lt;dbl&gt;        &lt;dbl&gt;           &lt;dbl&gt;
## 1  2.01        2.81       28.3           9.92         9.92           1.03 
## 2  2.01        2.60       28.1           9.25         9.25           0.957
## 3  2.01        2.64       28.2           9.36         9.36           0.969
## 4  2.01        2.57       28.1           9.17         9.17           0.945
## 5  2.01        2.06       27.8           7.42         7.42           0.725
## # … with 2 more variables: tx_chomage_2 &lt;dbl&gt;, log_tx_chomage &lt;dbl&gt;</code></pre>
<p>Pour conserver uniquement les variables nouvellement créées, on peut utiliser la fonction <code>transmute()</code> du <em>package</em> {<code>dplyr</code>} :</p>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb710-1"><a href="données.html#cb710-1" aria-hidden="true"></a>chomeurs <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb710-2"><a href="données.html#cb710-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">annee =</span> annee <span class="op">/</span><span class="st"> </span><span class="dv">1000</span>,</span>
<span id="cb710-3"><a href="données.html#cb710-3" aria-hidden="true"></a>            <span class="dt">tx_chomage =</span> nb_chomeurs<span class="op">/</span>pop_active<span class="op">*</span><span class="dv">100</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 2
##   annee tx_chomage
##   &lt;dbl&gt;      &lt;dbl&gt;
## 1  2.01       9.92
## 2  2.01       9.25
## 3  2.01       9.36
## 4  2.01       9.17
## 5  2.01       7.42</code></pre>
<p>Il existe une méthode qui à première vue semble agréable à utiliser : la fonction <code>attach()</code>, qui comme son nom l’indique, détache le tableau de données, c’est-à-dire rend les colonnes qui le composent visibles dans l’espace de travail. La fonction <code>detach()</code> produit l’effet inverse, et masque alors de l’espace de travail les colonnes du tableau de données indiqué en argument.</p>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb712-1"><a href="données.html#cb712-1" aria-hidden="true"></a><span class="kw">data</span>(quakes)</span>
<span id="cb712-2"><a href="données.html#cb712-2" aria-hidden="true"></a>quakes &lt;-<span class="st"> </span>quakes[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,]  <span class="co"># On ne prend que quelques observations pour l&#39;exemple</span></span>
<span id="cb712-3"><a href="données.html#cb712-3" aria-hidden="true"></a>quakes &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(quakes)</span>
<span id="cb712-4"><a href="données.html#cb712-4" aria-hidden="true"></a>lat  <span class="co"># lat n&#39;est pas dans l&#39;espace de travail</span></span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): objet &#39;lat&#39; introuvable</code></pre>
<div class="sourceCode" id="cb714"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb714-1"><a href="données.html#cb714-1" aria-hidden="true"></a><span class="kw">attach</span>(quakes)</span>
<span id="cb714-2"><a href="données.html#cb714-2" aria-hidden="true"></a>lat <span class="co"># maintenant il l&#39;est</span></span></code></pre></div>
<pre><code>## [1] -20.42 -20.62 -26.00 -17.97</code></pre>
<div class="sourceCode" id="cb716"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb716-1"><a href="données.html#cb716-1" aria-hidden="true"></a><span class="kw">detach</span>(quakes)</span>
<span id="cb716-2"><a href="données.html#cb716-2" aria-hidden="true"></a>lat <span class="co"># il est à nouveau masqué</span></span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): objet &#39;lat&#39; introuvable</code></pre>
<p>Cependant, l’utilisation de la fonction <code>attach()</code> cause bien souvent des confusions et problèmes lors de l’emploi d’autres fonctions. À éviter.</p>
</div>
<div id="tri" class="section level4" number="2.4.6.6">
<h4><span class="header-section-number">2.4.6.6</span> Tri</h4>
<p>Il existe plusieurs manières de trier un tableau. Une ancienne méthode consiste à utiliser la fonction <code>order()</code>. Le <em>package</em> {<code>dplyr</code>} propose également une solution qui s’intègre bien dans les opérations chaînées, avec la fonction <code>arrange()</code>.</p>
<p>Il ne semble pas inutile de présenter <code>order()</code>, dans la mesure où cette fonction peut parfois être utile sur des vecteurs en dehors des tableaux de données.</p>
<p>Il est aisé de trier un <em>tibble</em> par ordre croissant ou décroissant d’une ou plusieurs de ses colonnes. Pour ce faire, on peut utiliser la fonction <code>order()</code>, qui retourne les rangs de classement des éléments du ou des arguments. En cas d’_ex æquo, les rangs sont classés par ordre d’apparition dans le <em>tibble</em>.</p>
<div class="sourceCode" id="cb718"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb718-1"><a href="données.html#cb718-1" aria-hidden="true"></a>tb &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb718-2"><a href="données.html#cb718-2" aria-hidden="true"></a>  <span class="dt">nom =</span> <span class="kw">c</span>(<span class="st">&quot;Durand&quot;</span>, <span class="st">&quot;Martin&quot;</span>, <span class="st">&quot;Martin&quot;</span>, <span class="st">&quot;Martin&quot;</span>, <span class="st">&quot;Durand&quot;</span>),</span>
<span id="cb718-3"><a href="données.html#cb718-3" aria-hidden="true"></a>  <span class="dt">prenom =</span> <span class="kw">c</span>(<span class="st">&quot;Sonia&quot;</span>, <span class="st">&quot;Serge&quot;</span>, <span class="st">&quot;Julien-Yacine&quot;</span>, <span class="st">&quot;Victor&quot;</span>, <span class="st">&quot;Emma&quot;</span>),</span>
<span id="cb718-4"><a href="données.html#cb718-4" aria-hidden="true"></a>  <span class="dt">note =</span> <span class="kw">c</span>(<span class="dv">23</span>, <span class="dv">18</span>, <span class="dv">17</span>, <span class="dv">17</span>, <span class="dv">19</span>))</span>
<span id="cb718-5"><a href="données.html#cb718-5" aria-hidden="true"></a><span class="co"># Ordonner par notes décroissantes</span></span>
<span id="cb718-6"><a href="données.html#cb718-6" aria-hidden="true"></a><span class="kw">order</span>(tb<span class="op">$</span>note, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 1 5 2 3 4</code></pre>
<div class="sourceCode" id="cb720"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb720-1"><a href="données.html#cb720-1" aria-hidden="true"></a>tb[<span class="kw">order</span>(tb<span class="op">$</span>note), ]</span></code></pre></div>
<pre><code>## # A tibble: 5 x 3
##   nom    prenom         note
##   &lt;chr&gt;  &lt;chr&gt;         &lt;dbl&gt;
## 1 Martin Julien-Yacine    17
## 2 Martin Victor           17
## 3 Martin Serge            18
## 4 Durand Emma             19
## 5 Durand Sonia            23</code></pre>
<div class="sourceCode" id="cb722"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb722-1"><a href="données.html#cb722-1" aria-hidden="true"></a><span class="co"># Ordonner par ordre alphabétique des noms puis des prénoms</span></span>
<span id="cb722-2"><a href="données.html#cb722-2" aria-hidden="true"></a>tb[<span class="kw">with</span>(tb, <span class="kw">order</span>(nom, prenom)), ]</span></code></pre></div>
<pre><code>## # A tibble: 5 x 3
##   nom    prenom         note
##   &lt;chr&gt;  &lt;chr&gt;         &lt;dbl&gt;
## 1 Durand Emma             19
## 2 Durand Sonia            23
## 3 Martin Julien-Yacine    17
## 4 Martin Serge            18
## 5 Martin Victor           17</code></pre>

<div class="remarque">
La fonction <code>sort()</code> retourne un vecteur trié par valeurs croissantes ou décroissantes. La fonction <code>order()</code> retourne les rangs du classement.
</div>
<p>La fonction <code>arrange()</code> du <em>package</em> {<code>dplyr</code>} permet aussi de trier un tableau de données. Son utilisation semble plus aisée pour certains, surtout lorsque le tri s’effectue en fonction de plusieurs colonnes. Comme il n’y a pas de l’argument <code>decreasing</code> deux méthodes sont possibles :</p>
<ul>
<li>faire appel à la fonction <code>desc()</code>, elle aussi contenue dans le <em>package</em> {<code>dplyr</code>}, qui permet de trier le vecteur donné en argument par ordre de valeurs décroissantes ;</li>
<li>faire préceder le nom de la colonne par le signe <code>-</code> si les valeurs de la colonne sont numériques.</li>
</ul>
<div class="sourceCode" id="cb724"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb724-1"><a href="données.html#cb724-1" aria-hidden="true"></a><span class="co"># Ordonner par notes décroissantes</span></span>
<span id="cb724-2"><a href="données.html#cb724-2" aria-hidden="true"></a>tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(<span class="op">-</span>note)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 3
##   nom    prenom         note
##   &lt;chr&gt;  &lt;chr&gt;         &lt;dbl&gt;
## 1 Durand Sonia            23
## 2 Durand Emma             19
## 3 Martin Serge            18
## 4 Martin Julien-Yacine    17
## 5 Martin Victor           17</code></pre>
<div class="sourceCode" id="cb726"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb726-1"><a href="données.html#cb726-1" aria-hidden="true"></a><span class="co"># Ordonner par ordre alphabétique des noms puis inverse des prénoms</span></span>
<span id="cb726-2"><a href="données.html#cb726-2" aria-hidden="true"></a>tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(nom, <span class="kw">desc</span>(prenom))</span></code></pre></div>
<pre><code>## # A tibble: 5 x 3
##   nom    prenom         note
##   &lt;chr&gt;  &lt;chr&gt;         &lt;dbl&gt;
## 1 Durand Sonia            23
## 2 Durand Emma             19
## 3 Martin Victor           17
## 4 Martin Serge            18
## 5 Martin Julien-Yacine    17</code></pre>
</div>
<div id="jointures" class="section level4" number="2.4.6.7">
<h4><span class="header-section-number">2.4.6.7</span> Jointures</h4>
<p>Deux fonctions permettent de juxtaposer deuxtableaux de données ou plus entre-eux (cela fonctionne aussi avec des matrices) : <code>cbind()</code> et <code>rbind()</code>. La première fusionne les colonnes (place les tableaux côte-à-côte) tandis que la seconde fusionne les lignes (empile les tableaux les uns sur les autres). Il faut toutefois veiller à ce que le nombre de lignes des éléments passés en argument de <code>cbind()</code> correspondent, et que le nombre de colonnes de ceux passés en argument de <code>rbind()</code> correspondent aussi. De plus, lors de l’utilisation de <code>rbind()</code>, le nom des colonnes doit correspondre.</p>
<div class="sourceCode" id="cb728"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb728-1"><a href="données.html#cb728-1" aria-hidden="true"></a>(A &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x1 =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">-1</span>), <span class="dt">x2 =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">3</span>)))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##      x1    x2
##   &lt;dbl&gt; &lt;dbl&gt;
## 1     1     0
## 2    -1     3</code></pre>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb730-1"><a href="données.html#cb730-1" aria-hidden="true"></a>(B &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x1 =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>), <span class="dt">x2 =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##      x1    x2
##   &lt;dbl&gt; &lt;dbl&gt;
## 1     3     1
## 2     2     1</code></pre>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb732-1"><a href="données.html#cb732-1" aria-hidden="true"></a>(C &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x3 =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">3</span>)))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 1
##      x3
##   &lt;dbl&gt;
## 1     0
## 2     3</code></pre>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb734-1"><a href="données.html#cb734-1" aria-hidden="true"></a><span class="kw">rbind</span>(A,B)</span></code></pre></div>
<pre><code>## # A tibble: 4 x 2
##      x1    x2
##   &lt;dbl&gt; &lt;dbl&gt;
## 1     1     0
## 2    -1     3
## 3     3     1
## 4     2     1</code></pre>
<div class="sourceCode" id="cb736"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb736-1"><a href="données.html#cb736-1" aria-hidden="true"></a><span class="kw">cbind</span>(A,B)</span></code></pre></div>
<pre><code>##   x1 x2 x1 x2
## 1  1  0  3  1
## 2 -1  3  2  1</code></pre>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb738-1"><a href="données.html#cb738-1" aria-hidden="true"></a><span class="kw">cbind</span>(A,B,C)</span></code></pre></div>
<pre><code>##   x1 x2 x1 x2 x3
## 1  1  0  3  1  0
## 2 -1  3  2  1  3</code></pre>
<p>Toutefois, lors de la fusion de tableaux de données, l’emploi de la fonction <code>cbind()</code> n’est pas très pratique, puisque s’il existe une colonne identique aux tableaux de données à fusionner, elle sera dupliquée dans le résultat de la fusion.</p>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb740-1"><a href="données.html#cb740-1" aria-hidden="true"></a>(pib &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">annee =</span> <span class="dv">2010</span><span class="op">:</span><span class="dv">2013</span>, <span class="dt">pib =</span> <span class="kw">c</span>(<span class="fl">1998.5</span>, <span class="fl">2059.3</span>, <span class="fl">2091.1</span>, <span class="fl">2113.7</span>)))</span></code></pre></div>
<pre><code>##   annee    pib
## 1  2010 1998.5
## 2  2011 2059.3
## 3  2012 2091.1
## 4  2013 2113.7</code></pre>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb742-1"><a href="données.html#cb742-1" aria-hidden="true"></a>(importations &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">annee =</span> <span class="dv">2010</span><span class="op">:</span><span class="dv">2013</span>, <span class="dt">importations =</span> <span class="kw">c</span>(<span class="fl">558.1</span>, <span class="fl">625.3</span>, <span class="fl">628.5</span>, <span class="fl">629.1</span>)))</span></code></pre></div>
<pre><code>##   annee importations
## 1  2010        558.1
## 2  2011        625.3
## 3  2012        628.5
## 4  2013        629.1</code></pre>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb744-1"><a href="données.html#cb744-1" aria-hidden="true"></a><span class="kw">cbind</span>(pib, importations)</span></code></pre></div>
<pre><code>##   annee    pib annee importations
## 1  2010 1998.5  2010        558.1
## 2  2011 2059.3  2011        625.3
## 3  2012 2091.1  2012        628.5
## 4  2013 2113.7  2013        629.1</code></pre>
<p>De plus, le but d’une telle opération de juxtaposition se révèle utile en économétrie surtout lorsque l’on désire apparier des données de sources différentes. Il faut donc, avec <code>cbind()</code>, s’assurer au préalable que les individus du premier tableau apparaissent dans le même ordre que ceux du second. Cette étape est assez pénible à réaliser, et peut être évitée à l’aide des fonctions du <em>package</em> {<code>dplyr</code>}. Ce <em>package</em> propose des fonctions pour joindre deux tableaux de données. Ces fonctions partagent une syntaxe commune : <code>xx_join(x, y, by = NULL, copy = FALSE, ...)</code>, où <code>x</code> et <code>y</code> sont les tableaux à joindre, <code>by</code> est un vecteur de chaînes de caractères contenant le nom des variables permettant la jointure (si la valeur est <code>NULL</code>, ce qui est le cas par défaut, la jointure se fera à l’aide des variables portant le même nom dans les deux tables).</p>
<p>Les différentes fonctions de jointure sont les suivantes :</p>
<p>—<code>inner_join()</code> : toutes les lignes de <code>x</code> pour lesquelles il y a des valeurs correspondantes dans <code>y</code>, et toutes les colonnes de <code>x</code> et <code>y</code>. S’il y a plusieurs correspondances dans les noms entre <code>x</code> et <code>y</code>, toutes les combinaisons possibles sont retournées ;</p>
<p>—<code>left_join()</code>: toutes les lignes de <code>x</code>, et toutes les colonnes de <code>x</code> et <code>y</code>. Les lignes dans <code>x</code> pour lesquelles il n’y a pas de correspondance dans <code>y</code> auront des valeurs <code>NA</code> dans les nouvelles colonnes. S’il y a plusieurs correspondances dans les noms entre <code>x</code> et <code>y</code>, toutesles combinaisons sont retournées ;</p>
<p>—<code>right_join()</code>: toutes les lignes de <code>y</code>, et toutes les colonnes de <code>x</code> et <code>y</code>. Les lignes dans <code>y</code> pour lesquelles il n’y a pas de correspondance dansxauront des valeurs <code>NA</code> dans les nouvelles colonnes. S’il y a plusieurs correspondances dans les noms entre <code>x</code> et <code>y</code>, toutesles combinaisons sont retournées ;</p>
<p>—<code>semi_join()</code>: toutes les lignes de <code>x</code> pour lesquelles il y a des valeurs correspondantes dans <code>y</code>, en ne conservant uniquement les colonnes de <code>x</code>;</p>
<p>—<code>anti_join()</code>: toutes les lignes dexpour lesquelles il n’y a pas de correspondances dans <code>y</code>, en ne conservant que les colonnes de <code>x</code>.</p>
<div class="sourceCode" id="cb746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb746-1"><a href="données.html#cb746-1" aria-hidden="true"></a>exportations &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb746-2"><a href="données.html#cb746-2" aria-hidden="true"></a>  <span class="dt">year =</span> <span class="dv">2011</span><span class="op">:</span><span class="dv">2013</span>, </span>
<span id="cb746-3"><a href="données.html#cb746-3" aria-hidden="true"></a>  <span class="dt">exportations =</span> <span class="kw">c</span>(<span class="fl">572.6</span>, <span class="fl">587.3</span>, <span class="fl">597.8</span>))</span>
<span id="cb746-4"><a href="données.html#cb746-4" aria-hidden="true"></a>importations &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb746-5"><a href="données.html#cb746-5" aria-hidden="true"></a>  <span class="dt">annee =</span> <span class="dv">2010</span><span class="op">:</span><span class="dv">2012</span>,</span>
<span id="cb746-6"><a href="données.html#cb746-6" aria-hidden="true"></a>  <span class="dt">importations =</span> <span class="kw">c</span>(<span class="fl">558.1</span>, <span class="fl">625.3</span>, <span class="fl">628.5</span>))</span>
<span id="cb746-7"><a href="données.html#cb746-7" aria-hidden="true"></a></span>
<span id="cb746-8"><a href="données.html#cb746-8" aria-hidden="true"></a>exportations ; importations</span></code></pre></div>
<pre><code>## # A tibble: 3 x 2
##    year exportations
##   &lt;int&gt;        &lt;dbl&gt;
## 1  2011         573.
## 2  2012         587.
## 3  2013         598.</code></pre>
<pre><code>## # A tibble: 3 x 2
##   annee importations
##   &lt;int&gt;        &lt;dbl&gt;
## 1  2010         558.
## 2  2011         625.
## 3  2012         628.</code></pre>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb749-1"><a href="données.html#cb749-1" aria-hidden="true"></a>exportations <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">inner_join</span>(importations, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;year&quot;</span> =<span class="st"> &quot;annee&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##    year exportations importations
##   &lt;int&gt;        &lt;dbl&gt;        &lt;dbl&gt;
## 1  2011         573.         625.
## 2  2012         587.         628.</code></pre>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb751-1"><a href="données.html#cb751-1" aria-hidden="true"></a>exportations <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(importations, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;year&quot;</span> =<span class="st"> &quot;annee&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##    year exportations importations
##   &lt;int&gt;        &lt;dbl&gt;        &lt;dbl&gt;
## 1  2011         573.         625.
## 2  2012         587.         628.
## 3  2013         598.          NA</code></pre>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb753-1"><a href="données.html#cb753-1" aria-hidden="true"></a>exportations <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">right_join</span>(importations, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;year&quot;</span> =<span class="st"> &quot;annee&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##    year exportations importations
##   &lt;int&gt;        &lt;dbl&gt;        &lt;dbl&gt;
## 1  2011         573.         625.
## 2  2012         587.         628.
## 3  2010          NA          558.</code></pre>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb755-1"><a href="données.html#cb755-1" aria-hidden="true"></a>exportations <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">semi_join</span>(importations, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;year&quot;</span> =<span class="st"> &quot;annee&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##    year exportations
##   &lt;int&gt;        &lt;dbl&gt;
## 1  2011         573.
## 2  2012         587.</code></pre>
<div class="sourceCode" id="cb757"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb757-1"><a href="données.html#cb757-1" aria-hidden="true"></a>exportations <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">anti_join</span>(importations, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;year&quot;</span> =<span class="st"> &quot;annee&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##    year exportations
##   &lt;int&gt;        &lt;dbl&gt;
## 1  2013         598.</code></pre>
</div>
<div id="agrégation" class="section level4" number="2.4.6.8">
<h4><span class="header-section-number">2.4.6.8</span> Agrégation</h4>
<p>Il arrive de vouloir agréger les valeurs d’une variable, pour passer par exemple d’une dimension trimestrielle à annuelle. Avec des observations spatiales, cela peut aussi être le cas, comme par exemple lorsque l’on dispose de données à l’échelle des départements et que l’on souhaite connaître les valeurs agrégées à l’échelle des régions.</p>
<p>Le <em>package</em> {<code>dplyr</code>} propose une fonction simple d’utilisation : <code>summarise()</code>. Elle permet de réduire une colonne d’un tableau de données à une seule observation. On lui fournit un tableau de données en premier argument, et une ou plusieurs opérations à réaliser sur le tableau en arguments suivants.</p>
<div class="sourceCode" id="cb759"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb759-1"><a href="données.html#cb759-1" aria-hidden="true"></a><span class="co"># Nombre d&#39;ingenieurs et cadres au chômage</span></span>
<span id="cb759-2"><a href="données.html#cb759-2" aria-hidden="true"></a>chomage &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb759-3"><a href="données.html#cb759-3" aria-hidden="true"></a>  <span class="dt">region =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;Bretagne&quot;</span>, <span class="dv">4</span>), <span class="kw">rep</span>(<span class="st">&quot;Corse&quot;</span>, <span class="dv">2</span>)), <span class="dv">2</span>),</span>
<span id="cb759-4"><a href="données.html#cb759-4" aria-hidden="true"></a>  <span class="dt">departement =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Cotes-d&#39;Armor&quot;</span>, <span class="st">&quot;Finistere&quot;</span>,</span>
<span id="cb759-5"><a href="données.html#cb759-5" aria-hidden="true"></a>                      <span class="st">&quot;Ille-et-Vilaine&quot;</span>, <span class="st">&quot;Morbihan&quot;</span>,</span>
<span id="cb759-6"><a href="données.html#cb759-6" aria-hidden="true"></a>                      <span class="st">&quot;Corse-du-Sud&quot;</span>, <span class="st">&quot;Haute-Corse&quot;</span>), <span class="dv">2</span>), </span>
<span id="cb759-7"><a href="données.html#cb759-7" aria-hidden="true"></a>  <span class="dt">annee =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">2011</span>, <span class="dv">2010</span>), <span class="dt">each =</span> <span class="dv">6</span>),</span>
<span id="cb759-8"><a href="données.html#cb759-8" aria-hidden="true"></a>  <span class="dt">ouvriers =</span> <span class="kw">c</span>(<span class="dv">8738</span>, <span class="dv">12701</span>, <span class="dv">11390</span>, <span class="dv">10228</span>, <span class="dv">975</span>, <span class="dv">1297</span>,</span>
<span id="cb759-9"><a href="données.html#cb759-9" aria-hidden="true"></a>               <span class="dv">8113</span>, <span class="dv">12258</span>, <span class="dv">10897</span>, <span class="dv">9617</span>, <span class="dv">936</span>, <span class="dv">1220</span>), </span>
<span id="cb759-10"><a href="données.html#cb759-10" aria-hidden="true"></a>  <span class="dt">ingenieurs =</span> <span class="kw">c</span>(<span class="dv">1420</span>, <span class="dv">2530</span>, <span class="dv">3986</span>, <span class="dv">2025</span>, <span class="dv">259</span>, <span class="dv">254</span>,</span>
<span id="cb759-11"><a href="données.html#cb759-11" aria-hidden="true"></a>                 <span class="dv">1334</span>, <span class="dv">2401</span>, <span class="dv">3776</span>, <span class="dv">1979</span>, <span class="dv">253</span>, <span class="dv">241</span>))</span>
<span id="cb759-12"><a href="données.html#cb759-12" aria-hidden="true"></a>chomage</span></code></pre></div>
<pre><code>## # A tibble: 12 x 5
##    region   departement     annee ouvriers ingenieurs
##    &lt;chr&gt;    &lt;chr&gt;           &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
##  1 Bretagne Cotes-d&#39;Armor    2011     8738       1420
##  2 Bretagne Finistere        2011    12701       2530
##  3 Bretagne Ille-et-Vilaine  2011    11390       3986
##  4 Bretagne Morbihan         2011    10228       2025
##  5 Corse    Corse-du-Sud     2011      975        259
##  6 Corse    Haute-Corse      2011     1297        254
##  7 Bretagne Cotes-d&#39;Armor    2010     8113       1334
##  8 Bretagne Finistere        2010    12258       2401
##  9 Bretagne Ille-et-Vilaine  2010    10897       3776
## 10 Bretagne Morbihan         2010     9617       1979
## 11 Corse    Corse-du-Sud     2010      936        253
## 12 Corse    Haute-Corse      2010     1220        241</code></pre>
<div class="sourceCode" id="cb761"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb761-1"><a href="données.html#cb761-1" aria-hidden="true"></a><span class="co"># Moyenne de la colonne ouvriers</span></span>
<span id="cb761-2"><a href="données.html#cb761-2" aria-hidden="true"></a>chomage <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb761-3"><a href="données.html#cb761-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">moy_ouvriers =</span> <span class="kw">mean</span>(ouvriers),</span>
<span id="cb761-4"><a href="données.html#cb761-4" aria-hidden="true"></a>            <span class="dt">sd_ouvriers =</span> <span class="kw">sd</span>(ouvriers),</span>
<span id="cb761-5"><a href="données.html#cb761-5" aria-hidden="true"></a>            <span class="dt">moy_ingenieurs =</span> <span class="kw">mean</span>(ingenieurs),</span>
<span id="cb761-6"><a href="données.html#cb761-6" aria-hidden="true"></a>            <span class="dt">sd_ingenieurs =</span> <span class="kw">sd</span>(ingenieurs))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 4
##   moy_ouvriers sd_ouvriers moy_ingenieurs sd_ingenieurs
##          &lt;dbl&gt;       &lt;dbl&gt;          &lt;dbl&gt;         &lt;dbl&gt;
## 1        7364.       4801.          1705.         1331.</code></pre>
<p>Couplée à la fonction <code>group_by()</code> du même <em>package</em>, elle prend toute sa puissance. La fonction <code>group_by()</code> permet de regrouper les observations d’un tableau de données en sous-groupes, qui sont créés en fonction des variables données en arguments.</p>
<p>Par exemple, si on désire obtenir la somme par année des colonnes <code>ouvriers</code> et <code>ingenieurs</code> du tableau <code>chomage</code> :</p>
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb763-1"><a href="données.html#cb763-1" aria-hidden="true"></a>chomage <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb763-2"><a href="données.html#cb763-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">group_by</span>(annee) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb763-3"><a href="données.html#cb763-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">ouvriers =</span> <span class="kw">sum</span>(ouvriers),</span>
<span id="cb763-4"><a href="données.html#cb763-4" aria-hidden="true"></a>            <span class="dt">ingenieurs =</span> <span class="kw">sum</span>(ingenieurs))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   annee ouvriers ingenieurs
##   &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
## 1  2010    43041       9984
## 2  2011    45329      10474</code></pre>
<p>Si on désire que les calculs soient effectués sur les sous-groupes définis à la fois par les années et les régions, il suffit de fournir les noms de ces deux colonnes du tableau en arguments à la fonction <code>group_by()</code> avant d’appliquer la fonction <code>sum()</code> aux colonnes contenant les valeurs numériques :</p>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb765-1"><a href="données.html#cb765-1" aria-hidden="true"></a>chomage <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb765-2"><a href="données.html#cb765-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">group_by</span>(annee, region) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb765-3"><a href="données.html#cb765-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">ouvriers =</span> <span class="kw">sum</span>(ouvriers),</span>
<span id="cb765-4"><a href="données.html#cb765-4" aria-hidden="true"></a>            <span class="dt">ingenieurs =</span> <span class="kw">sum</span>(ingenieurs))</span></code></pre></div>
<pre><code>## # A tibble: 4 x 4
## # Groups:   annee [2]
##   annee region   ouvriers ingenieurs
##   &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;
## 1  2010 Bretagne    40885       9490
## 2  2010 Corse        2156        494
## 3  2011 Bretagne    43057       9961
## 4  2011 Corse        2272        513</code></pre>
<p>Attention, si des calculs sur les résultats obtenus sur des sous-groupes doivent être effectués par la suite, il faut penser à dégrouper le tableau obtenu, avec la fonction <code>degroup()</code> :</p>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb767-1"><a href="données.html#cb767-1" aria-hidden="true"></a>chomage <span class="op">%&gt;%</span></span>
<span id="cb767-2"><a href="données.html#cb767-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">group_by</span>(annee, region) <span class="op">%&gt;%</span></span>
<span id="cb767-3"><a href="données.html#cb767-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">ouvriers =</span> <span class="kw">sum</span>(ouvriers),</span>
<span id="cb767-4"><a href="données.html#cb767-4" aria-hidden="true"></a>            <span class="dt">ingenieurs =</span><span class="kw">sum</span>(ingenieurs)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb767-5"><a href="données.html#cb767-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">ungroup</span>()</span></code></pre></div>
<pre><code>## # A tibble: 4 x 4
##   annee region   ouvriers ingenieurs
##   &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;
## 1  2010 Bretagne    40885       9490
## 2  2010 Corse        2156        494
## 3  2011 Bretagne    43057       9961
## 4  2011 Corse        2272        513</code></pre>
</div>
<div id="faire-pivoter-un-tableau" class="section level4" number="2.4.6.9">
<h4><span class="header-section-number">2.4.6.9</span> Faire pivoter un tableau</h4>
<p>Devoir faire pivoter un tableau arrive fréquemment en R, principalement pour préparer les données avant de les fournir aux fonctions permettant de réaliser des graphiques. Deux fonctions dans le <em>package</em> {<code>tidyr</code>} sont en cours de maturation à la rédaction de ces diapositives :</p>
<ul>
<li><code>pivot_longer()</code> : pivoter des données d’un tableau large vers un tableau long,</li>
<li><code>pivot_wider()</code> : pivoter des données d’un tableau long vers un tableau en largeur.</li>
</ul>
<p>Voici un tableau large :</p>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb769-1"><a href="données.html#cb769-1" aria-hidden="true"></a>pop &lt;-</span>
<span id="cb769-2"><a href="données.html#cb769-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">ville =</span><span class="kw">c</span> (<span class="st">&quot;Paris&quot;</span>, <span class="st">&quot;Paris&quot;</span>, <span class="st">&quot;Lyon&quot;</span>, <span class="st">&quot;Lyon&quot;</span>),</span>
<span id="cb769-3"><a href="données.html#cb769-3" aria-hidden="true"></a>         <span class="dt">arrondissement =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb769-4"><a href="données.html#cb769-4" aria-hidden="true"></a>         <span class="dt">pop_municipale =</span><span class="kw">c</span> (<span class="dv">17443</span>, <span class="dv">22927</span>, <span class="dv">28932</span>, <span class="dv">30575</span>),</span>
<span id="cb769-5"><a href="données.html#cb769-5" aria-hidden="true"></a>         <span class="dt">pop_totale =</span><span class="kw">c</span>(<span class="dv">17620</span>, <span class="dv">23102</span>, <span class="dv">29874</span>, <span class="dv">31131</span>))</span>
<span id="cb769-6"><a href="données.html#cb769-6" aria-hidden="true"></a></span>
<span id="cb769-7"><a href="données.html#cb769-7" aria-hidden="true"></a>pop</span></code></pre></div>
<pre><code>## # A tibble: 4 x 4
##   ville arrondissement pop_municipale pop_totale
##   &lt;chr&gt;          &lt;dbl&gt;          &lt;dbl&gt;      &lt;dbl&gt;
## 1 Paris              1          17443      17620
## 2 Paris              2          22927      23102
## 3 Lyon               1          28932      29874
## 4 Lyon               2          30575      31131</code></pre>
<p>Comment faire pour obtenir un tableau dans lequel chaque ligne donne la population, pour une ville, un arrondissement et indique si la valeur de la population concerne la population municipale ou totale ?</p>
<p>Il suffit d’utiliser <code>pivot_longer()</code> en précisant : pour l’argument <code>cols</code>, les variables contenant les valeurs que l’on veut avoir dans la colonne unique. Eventuellement, il est possible de préciser le nom de la colonne qui indiquera le nom des colonnes d’où viennent initialement les données, en le passant à l’argument <code>names_to</code> (par defaut : <code>name</code>). Il est également possible de préciser le nom de la colonne dans lesquelles les valeurs se trouveront en le passant à l’argument <code>values_to</code> (par defaut : <code>value</code>)</p>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb771-1"><a href="données.html#cb771-1" aria-hidden="true"></a>pop_long &lt;-<span class="st"> </span>pop <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb771-2"><a href="données.html#cb771-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(pop_municipale, pop_totale),</span>
<span id="cb771-3"><a href="données.html#cb771-3" aria-hidden="true"></a>               <span class="dt">values_to =</span> <span class="st">&quot;population&quot;</span>,</span>
<span id="cb771-4"><a href="données.html#cb771-4" aria-hidden="true"></a>               <span class="dt">names_to =</span> <span class="st">&quot;type_pop&quot;</span>)</span>
<span id="cb771-5"><a href="données.html#cb771-5" aria-hidden="true"></a>pop_long</span></code></pre></div>
<pre><code>## # A tibble: 8 x 4
##   ville arrondissement type_pop       population
##   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt;
## 1 Paris              1 pop_municipale      17443
## 2 Paris              1 pop_totale          17620
## 3 Paris              2 pop_municipale      22927
## 4 Paris              2 pop_totale          23102
## 5 Lyon               1 pop_municipale      28932
## 6 Lyon               1 pop_totale          29874
## 7 Lyon               2 pop_municipale      30575
## 8 Lyon               2 pop_totale          31131</code></pre>
<p>La fonction <code>pivot_wider()</code> permet d’effectuer l’opération dans l’autre sens. Les arguments <code>names_from</code> et <code>values_from</code> permettent de désigner où sont les noms qui définiront les colonnes du tableau large et les valeurs associées, respectivement.</p>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="données.html#cb773-1" aria-hidden="true"></a>pop_long <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb773-2"><a href="données.html#cb773-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> type_pop, <span class="dt">values_from =</span> population)</span></code></pre></div>
<pre><code>## # A tibble: 4 x 4
##   ville arrondissement pop_municipale pop_totale
##   &lt;chr&gt;          &lt;dbl&gt;          &lt;dbl&gt;      &lt;dbl&gt;
## 1 Paris              1          17443      17620
## 2 Paris              2          22927      23102
## 3 Lyon               1          28932      29874
## 4 Lyon               2          30575      31131</code></pre>
</div>
<div id="stacking-et-unstacking" class="section level4" number="2.4.6.10">
<h4><span class="header-section-number">2.4.6.10</span> Stacking et unstacking</h4>
<p>Pour empiler (stack) les contenus des colonnes d’un tableau de données dans un seul vecteur, R propose la fonction <code>stack()</code>. Le tableau de données retourné est composé de deux colonnes, dont la première contient les valeurs et la seconde le nom de la colonne dans le tableau de données initial. Pour réaliser l’opération inverse, on peut utiliser la fonction <code>unstack()</code>.</p>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="données.html#cb775-1" aria-hidden="true"></a>patients &lt;-<span class="st"> </span></span>
<span id="cb775-2"><a href="données.html#cb775-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">traitement_1 =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">7</span>),</span>
<span id="cb775-3"><a href="données.html#cb775-3" aria-hidden="true"></a>         <span class="dt">traitement_2 =</span> <span class="kw">c</span>(<span class="dv">8</span>, <span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb775-4"><a href="données.html#cb775-4" aria-hidden="true"></a>         <span class="dt">traitement_3 =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">6</span>))</span>
<span id="cb775-5"><a href="données.html#cb775-5" aria-hidden="true"></a>patients</span></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##   traitement_1 traitement_2 traitement_3
##          &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
## 1            4            8            0
## 2            2            5            5
## 3            7            0            6</code></pre>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="données.html#cb777-1" aria-hidden="true"></a><span class="kw">stack</span>(patients)</span></code></pre></div>
<pre><code>##   values          ind
## 1      4 traitement_1
## 2      2 traitement_1
## 3      7 traitement_1
## 4      8 traitement_2
## 5      5 traitement_2
## 6      0 traitement_2
## 7      0 traitement_3
## 8      5 traitement_3
## 9      6 traitement_3</code></pre>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="données.html#cb779-1" aria-hidden="true"></a><span class="kw">unstack</span>(<span class="kw">stack</span>(patients))</span></code></pre></div>
<pre><code>##   traitement_1 traitement_2 traitement_3
## 1            4            8            0
## 2            2            5            5
## 3            7            0            6</code></pre>
<p>Le <em>package</em> <code>tidyr</code> propose des fonctions intéressantes pour convertir des tableaux en longueur en tableaux en hauteur, et <code>vice versa</code>.</p>
</div>
</div>
<div id="data-tables" class="section level3" number="2.4.7">
<h3><span class="header-section-number">2.4.7</span> Data tables</h3>
<p>Comme brièvement indiqué précédemment (à la Section <a href="données.html#structures">2.2</a>), le <em>package</em> {<code>data.table</code>} propose une autre structure de données, appelée <em>data.table</em>, qui se veut être une alternative aux objets <em>tibbles</em> ou <em>data frames</em>. L’idée est de réduire la longueur du code, de proposer une syntatxe plus facile à écrire et lire, mais aussi (et surtout) de réduire les temps de calculs. La syntaxe se rapproche un peu du <code>SQL</code>, mais évite pas mal de lourdeurs de ce langage.</p>
<p>Il est plus pratique de charger le package_:</p>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb781-1"><a href="données.html#cb781-1" aria-hidden="true"></a><span class="kw">library</span>(data.table)</span></code></pre></div>
<div id="création-conversion" class="section level4" number="2.4.7.1">
<h4><span class="header-section-number">2.4.7.1</span> Création, conversion</h4>
<p>La création d’un <em>data.table</em> se fait de manière analogue à ce que l’on utilise pour un <em>tibble</em>, en faisant appel à la fonction <code>data.table()</code>.</p>
<div class="sourceCode" id="cb782"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb782-1"><a href="données.html#cb782-1" aria-hidden="true"></a>chomage &lt;-<span class="st"> </span></span>
<span id="cb782-2"><a href="données.html#cb782-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">data.table</span>(<span class="dt">region =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;Bretagne&quot;</span>, <span class="dv">4</span>), <span class="kw">rep</span>(<span class="st">&quot;Corse&quot;</span>, <span class="dv">2</span>)), <span class="dv">2</span>),</span>
<span id="cb782-3"><a href="données.html#cb782-3" aria-hidden="true"></a>             <span class="dt">departement =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Cotes-d&#39;Armor&quot;</span>, <span class="st">&quot;Finistere&quot;</span>,</span>
<span id="cb782-4"><a href="données.html#cb782-4" aria-hidden="true"></a>                                 <span class="st">&quot;Ille-et-Vilaine&quot;</span>, <span class="st">&quot;Morbihan&quot;</span>,</span>
<span id="cb782-5"><a href="données.html#cb782-5" aria-hidden="true"></a>                                 <span class="st">&quot;Corse-du-Sud&quot;</span>, <span class="st">&quot;Haute-Corse&quot;</span>), <span class="dv">2</span>), </span>
<span id="cb782-6"><a href="données.html#cb782-6" aria-hidden="true"></a>             <span class="dt">annee =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">2011</span>, <span class="dv">2010</span>), <span class="dt">each =</span> <span class="dv">6</span>),</span>
<span id="cb782-7"><a href="données.html#cb782-7" aria-hidden="true"></a>             <span class="dt">ouvriers =</span> <span class="kw">c</span>(<span class="dv">8738</span>, <span class="dv">12701</span>, <span class="dv">11390</span>, <span class="dv">10228</span>, <span class="dv">975</span>, <span class="dv">1297</span>,</span>
<span id="cb782-8"><a href="données.html#cb782-8" aria-hidden="true"></a>                          <span class="dv">8113</span>, <span class="dv">12258</span>, <span class="dv">10897</span>, <span class="dv">9617</span>, <span class="dv">936</span>, <span class="dv">1220</span>), </span>
<span id="cb782-9"><a href="données.html#cb782-9" aria-hidden="true"></a>             <span class="dt">ingenieurs =</span> <span class="kw">c</span>(<span class="dv">1420</span>, <span class="dv">2530</span>, <span class="dv">3986</span>, <span class="dv">2025</span>, <span class="dv">259</span>, <span class="dv">254</span>,</span>
<span id="cb782-10"><a href="données.html#cb782-10" aria-hidden="true"></a>                            <span class="dv">1334</span>, <span class="dv">2401</span>, <span class="dv">3776</span>, <span class="dv">1979</span>, <span class="dv">253</span>, <span class="dv">241</span>))</span>
<span id="cb782-11"><a href="données.html#cb782-11" aria-hidden="true"></a>chomage</span></code></pre></div>
<pre><code>##       region     departement annee ouvriers ingenieurs
##  1: Bretagne   Cotes-d&#39;Armor  2011     8738       1420
##  2: Bretagne       Finistere  2011    12701       2530
##  3: Bretagne Ille-et-Vilaine  2011    11390       3986
##  4: Bretagne        Morbihan  2011    10228       2025
##  5:    Corse    Corse-du-Sud  2011      975        259
##  6:    Corse     Haute-Corse  2011     1297        254
##  7: Bretagne   Cotes-d&#39;Armor  2010     8113       1334
##  8: Bretagne       Finistere  2010    12258       2401
##  9: Bretagne Ille-et-Vilaine  2010    10897       3776
## 10: Bretagne        Morbihan  2010     9617       1979
## 11:    Corse    Corse-du-Sud  2010      936        253
## 12:    Corse     Haute-Corse  2010     1220        241</code></pre>
<p>Il est facile de convertir un <em>tibble</em> en <code>data.table</code>, en faiant appel à la même fonction.</p>
<!-- % pop <- data.frame(departement = rep(c("Cotes-d'Armor", "Finistere", -->
<!-- %                                       "Ille-et-Vilaine", "Morbihan", -->
<!-- %                                       "Corse-du-Sud", "Haute-Corse"), 2), -->
<!-- %                   annee = rep(c(2011, 2010), each = 6), -->
<!-- %                   population = c(594375, 899870, 996439, 727083, -->
<!-- %                                  145846, 168640, 591641, 897628,  -->
<!-- %                                  988140, 721657, 143600, 166093)) -->
<div class="sourceCode" id="cb784"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb784-1"><a href="données.html#cb784-1" aria-hidden="true"></a>pop &lt;-<span class="st"> </span></span>
<span id="cb784-2"><a href="données.html#cb784-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">region =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Bretagne&quot;</span>, <span class="st">&quot;Alsace&quot;</span>), <span class="dt">each =</span> <span class="dv">2</span>),</span>
<span id="cb784-3"><a href="données.html#cb784-3" aria-hidden="true"></a>             <span class="dt">annee =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">2010</span>, <span class="dv">2011</span>), <span class="dv">2</span>),</span>
<span id="cb784-4"><a href="données.html#cb784-4" aria-hidden="true"></a>             <span class="dt">population =</span> <span class="kw">c</span>(<span class="dv">3199066</span>, <span class="dv">3217767</span>, <span class="dv">1845687</span>, <span class="dv">1852325</span>))</span>
<span id="cb784-5"><a href="données.html#cb784-5" aria-hidden="true"></a></span>
<span id="cb784-6"><a href="données.html#cb784-6" aria-hidden="true"></a>population &lt;-<span class="st"> </span><span class="kw">data.table</span>(pop)</span>
<span id="cb784-7"><a href="données.html#cb784-7" aria-hidden="true"></a>population</span></code></pre></div>
<pre><code>##      region annee population
## 1: Bretagne  2010    3199066
## 2: Bretagne  2011    3217767
## 3:   Alsace  2010    1845687
## 4:   Alsace  2011    1852325</code></pre>
<p>La fonction <code>tables()</code> donne un aperçu des <em>data.tables</em> en mémoire.</p>
<div class="sourceCode" id="cb786"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb786-1"><a href="données.html#cb786-1" aria-hidden="true"></a><span class="kw">tables</span>()</span></code></pre></div>
<pre><code>##          NAME NROW NCOL MB                                         COLS KEY
## 1:    chomage   12    5  0 region,departement,annee,ouvriers,ingenieurs    
## 2: population    4    3  0                      region,annee,population    
## Total: 0MB</code></pre>
<p>La fonction <code>as_tibble()</code> convertit les <em>data.table</em> en <em>tibble</em>, ce qui est essentiel, dans la mesure où certaines fonctions ne prennent en compte qu’un objet <em>tibble</em> ou <em>data.frame</em> en argument, et excluent toute autre structure.</p>
</div>
<div id="sélection-1" class="section level4" number="2.4.7.2">
<h4><span class="header-section-number">2.4.7.2</span> Sélection</h4>
<p>Comme pour un <em>tibble</em>, on peut accéder aux éléments par leur numéro de ligne. En revanche, l’accès par le numéro de colonne ne fonctionne pas comme avec une matrice ou un <em>tibble</em>.</p>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb788-1"><a href="données.html#cb788-1" aria-hidden="true"></a>chomage[<span class="dv">1</span>,]</span></code></pre></div>
<pre><code>##      region   departement annee ouvriers ingenieurs
## 1: Bretagne Cotes-d&#39;Armor  2011     8738       1420</code></pre>
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb790-1"><a href="données.html#cb790-1" aria-hidden="true"></a><span class="co"># Retourne un résultat pas forcément attendu</span></span>
<span id="cb790-2"><a href="données.html#cb790-2" aria-hidden="true"></a>chomage[,<span class="dv">1</span>]</span></code></pre></div>
<pre><code>##       region
##  1: Bretagne
##  2: Bretagne
##  3: Bretagne
##  4: Bretagne
##  5:    Corse
##  6:    Corse
##  7: Bretagne
##  8: Bretagne
##  9: Bretagne
## 10: Bretagne
## 11:    Corse
## 12:    Corse</code></pre>
<div class="sourceCode" id="cb792"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb792-1"><a href="données.html#cb792-1" aria-hidden="true"></a>chomage[<span class="dv">1</span>,<span class="dv">1</span>]</span></code></pre></div>
<pre><code>##      region
## 1: Bretagne</code></pre>
<p>Pour accéder aux valeurs dans les colonnes, il faut fournir le nom de la colonne, sans guillemets en second argument à la fonction <code>"[.data.table"()</code>. Pour choisir plusieurs colonnes, il faut placer le nom des variables, sans guillemets, dans une liste, et le fournir en second argument de la fonction <code>"[.data.table"()</code>.</p>
<div class="sourceCode" id="cb794"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb794-1"><a href="données.html#cb794-1" aria-hidden="true"></a>chomage[<span class="dv">1</span>,ouvriers]</span></code></pre></div>
<pre><code>## [1] 8738</code></pre>
<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb796-1"><a href="données.html#cb796-1" aria-hidden="true"></a>chomage[<span class="dv">1</span>, <span class="kw">list</span>(ouvriers, ingenieurs)]</span></code></pre></div>
<pre><code>##    ouvriers ingenieurs
## 1:     8738       1420</code></pre>
</div>
<div id="filtrage-1" class="section level4" number="2.4.7.3">
<h4><span class="header-section-number">2.4.7.3</span> Filtrage</h4>
<p>On peut extraire des sous parties du <em>data.table</em> à l’aide des opérateurs logiques qui scannent la totalité des données. Cependant, la Section <a href="données.html#manip-datatable-cles">2.4.7.5</a> propose un moyen beaucoup plus rapide, surtout avec des gros volumes de données, pour effectuer des recherches dans un <em>data.table</em>.</p>
<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb798-1"><a href="données.html#cb798-1" aria-hidden="true"></a>chomage[annee <span class="op">==</span><span class="st"> </span><span class="dv">2010</span> <span class="op">&amp;</span><span class="st"> </span>departement <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Finistere&quot;</span>, <span class="st">&quot;Morbihan&quot;</span>),</span>
<span id="cb798-2"><a href="données.html#cb798-2" aria-hidden="true"></a>        <span class="kw">list</span>(departement, ouvriers, annee)]</span></code></pre></div>
<pre><code>##    departement ouvriers annee
## 1:   Finistere    12258  2010
## 2:    Morbihan     9617  2010</code></pre>
</div>
<div id="retirer-les-valeurs-dupliquées-1" class="section level4" number="2.4.7.4">
<h4><span class="header-section-number">2.4.7.4</span> Retirer les valeurs dupliquées</h4>
<p>Il arrive parfois, après avoir effectué des opérations sur les tables, d’obtenir des duplications d’enregistrement. Comme pour les <em>data.frames</em> ou les <em>tibbles</em>, il faut se servir de la fonction <code>unique()</code> pour retirer les doublons. Attention, si le <em>data.table</em> possède une clé, il est nécessaire de la retirer avant d’appeler la fonction <code>unique()</code>.</p>
<div class="sourceCode" id="cb800"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb800-1"><a href="données.html#cb800-1" aria-hidden="true"></a><span class="co"># Les observations 1 et 7, ainsi que 3 et 6 sont dupliquées</span></span>
<span id="cb800-2"><a href="données.html#cb800-2" aria-hidden="true"></a>dt &lt;-<span class="st"> </span><span class="kw">data.table</span>(<span class="dt">x =</span> letters[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">1</span>)],</span>
<span id="cb800-3"><a href="données.html#cb800-3" aria-hidden="true"></a>                 <span class="dt">y =</span> letters[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>)])</span>
<span id="cb800-4"><a href="données.html#cb800-4" aria-hidden="true"></a></span>
<span id="cb800-5"><a href="données.html#cb800-5" aria-hidden="true"></a><span class="co"># setkey(dt, NULL)</span></span>
<span id="cb800-6"><a href="données.html#cb800-6" aria-hidden="true"></a><span class="kw">unique</span>(dt)</span></code></pre></div>
<pre><code>##    x y
## 1: a a
## 2: b e
## 3: c b
## 4: a d
## 5: d c</code></pre>
</div>
<div id="manip-datatable-cles" class="section level4" number="2.4.7.5">
<h4><span class="header-section-number">2.4.7.5</span> Clés</h4>
<p>Dans les bases de données relationnelles, la présence d’une clé primaire permet d’identifier chaque observation de la base. Celle-ci peut être composée d’un seul ou de plusieurs champs. Ici, avec les <em>data.table</em>, il en est à peu près de même. Une clé (<code>key</code>) peut être composée d’une seule ou de plusieurs variables (colonnes) du <em>data.table</em>, qui peuvent être de mode <code>factor</code>, <code>numeric</code>, <code>integer</code>, <code>character</code>, etc. Les lignes sont ordonnées en fonction de la clé, ce qui implique l’impossibilité d’avoir plusieurs clés. Les clés dupliquées sont autorisées.</p>
<p>Pour définir une clé, on peut utiliser la fonction <code>setkey()</code>.</p>
<div class="sourceCode" id="cb802"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb802-1"><a href="données.html#cb802-1" aria-hidden="true"></a><span class="kw">setkey</span>(chomage, departement)</span>
<span id="cb802-2"><a href="données.html#cb802-2" aria-hidden="true"></a><span class="kw">tables</span>()</span></code></pre></div>
<pre><code>##          NAME NROW NCOL MB                                         COLS
## 1:    chomage   12    5  0 region,departement,annee,ouvriers,ingenieurs
## 2:         dt    7    2  0                                          x,y
## 3: population    4    3  0                      region,annee,population
##            KEY
## 1: departement
## 2:            
## 3:            
## Total: 0MB</code></pre>
<p>Comme précisé plus haut, on peut voir à présent que le <em>data.table</em> a été ordonné en fonction de la clé.</p>
<div class="sourceCode" id="cb804"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb804-1"><a href="données.html#cb804-1" aria-hidden="true"></a>chomage</span></code></pre></div>
<pre><code>##       region     departement annee ouvriers ingenieurs
##  1:    Corse    Corse-du-Sud  2011      975        259
##  2:    Corse    Corse-du-Sud  2010      936        253
##  3: Bretagne   Cotes-d&#39;Armor  2011     8738       1420
##  4: Bretagne   Cotes-d&#39;Armor  2010     8113       1334
##  5: Bretagne       Finistere  2011    12701       2530
##  6: Bretagne       Finistere  2010    12258       2401
##  7:    Corse     Haute-Corse  2011     1297        254
##  8:    Corse     Haute-Corse  2010     1220        241
##  9: Bretagne Ille-et-Vilaine  2011    11390       3986
## 10: Bretagne Ille-et-Vilaine  2010    10897       3776
## 11: Bretagne        Morbihan  2011    10228       2025
## 12: Bretagne        Morbihan  2010     9617       1979</code></pre>
<p>On peut à présent faire référence à une valeur de la clé pour accéder à une information</p>
<div class="sourceCode" id="cb806"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb806-1"><a href="données.html#cb806-1" aria-hidden="true"></a>chomage[<span class="st">&quot;Finistere&quot;</span>,]</span></code></pre></div>
<pre><code>##      region departement annee ouvriers ingenieurs
## 1: Bretagne   Finistere  2011    12701       2530
## 2: Bretagne   Finistere  2010    12258       2401</code></pre>
<div class="sourceCode" id="cb808"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb808-1"><a href="données.html#cb808-1" aria-hidden="true"></a><span class="co"># On n&#39;est pas obligé de mettre la virgule</span></span>
<span id="cb808-2"><a href="données.html#cb808-2" aria-hidden="true"></a>chomage[<span class="st">&quot;Finistere&quot;</span>]</span></code></pre></div>
<pre><code>##      region departement annee ouvriers ingenieurs
## 1: Bretagne   Finistere  2011    12701       2530
## 2: Bretagne   Finistere  2010    12258       2401</code></pre>
<p>Comme on peut le voir, la clé <code>"departement"</code> est dupliqueée pour la valeur <code>"Finistere"</code>. De fait, deux observations sont retournées. Si on souhaite obtenir uniquement la première ou la dernière, on peut utiliser l’argument , en lui donnant respectivement la valeur <code>"first"</code> ou <code>"last"</code>.</p>
<div class="sourceCode" id="cb810"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb810-1"><a href="données.html#cb810-1" aria-hidden="true"></a>chomage[<span class="st">&quot;Finistere&quot;</span>, mult =<span class="st"> &quot;first&quot;</span>]</span></code></pre></div>
<pre><code>##      region departement annee ouvriers ingenieurs
## 1: Bretagne   Finistere  2011    12701       2530</code></pre>
<div class="sourceCode" id="cb812"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb812-1"><a href="données.html#cb812-1" aria-hidden="true"></a>chomage[<span class="st">&quot;Finistere&quot;</span>, mult =<span class="st"> &quot;last&quot;</span>]</span></code></pre></div>
<pre><code>##      region departement annee ouvriers ingenieurs
## 1: Bretagne   Finistere  2010    12258       2401</code></pre>
<p>La clé peut être composée de plusieurs variables, il faut utiliser la fonction <code>J()</code>.</p>
<div class="sourceCode" id="cb814"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb814-1"><a href="données.html#cb814-1" aria-hidden="true"></a><span class="kw">setkey</span>(chomage, region, departement)</span>
<span id="cb814-2"><a href="données.html#cb814-2" aria-hidden="true"></a><span class="kw">tables</span>()</span></code></pre></div>
<pre><code>##          NAME NROW NCOL MB                                         COLS
## 1:    chomage   12    5  0 region,departement,annee,ouvriers,ingenieurs
## 2:         dt    7    2  0                                          x,y
## 3: population    4    3  0                      region,annee,population
##                   KEY
## 1: region,departement
## 2:                   
## 3:                   
## Total: 0MB</code></pre>
<div class="sourceCode" id="cb816"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb816-1"><a href="données.html#cb816-1" aria-hidden="true"></a>chomage[<span class="st">&quot;Corse&quot;</span>]</span></code></pre></div>
<pre><code>##    region  departement annee ouvriers ingenieurs
## 1:  Corse Corse-du-Sud  2011      975        259
## 2:  Corse Corse-du-Sud  2010      936        253
## 3:  Corse  Haute-Corse  2011     1297        254
## 4:  Corse  Haute-Corse  2010     1220        241</code></pre>
<div class="sourceCode" id="cb818"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb818-1"><a href="données.html#cb818-1" aria-hidden="true"></a>chomage[<span class="kw">J</span>(<span class="st">&quot;Bretagne&quot;</span>, <span class="st">&quot;Finistere&quot;</span>)]</span></code></pre></div>
<pre><code>##      region departement annee ouvriers ingenieurs
## 1: Bretagne   Finistere  2011    12701       2530
## 2: Bretagne   Finistere  2010    12258       2401</code></pre>
<p>À l’heure de la rédaction de la première version de ces notes, il n’existait pas encore de moyen de faire une recherche par clé secondaire (cela semble être à présent possible, comme le montre <a href="https://cran.r-project.org/web/packages/data.table/vignettes/datatable-secondary-indices-and-auto-indexing.html">cette vignette du <em>package</em></a>). Il était cependant possible de contourner le problème en effectuant de nouveau l’opération de définition de clé.</p>
<div class="sourceCode" id="cb820"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb820-1"><a href="données.html#cb820-1" aria-hidden="true"></a><span class="co"># Pour rechercher les observations pour lesquelles le département</span></span>
<span id="cb820-2"><a href="données.html#cb820-2" aria-hidden="true"></a><span class="co"># est le Finistere, sans savoir que c&#39;est en Bretagne</span></span>
<span id="cb820-3"><a href="données.html#cb820-3" aria-hidden="true"></a></span>
<span id="cb820-4"><a href="données.html#cb820-4" aria-hidden="true"></a><span class="co"># Ne fonctionne pas</span></span>
<span id="cb820-5"><a href="données.html#cb820-5" aria-hidden="true"></a>chomage[<span class="st">&quot;Finistere&quot;</span>]</span></code></pre></div>
<pre><code>##       region departement annee ouvriers ingenieurs
## 1: Finistere        &lt;NA&gt;    NA       NA         NA</code></pre>
<div class="sourceCode" id="cb822"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb822-1"><a href="données.html#cb822-1" aria-hidden="true"></a><span class="kw">setkey</span>(chomage, departement)</span>
<span id="cb822-2"><a href="données.html#cb822-2" aria-hidden="true"></a>chomage[<span class="st">&quot;Finistere&quot;</span>]</span></code></pre></div>
<pre><code>##      region departement annee ouvriers ingenieurs
## 1: Bretagne   Finistere  2011    12701       2530
## 2: Bretagne   Finistere  2010    12258       2401</code></pre>
<div class="sourceCode" id="cb824"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb824-1"><a href="données.html#cb824-1" aria-hidden="true"></a><span class="co"># Retour à la clé précédente</span></span>
<span id="cb824-2"><a href="données.html#cb824-2" aria-hidden="true"></a><span class="kw">setkey</span>(chomage, region, departement)</span></code></pre></div>
</div>
<div id="modification-des-colonne" class="section level4" number="2.4.7.6">
<h4><span class="header-section-number">2.4.7.6</span> Modification des colonne</h4>
<p>Dans l’application de la fonction <code>"[.data.table"()</code> à un <em>data.table</em>, le deuxième argument peut être une ou plusieurs expressions dont les arguments sont les noms des colonnes du <em>data.table</em>, sans les guillemets.</p>
<p>Si on souhaite ajouter une nouvelle variable dans le <em>data.table</em>, on peut le faire avec le symbole d’assignation, ou bien en utilisant le symbole <code>:=</code>.</p>
<div class="sourceCode" id="cb825"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb825-1"><a href="données.html#cb825-1" aria-hidden="true"></a>chomage[, a <span class="op">:</span><span class="er">=</span><span class="st"> </span>letters[<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>]]</span>
<span id="cb825-2"><a href="données.html#cb825-2" aria-hidden="true"></a><span class="co"># Equivalent de </span></span>
<span id="cb825-3"><a href="données.html#cb825-3" aria-hidden="true"></a><span class="co"># chomage$temp &lt;- letters[1:12]</span></span></code></pre></div>
<p>L’ajout d’une nouvelle variable à partir des valeurs contenues dans le <em>data.table</em> est un peu plus subtil. Il faut utiliser le symbole <code>:=</code> et il n’est plus possible d’utiliser la flèche <code>&lt;-</code>.</p>
<div class="sourceCode" id="cb826"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb826-1"><a href="données.html#cb826-1" aria-hidden="true"></a>chomage[, b <span class="op">:</span><span class="er">=</span><span class="st"> </span>ouvriers <span class="op">+</span><span class="st"> </span>ingenieurs]</span></code></pre></div>
<p>L’ajout de plusieurs variables possède un syntaxe un peu moins intuitive.</p>
<div class="sourceCode" id="cb827"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb827-1"><a href="données.html#cb827-1" aria-hidden="true"></a>chomage[, <span class="st">&quot;:=&quot;</span> (<span class="dt">c =</span> ouvriers<span class="op">/</span><span class="dv">100</span>, <span class="dt">d =</span> <span class="kw">paste0</span>(a,b))]</span></code></pre></div>
<p>Une fonctionnalité pratique est qu’il est possible de définir une variable et de la réutiliser directement après sa définition.</p>
<div class="sourceCode" id="cb828"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb828-1"><a href="données.html#cb828-1" aria-hidden="true"></a>chomage[, <span class="kw">c</span>(<span class="st">&quot;e&quot;</span>, <span class="st">&quot;f&quot;</span>) <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">list</span>(tmp &lt;-<span class="st"> </span>ouvriers <span class="op">+</span><span class="st"> </span>ingenieurs,</span>
<span id="cb828-2"><a href="données.html#cb828-2" aria-hidden="true"></a>                              <span class="kw">round</span>(<span class="kw">sqrt</span>(tmp)))]</span></code></pre></div>
<p>La suppression se fait avec <code>NULL</code>, et il faut placer le nom des variables entouré de guillemets dans un vecteur.</p>
<div class="sourceCode" id="cb829"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb829-1"><a href="données.html#cb829-1" aria-hidden="true"></a><span class="co"># Suppression de plusieurs colonnes</span></span>
<span id="cb829-2"><a href="données.html#cb829-2" aria-hidden="true"></a>chomage[, <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;e&quot;</span>) <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="ot">NULL</span>]</span>
<span id="cb829-3"><a href="données.html#cb829-3" aria-hidden="true"></a></span>
<span id="cb829-4"><a href="données.html#cb829-4" aria-hidden="true"></a><span class="co"># Suppression d&#39;une seule colonne</span></span>
<span id="cb829-5"><a href="données.html#cb829-5" aria-hidden="true"></a>chomage[, f <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="ot">NULL</span>]</span></code></pre></div>
</div>
<div id="tri-1" class="section level4" number="2.4.7.7">
<h4><span class="header-section-number">2.4.7.7</span> Tri</h4>
<p>Lorsqu’une clé est définie, les enregistrement du <em>data.table</em> sont triés en fonction de cette clé. Si la clé contient plusieurs noms de colonnes, par exemple <code>var_1, var_2,</code> etc., le tri s’effectue d’abord par la première variable (<code>var_1</code>), puis la seconde (<code>var_2</code>), etc.</p>
<p>Il est possible de forcer le tri sur une autre variable, ou plusieurs autres.</p>
<div class="sourceCode" id="cb830"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb830-1"><a href="données.html#cb830-1" aria-hidden="true"></a><span class="kw">head</span>(chomage[<span class="kw">order</span>(annee)])</span></code></pre></div>
<pre><code>##      region     departement annee ouvriers ingenieurs
## 1: Bretagne   Cotes-d&#39;Armor  2010     8113       1334
## 2: Bretagne       Finistere  2010    12258       2401
## 3: Bretagne Ille-et-Vilaine  2010    10897       3776
## 4: Bretagne        Morbihan  2010     9617       1979
## 5:    Corse    Corse-du-Sud  2010      936        253
## 6:    Corse     Haute-Corse  2010     1220        241</code></pre>
</div>
<div id="copie-de-data.tables" class="section level4" number="2.4.7.8">
<h4><span class="header-section-number">2.4.7.8</span> Copie de <em>data.tables</em></h4>
<p>Attention, pour copier un <em>data.table</em>, il faut utiliser la fonction <code>copy()</code> ! En effet, la flèche d’assignation ne réalise pas la création d’une nouvelle variable dont le contenu est désigné par le bout de la flèche, elle réalise une référence.</p>
<div class="sourceCode" id="cb832"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb832-1"><a href="données.html#cb832-1" aria-hidden="true"></a>dt &lt;-<span class="st"> </span><span class="kw">data.table</span>(<span class="dt">x =</span> letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="dt">y =</span> <span class="dv">4</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb832-2"><a href="données.html#cb832-2" aria-hidden="true"></a>dt</span></code></pre></div>
<pre><code>##    x y
## 1: a 4
## 2: b 5
## 3: c 6</code></pre>
<div class="sourceCode" id="cb834"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb834-1"><a href="données.html#cb834-1" aria-hidden="true"></a><span class="co"># Référence</span></span>
<span id="cb834-2"><a href="données.html#cb834-2" aria-hidden="true"></a>dt_ref &lt;-<span class="st"> </span>dt</span>
<span id="cb834-3"><a href="données.html#cb834-3" aria-hidden="true"></a></span>
<span id="cb834-4"><a href="données.html#cb834-4" aria-hidden="true"></a><span class="co"># Copie</span></span>
<span id="cb834-5"><a href="données.html#cb834-5" aria-hidden="true"></a>dt_copie &lt;-<span class="st"> </span><span class="kw">copy</span>(dt)</span>
<span id="cb834-6"><a href="données.html#cb834-6" aria-hidden="true"></a></span>
<span id="cb834-7"><a href="données.html#cb834-7" aria-hidden="true"></a><span class="co"># Ajoutons une variable</span></span>
<span id="cb834-8"><a href="données.html#cb834-8" aria-hidden="true"></a>dt[, a <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">3</span>)]</span>
<span id="cb834-9"><a href="données.html#cb834-9" aria-hidden="true"></a>dt_ref[, z <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">paste0</span>(x,y)]</span>
<span id="cb834-10"><a href="données.html#cb834-10" aria-hidden="true"></a>dt_copie[, t <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">paste0</span>(y,x)]</span>
<span id="cb834-11"><a href="données.html#cb834-11" aria-hidden="true"></a></span>
<span id="cb834-12"><a href="données.html#cb834-12" aria-hidden="true"></a><span class="co"># Les variables &quot;a&quot; et &quot;z&quot; ont été ajoutées à dt et dt_ref</span></span>
<span id="cb834-13"><a href="données.html#cb834-13" aria-hidden="true"></a><span class="co"># sans impacter dt_copie</span></span>
<span id="cb834-14"><a href="données.html#cb834-14" aria-hidden="true"></a><span class="co"># La variable &quot;t&quot; n&#39;a été ajoutée qu&#39;à dt_copie</span></span>
<span id="cb834-15"><a href="données.html#cb834-15" aria-hidden="true"></a>dt</span></code></pre></div>
<pre><code>##    x y a  z
## 1: a 4 1 a4
## 2: b 5 1 b5
## 3: c 6 1 c6</code></pre>
<div class="sourceCode" id="cb836"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb836-1"><a href="données.html#cb836-1" aria-hidden="true"></a>dt_ref</span></code></pre></div>
<pre><code>##    x y a  z
## 1: a 4 1 a4
## 2: b 5 1 b5
## 3: c 6 1 c6</code></pre>
<div class="sourceCode" id="cb838"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb838-1"><a href="données.html#cb838-1" aria-hidden="true"></a>dt_copie</span></code></pre></div>
<pre><code>##    x y  t
## 1: a 4 4a
## 2: b 5 5b
## 3: c 6 6c</code></pre>
<div class="sourceCode" id="cb840"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb840-1"><a href="données.html#cb840-1" aria-hidden="true"></a><span class="co"># En revanche, la suppression de dt_ref ne supprime pas dt</span></span>
<span id="cb840-2"><a href="données.html#cb840-2" aria-hidden="true"></a><span class="kw">rm</span>(dt_ref)</span>
<span id="cb840-3"><a href="données.html#cb840-3" aria-hidden="true"></a>dt</span></code></pre></div>
<pre><code>##    x y a  z
## 1: a 4 1 a4
## 2: b 5 1 b5
## 3: c 6 1 c6</code></pre>
</div>
<div id="jointures-1" class="section level4" number="2.4.7.9">
<h4><span class="header-section-number">2.4.7.9</span> Jointures</h4>
<p>Pour réaliser une jointure, on peut utiliser la fonction <code>merge()</code> (bien que non présentée dans ces notes, cette fonction s’applique aussi aux <em>tibbles</em>). Le <em>package</em> {<code>data.table</code>} fournit d’autres méthodes, plus rapides, en passant, encore une fois, par la fonction <code>"[.data.frame"()</code>. La manière la plus simple, pour ne pas faire d’erreur lors de la jointure, est de définir en clé les variables communes aux deux tables.</p>
<div class="sourceCode" id="cb842"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb842-1"><a href="données.html#cb842-1" aria-hidden="true"></a><span class="kw">setkey</span>(chomage, region, annee)</span>
<span id="cb842-2"><a href="données.html#cb842-2" aria-hidden="true"></a><span class="kw">setkey</span>(population, region, annee)</span>
<span id="cb842-3"><a href="données.html#cb842-3" aria-hidden="true"></a>chomage[population]</span></code></pre></div>
<pre><code>##       region     departement annee ouvriers ingenieurs population
##  1:   Alsace            &lt;NA&gt;  2010       NA         NA    1845687
##  2:   Alsace            &lt;NA&gt;  2011       NA         NA    1852325
##  3: Bretagne   Cotes-d&#39;Armor  2010     8113       1334    3199066
##  4: Bretagne       Finistere  2010    12258       2401    3199066
##  5: Bretagne Ille-et-Vilaine  2010    10897       3776    3199066
##  6: Bretagne        Morbihan  2010     9617       1979    3199066
##  7: Bretagne   Cotes-d&#39;Armor  2011     8738       1420    3217767
##  8: Bretagne       Finistere  2011    12701       2530    3217767
##  9: Bretagne Ille-et-Vilaine  2011    11390       3986    3217767
## 10: Bretagne        Morbihan  2011    10228       2025    3217767</code></pre>
<p>On peut le voir, la jointure réalisée est de type <em>Right Join</em>, c’est à dire que tous les éléments de la seconde table sont présents, mais que seuls ceux de la première à l’intersection avec la seconde sont conservés (on note que les observations concernant la Corse ont disparues). Les diagrammes suivants donnent les autres fusions possibles. On peut remarquer que le <em>Full Outer Join</em> n’est pas possible avec la fonction <code>"[.data.frame"()</code>.</p>
<div class="sourceCode" id="cb844"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb844-1"><a href="données.html#cb844-1" aria-hidden="true"></a>p</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-73-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>L’avantage, outre le temps gagné lorsqu’on a de gros volumes de données, d’utiliser <code>"[.data.frame"()</code> plutôt que <code>merge()</code>, est aussi qu’il est possible de faire une opération juste après la jointure. On gagne à la fois en temps d’exécution, et en lignes de codes, ainsi qu’en clarté de lecture.</p>
<div class="sourceCode" id="cb845"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb845-1"><a href="données.html#cb845-1" aria-hidden="true"></a>chomage[population][,<span class="kw">round</span>((ouvriers <span class="op">+</span><span class="st"> </span>ingenieurs)<span class="op">/</span>population<span class="op">*</span><span class="dv">100</span>, <span class="dv">2</span>)]</span></code></pre></div>
<pre><code>##  [1]   NA   NA 0.30 0.46 0.46 0.36 0.32 0.47 0.48 0.38</code></pre>
<div class="sourceCode" id="cb847"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb847-1"><a href="données.html#cb847-1" aria-hidden="true"></a>chomage[population,</span>
<span id="cb847-2"><a href="données.html#cb847-2" aria-hidden="true"></a>        <span class="kw">list</span>(<span class="dt">tmp =</span> <span class="kw">round</span>((ouvriers <span class="op">+</span><span class="st"> </span>ingenieurs)<span class="op">/</span>population<span class="op">*</span><span class="dv">100</span>, <span class="dv">2</span>), departement)]</span></code></pre></div>
<pre><code>##      tmp     departement
##  1:   NA            &lt;NA&gt;
##  2:   NA            &lt;NA&gt;
##  3: 0.30   Cotes-d&#39;Armor
##  4: 0.46       Finistere
##  5: 0.46 Ille-et-Vilaine
##  6: 0.36        Morbihan
##  7: 0.32   Cotes-d&#39;Armor
##  8: 0.47       Finistere
##  9: 0.48 Ille-et-Vilaine
## 10: 0.38        Morbihan</code></pre>
<p>Il arrive d’avoir à joindre des <em>data.table</em> en les empilant, par lignes. Une manière de faire passe par un simple appel à la fonction <code>do.call()</code>, avec en premier argument la fonction <code>rbind()</code>. Cela dit, cette méthode peut s’avérer prendre beaucoup de temps. La fonction <code>rbindlist()</code> propose de joindre par les lignes des tables de manière très rapide, à condition d’avoir les différentes parties à coller placées dans une liste.</p>
<div class="sourceCode" id="cb849"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb849-1"><a href="données.html#cb849-1" aria-hidden="true"></a>l &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="cf">function</span>(x) <span class="kw">data.table</span>(<span class="dt">valeur =</span> x, <span class="dt">lettre =</span> LETTERS[x]))</span>
<span id="cb849-2"><a href="données.html#cb849-2" aria-hidden="true"></a>res1 &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="st">&quot;rbind&quot;</span>, l)</span>
<span id="cb849-3"><a href="données.html#cb849-3" aria-hidden="true"></a>res2 &lt;-<span class="st"> </span><span class="kw">rbindlist</span>(l)</span>
<span id="cb849-4"><a href="données.html#cb849-4" aria-hidden="true"></a></span>
<span id="cb849-5"><a href="données.html#cb849-5" aria-hidden="true"></a>res2</span></code></pre></div>
<pre><code>##    valeur lettre
## 1:      1      A
## 2:      2      B
## 3:      3      C</code></pre>
<div class="sourceCode" id="cb851"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb851-1"><a href="données.html#cb851-1" aria-hidden="true"></a><span class="kw">all.equal</span>(res1, res2)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="agrégation-1" class="section level4" number="2.4.7.10">
<h4><span class="header-section-number">2.4.7.10</span> Agrégation</h4>
<p>Pour obtenir le résultat d’une fonction appliquée à toute une colonne, il faut travailler avec le second argument de la fonction <code>"[.data.table"()</code>.</p>
<div class="sourceCode" id="cb853"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb853-1"><a href="données.html#cb853-1" aria-hidden="true"></a>chomage[, <span class="kw">mean</span>(ouvriers)]</span></code></pre></div>
<pre><code>## [1] 7364.167</code></pre>
<p>Si on souhaite effectuer des regroupements, il faut rajouter l’argument <code>by</code> et lui atribuer le nom de la colonne (sans guillemets). Si le regroupement doit s’effectuer selon plusieurs colonnes, il faut alors envelopper les noms séparés par des virgules (mais sans espace) par des guillemets. On peut également fournir la liste des noms dans une liste, ce qui est un peu plus souple.</p>
<div class="sourceCode" id="cb855"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb855-1"><a href="données.html#cb855-1" aria-hidden="true"></a>chomage[, <span class="kw">mean</span>(ouvriers), by =<span class="st"> </span>region]</span></code></pre></div>
<pre><code>##      region       V1
## 1: Bretagne 10492.75
## 2:    Corse  1107.00</code></pre>
<div class="sourceCode" id="cb857"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb857-1"><a href="données.html#cb857-1" aria-hidden="true"></a>chomage[, <span class="kw">mean</span>(ouvriers), by =<span class="st"> &quot;region,departement&quot;</span>]</span></code></pre></div>
<pre><code>##      region     departement      V1
## 1: Bretagne   Cotes-d&#39;Armor  8425.5
## 2: Bretagne       Finistere 12479.5
## 3: Bretagne Ille-et-Vilaine 11143.5
## 4: Bretagne        Morbihan  9922.5
## 5:    Corse    Corse-du-Sud   955.5
## 6:    Corse     Haute-Corse  1258.5</code></pre>
<div class="sourceCode" id="cb859"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb859-1"><a href="données.html#cb859-1" aria-hidden="true"></a><span class="co"># Fournit le même résultat</span></span>
<span id="cb859-2"><a href="données.html#cb859-2" aria-hidden="true"></a><span class="co"># chomage[, mean(ouvriers), by = list(region, departement)]</span></span></code></pre></div>
<p>Il est possible d’effectuer des calculs sur plusieurs des colonnes du <em>data.table</em>. Pour ce faire, il faut placer le second argument de la fonction <code>"[.data.table"()</code> dans une liste. Si on souhaite donner des noms aux variables issues du calcul, c’est possible. Attention, il faut bien être dans une liste pour attribuer le nom !</p>
<div class="sourceCode" id="cb860"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb860-1"><a href="données.html#cb860-1" aria-hidden="true"></a>chomage[, <span class="kw">list</span>(<span class="kw">mean</span>(ouvriers), <span class="kw">sd</span>(ouvriers)), by =<span class="st"> </span>region]</span></code></pre></div>
<pre><code>##      region       V1        V2
## 1: Bretagne 10492.75 1627.4581
## 2:    Corse  1107.00  178.4507</code></pre>
<div class="sourceCode" id="cb862"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb862-1"><a href="données.html#cb862-1" aria-hidden="true"></a><span class="co"># Ne permet pas d&#39;attribuer le nom &quot;moyenne&quot; au calcul</span></span>
<span id="cb862-2"><a href="données.html#cb862-2" aria-hidden="true"></a>chomage[, moyenne =<span class="st"> </span><span class="kw">mean</span>(ouvriers), by =<span class="st"> </span>region]</span></code></pre></div>
<pre><code>## Error in `[.data.table`(chomage, , moyenne = mean(ouvriers), by = region): argument inutilisé (moyenne = mean(ouvriers))</code></pre>
<div class="sourceCode" id="cb864"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb864-1"><a href="données.html#cb864-1" aria-hidden="true"></a><span class="co"># Il faut être dans une liste</span></span>
<span id="cb864-2"><a href="données.html#cb864-2" aria-hidden="true"></a>chomage[, <span class="kw">list</span>(<span class="dt">moyenne =</span> <span class="kw">mean</span>(ouvriers)), by =<span class="st"> </span>region]</span></code></pre></div>
<pre><code>##      region  moyenne
## 1: Bretagne 10492.75
## 2:    Corse  1107.00</code></pre>
<p>Les opérations de regroupement sont beaucoup plus rapides qu’avec les <em>tibbles</em> ou les <em>data.frames</em> (à condition d’avoir des volumes de données larges).</p>
<p>Par ailleurs, on peut effectuer plusieurs opérations d’un coup, qui dépendent des résultats précédents, en utilisant à nouveau la fonction <code>"[.data.table"()</code>.</p>
<div class="sourceCode" id="cb866"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb866-1"><a href="données.html#cb866-1" aria-hidden="true"></a><span class="co"># Créons un data.table immense (presque 7 millions d&#39;obs.)</span></span>
<span id="cb866-2"><a href="données.html#cb866-2" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb866-3"><a href="données.html#cb866-3" aria-hidden="true"></a>dt &lt;-<span class="st"> </span><span class="kw">data.table</span>(<span class="dt">x =</span> <span class="kw">rep</span>(letters, <span class="dt">each =</span> <span class="dv">26</span><span class="op">*</span>n),</span>
<span id="cb866-4"><a href="données.html#cb866-4" aria-hidden="true"></a>                 <span class="dt">y =</span> <span class="kw">rep</span>(LETTERS, <span class="dt">each =</span> n),</span>
<span id="cb866-5"><a href="données.html#cb866-5" aria-hidden="true"></a>                 <span class="dt">z =</span> <span class="kw">runif</span>(n<span class="op">*</span><span class="dv">26</span><span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb866-6"><a href="données.html#cb866-6" aria-hidden="true"></a></span>
<span id="cb866-7"><a href="données.html#cb866-7" aria-hidden="true"></a><span class="kw">nrow</span>(dt)</span></code></pre></div>
<pre><code>## [1] 6760000</code></pre>
<div class="sourceCode" id="cb868"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb868-1"><a href="données.html#cb868-1" aria-hidden="true"></a><span class="co"># Après avoir calculé la moyenne de z pour chaque groupe</span></span>
<span id="cb868-2"><a href="données.html#cb868-2" aria-hidden="true"></a><span class="co"># défini par les valeurs de x et y,</span></span>
<span id="cb868-3"><a href="données.html#cb868-3" aria-hidden="true"></a><span class="co"># on ne conserve que les observations pour lesquelles la moyenne</span></span>
<span id="cb868-4"><a href="données.html#cb868-4" aria-hidden="true"></a><span class="co"># fraîchement créée est supérieure à 0.5</span></span>
<span id="cb868-5"><a href="données.html#cb868-5" aria-hidden="true"></a>dt[, <span class="kw">list</span>(<span class="dt">moy =</span> <span class="kw">mean</span>(z)), by =<span class="st"> &quot;x,y&quot;</span>][moy <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>]</span></code></pre></div>
<pre><code>##      x y       moy
##   1: a A 0.5036390
##   2: a C 0.5022083
##   3: a D 0.5020739
##   4: a F 0.5038780
##   5: a G 0.5021524
##  ---              
## 341: z T 0.5042550
## 342: z U 0.5021042
## 343: z W 0.5007926
## 344: z X 0.5033114
## 345: z Y 0.5026904</code></pre>
<!-- %' % . . . . . . . . . % -->
<!-- %' \subsubsection{Importation}\label{sec:manip_datatable_importation} -->
<!-- %' % . . . . . . . . . % -->
<!-- %'  -->
<!-- %' La fonction \afun{fread()} du _package_ \texttt{data.table} fonctionne de manière similaire à la fonction \afun{read.table()} du _package_ \texttt{base} (voir section~Ref{sec:donnees_import_export_crea_importation_read}), mais elle est beaucoup plus adaptée pour des volumes de données plus importants. Les séparateurs, les classes et le nombre de lignes sont automatiquement détectés. à l'heure de l'écriture du document, la fonction est encore en cours de développement.\\ -->
<!-- %'  -->
<!-- %' La plupart du temps, pour lire un fichier (admettions qu'il se nomme \texttt{"monfichier.csv"}), il suffit de donner ce nom à l'argument \texttt{input}. -->
<!-- %' <<manip_datatable_importation, eval = FALSE>>= -->
<!-- %' dt <- fread("monfichier.csv") -->
<!-- %' @ -->
<!-- %'  -->
<!-- %' Même s'il existe une reconnaissance automatique des séparateurs, des classes et du nombre de lignes, il est possible de forcer la valeur des arguments \texttt{sep}, \texttt{colClasses} et \texttt{nrows}. Le lecteur ou la lectrice est invité•e à consulter la page d'aide \texttt{?fread()} pour plus de détails. -->
</div>
</div>
<div id="quelques-fonctions-utiles" class="section level3" number="2.4.8">
<h3><span class="header-section-number">2.4.8</span> Quelques fonctions utiles</h3>
<p>Le tableau ci-dessous répertorie quelques fonctions de base qu’il est bon de connaître pour manipuler les données dans R.</p>
<table>
<colgroup>
<col width="43%" />
<col width="56%" />
</colgroup>
<thead>
<tr class="header">
<th>Fonction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>x%%y</code></td>
<td>Modulo</td>
</tr>
<tr class="even">
<td><code>x%/%y</code></td>
<td>Division entière</td>
</tr>
<tr class="odd">
<td><code>ceiling(x)</code></td>
<td>Plus petits entier supérieur ou égal à <code>x</code></td>
</tr>
<tr class="even">
<td><code>floor(x)</code></td>
<td>Plus petits entier inférieur ou égal à <code>x</code></td>
</tr>
<tr class="odd">
<td><code>round(x, digits)</code></td>
<td>Arrondi de <code>x</code> à digits décimales près</td>
</tr>
<tr class="even">
<td><code>signif(x, digits)</code></td>
<td>Arrondi de <code>x</code> à digits chiffres significatifs</td>
</tr>
<tr class="odd">
<td><code>trunc(x)</code></td>
<td>Partie entière de <code>x</code></td>
</tr>
<tr class="even">
<td><code>abs(x)</code></td>
<td>Valeur absolue de <code>x</code></td>
</tr>
<tr class="odd">
<td><code>cor(x)</code></td>
<td>Matrice de corrélations, si <code>x</code> est une matrice ou une data frame</td>
</tr>
<tr class="even">
<td><code>cor(x, y)</code></td>
<td>Corrélation linéaire entre <code>x</code> et <code>y</code>, ou matrice de corrélations si <code>x</code> et <code>y</code> sont des matrices ou des data frames</td>
</tr>
<tr class="odd">
<td><code>cummax(x)</code></td>
<td>Vecteur dont le ie élément est le maximum des éléments de <code>x[1]</code> à <code>x[i]</code></td>
</tr>
<tr class="even">
<td><code>cummin(x)</code></td>
<td>Vecteur dont le ie élément est le minimum des éléments de <code>x[1]</code> à <code>x[i]</code></td>
</tr>
<tr class="odd">
<td><code>cumprod(x)</code></td>
<td>Vecteur dont le ie élément est le produit des éléments <code>x[1]</code> à <code>x[i]</code></td>
</tr>
<tr class="even">
<td><code>cumsum(x)</code></td>
<td>Vecteur dont le ie élément est la somme des éléments de <code>x[1]</code> à <code>x[i]</code></td>
</tr>
<tr class="odd">
<td><code>exp(x)</code></td>
<td>Exponentielle de <code>x</code></td>
</tr>
<tr class="even">
<td><code>log(x, base)</code></td>
<td>Logarithme de <code>x</code>, avec <code>base=10</code> par défaut</td>
</tr>
<tr class="odd">
<td><code>max(..., na.rm)</code></td>
<td>Maximum du premier argument (peut être de type <code>numeric</code>, <code>logical</code> ou <code>character</code>. Si <code>na.rm = TRUE</code>, omet les valeurs non disponibles</td>
</tr>
<tr class="even">
<td><code>mean(x, na.rm, trim)</code></td>
<td>Moyenne de <code>x</code>. Si <code>na.rm = TRUE</code>, omet les valeurs non disponibles. L’argument <code>trim</code>, compris entre 0 (par défaut) et 0.5 indique la fraction d’observations à retirer de chaque côté de <code>x</code> avant de calculer la moyenne des observations restantes</td>
</tr>
<tr class="odd">
<td><code>median(x, na.rm)</code></td>
<td>Médiane de <code>x</code>. Si <code>na.rm = TRUE</code>, omet les valeurs non disponibles</td>
</tr>
<tr class="even">
<td><code>min(..., na.rm)</code></td>
<td>Minimum du premier argument (peut être de type <code>numeric</code>, <code>logical</code> ou <code>character</code>. Si <code>na.rm = TRUE</code>, omet les valeurs non disponibles</td>
</tr>
<tr class="odd">
<td><code>prod(..., na.rm)</code></td>
<td>Produit des éléments du premier argument (peut être de type <code>numeric</code>, <code>logical</code> ou <code>complex</code>. Si <code>na.rm = TRUE</code>, omet les valeurs non disponibles</td>
</tr>
<tr class="even">
<td><code>quantile(x, probs, na.rm)</code></td>
<td>Fractiles empiriques de <code>x</code> d’ordre <code>probs</code>. Si <code>na.rm = TRUE</code>, omet les valeurs non disponibles.</td>
</tr>
<tr class="odd">
<td><code>range(..., na.rm, finite)</code></td>
<td>Étendue du premier argument (peut être de type <code>numeric</code>, <code>logical</code> ou <code>character</code>. Si <code>na.rm = TRUE</code>, omet les valeurs non disponibles. Si <code>finite = TRUE</code>, les éléments non-finis sont omis.</td>
</tr>
<tr class="even">
<td><code>sd(x, na.rm)</code></td>
<td>Écart-type de <code>x</code>. Si <code>na.rm = TRUE</code>, omet les valeurs non disponibles</td>
</tr>
<tr class="odd">
<td><code>sign(x)</code></td>
<td>Signe de <code>x</code></td>
</tr>
<tr class="even">
<td><code>sqrt(x)</code></td>
<td>Racine carrée de <code>x</code></td>
</tr>
<tr class="odd">
<td><code>sum(..., na.rm)</code></td>
<td>Somme du premier argument (peut être de type <code>numeric</code>, <code>logical</code> ou <code>complex</code>. Si <code>na.rm = TRUE</code>, omet les valeurs non disponibles.</td>
</tr>
<tr class="even">
<td><code>var(x, na.rm)</code> ou <code>cov(x)</code></td>
<td>Variance corrigée de <code>x</code> (division par <code>n - 1</code> et non <code>n</code>). Si <code>na.rm = TRUE</code>, omet les valeurs non disponibles. Si <code>x</code> est une matrice ou un data frame, le résultat est la matrice de variance-covariance</td>
</tr>
<tr class="odd">
<td><code>var(x, y, na.rm)</code> ou <code>cov(x, y)</code></td>
<td>Covariance entre <code>x</code> et <code>y</code>, ou, dans le cas où <code>x</code> et <code>y</code> sont des matrices ou des data frames, entre les colonnes de <code>x</code> et <code>y</code>. Si <code>na.rm = TRUE</code>, omet les valeurs non disponibles</td>
</tr>
<tr class="even">
<td><code>sin(x)</code></td>
<td>Sinus de <code>x</code></td>
</tr>
<tr class="odd">
<td><code>cos(x)</code></td>
<td>Cosinus de <code>x</code></td>
</tr>
<tr class="even">
<td><code>tan(x)</code></td>
<td>Tangente de <code>x</code></td>
</tr>
<tr class="odd">
<td><code>asin(x)</code></td>
<td>Arc-sinus de <code>x</code></td>
</tr>
<tr class="even">
<td><code>acos(x)</code></td>
<td>Arc-cosinus de <code>x</code></td>
</tr>
<tr class="odd">
<td><code>atan(x)</code></td>
<td>Arc-tangente de <code>x</code></td>
</tr>
<tr class="even">
<td><code>sinh(x)</code></td>
<td>Sinus hyperbolique de <code>x</code></td>
</tr>
<tr class="odd">
<td><code>cosh(x)</code></td>
<td>Cosinus hyperbolique de <code>x</code></td>
</tr>
<tr class="even">
<td><code>tanh(x)</code></td>
<td>Tangente hyperbolique de <code>x</code></td>
</tr>
<tr class="odd">
<td><code>asinh(x)</code></td>
<td>Arc-sinus hyperbolique de <code>x</code></td>
</tr>
<tr class="even">
<td><code>acosh(x)</code></td>
<td>Arc-cosinus hyperbolique de <code>x</code></td>
</tr>
<tr class="odd">
<td><code>atanh(x)</code></td>
<td>Arc-tangente hyperbolique de <code>x</code></td>
</tr>
<tr class="even">
<td><code>factorial(x)</code></td>
<td>Factorielle de <code>x</code></td>
</tr>
<tr class="odd">
<td><code>choose(n, k)</code></td>
<td>Coeffcient binomial <span class="math inline">\(C_n^k\)</span></td>
</tr>
<tr class="even">
<td><code>any(x, na.rm)</code></td>
<td>Indique si au moins un élément de <code>x</code> vaut <code>TRUE</code>. Si <code>na.rm = TRUE</code>, omet les valeurs non disponibles</td>
</tr>
<tr class="odd">
<td><code>duplicated(x, fromLast)</code></td>
<td>Indique les éléments de <code>x</code> qui commencent à être dupliqués. Si <code>fromLast = TRUE</code>, le calcul est effectué de droite à gauche</td>
</tr>
<tr class="even">
<td><code>head(x, n)</code></td>
<td>Vecteur des <code>n</code> premières valeurs de <code>x</code></td>
</tr>
<tr class="odd">
<td><code>order(x, decreasing)</code></td>
<td>Vecteur des rangs de classement des éléments de <code>x</code>. Si ex æquo, les rangs sont classés par ordre croissant</td>
</tr>
<tr class="even">
<td><code>rev(x)</code></td>
<td>Retourne <code>x</code> avec ses éléments dans l’ordre inversé</td>
</tr>
<tr class="odd">
<td><code>table(...)</code></td>
<td>Tableau de contingence</td>
</tr>
<tr class="even">
<td><code>sample(x, size, replace, prob)</code></td>
<td>Ré-échantillonnage pseudo-aléatoire (avec remise si <code>replace = TRUE</code>) de <code>x</code> de taille <code>size</code>. L’argument optionnel <code>prob</code> permet d’attribuer des poids aux éléments</td>
</tr>
<tr class="odd">
<td><code>summary(object)</code></td>
<td>Retourne une table indiquant pour object : le minimum, le premier quartile, la médiane, la moyenne, le troisième quartile, le maximum et, s’il y en a, le nombre de valeurs manquantes. Les calculs sont effectués en omettant les valeurs manquantes.</td>
</tr>
<tr class="even">
<td><code>sort(x, decreasing)</code></td>
<td><code>x</code> trié par ordre de valeurs croissantes (décroissantes si <code>decreasing = TRUE)</code></td>
</tr>
<tr class="odd">
<td><code>tail(x, n)</code></td>
<td>Vecteur des <code>n</code> dernières valeurs de <code>x</code></td>
</tr>
<tr class="even">
<td><code>unique(x, fromLast)</code></td>
<td>Conserve uniquement les valeurs uniques de <code>x</code>, en retirant les doublons. Si <code>fromLast = TRUE</code>, le calcul indiquant si l’élément est dupliqué est effectué de droite vers la gauche</td>
</tr>
<tr class="odd">
<td><code>which.min(x)</code></td>
<td>Position du (premier) minimum de <code>x</code></td>
</tr>
<tr class="even">
<td><code>which.max(x)</code></td>
<td>Position du (premier) maximum de <code>x</code></td>
</tr>
<tr class="odd">
<td><code>"["()</code></td>
<td>Fonction d’extraction ou de remplacement de parties d’un objet</td>
</tr>
<tr class="even">
<td><code>"[["()</code></td>
<td>Fonction d’extraction ou de remplacement de parties d’un objet. Les noms sont perdus.</td>
</tr>
<tr class="odd">
<td><code>dim(x)</code></td>
<td>Liste des tailles de la matrice ou data frame <code>x</code></td>
</tr>
<tr class="even">
<td><code>nrow(x)</code></td>
<td>Nombre de lignes de <code>x</code></td>
</tr>
<tr class="odd">
<td><code>ncol(x)</code></td>
<td>Nombre de colonnes de <code>x</code></td>
</tr>
<tr class="even">
<td><code>dimnames(x)</code></td>
<td>Liste des noms des lignes et des colonnes de <code>x</code></td>
</tr>
<tr class="odd">
<td><code>names(x)</code></td>
<td>Vecteur du (des) nom(s) de <code>x</code></td>
</tr>
<tr class="even">
<td><code>colnames(x)</code></td>
<td>Nom des colonnes de <code>x</code></td>
</tr>
<tr class="odd">
<td><code>rownames(x)</code></td>
<td>Nom des lignes de <code>x</code></td>
</tr>
<tr class="even">
<td><code>c()</code></td>
<td>Concaténation</td>
</tr>
<tr class="odd">
<td><code>cbind(x, y, ...)</code></td>
<td>Fusion des matrices ou data frames <code>x</code> et <code>y</code> par colonnes</td>
</tr>
<tr class="even">
<td><code>merge(x, y)</code></td>
<td>Fusion de deux data frames par noms de colonnes communs</td>
</tr>
<tr class="odd">
<td><code>rbind()</code></td>
<td>Fusion des matrices ou data frames <code>x</code> et <code>y</code> par lignes</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="exercices" class="section level2" number="2.5">
<h2><span class="header-section-number">2.5</span> Exercices</h2>
<!-- % ======== % -->
<!-- % EXERCICE % -->
<!-- % ======== % -->

<div class="exframe">
<p><strong>Exercice 1. Manipulation de vecteurs</strong></p>
<p>Considérons le vecteur suivant : <span class="math inline">\(x = \begin{bmatrix}1 &amp; 2 &amp; 3 &amp; 4 &amp; 5\end{bmatrix}\)</span>.</p>
<ol style="list-style-type: decimal">
<li>Créer ce vecteur dans R et le stocker dans un objet que l’on appellera <code>x</code>x</li>
<li>Afficher le mode de <code>x</code>, puis sa longueur ;</li>
<li>Extraire le premier élément, puis le dernier ;</li>
<li>Extraire les trois premier éléments et les stocker dans un vecteur que l’on nommera <code>a</code> ;</li>
<li>Extraire les éléments en position 1, 3, 5 ; les stocker dans un vecteur que l’on nommera <code>b</code> ;</li>
<li>Additionner le nombre <code>10</code> au vecteur <code>x</code>, puis multipliser le résultat par <code>2</code> ;</li>
<li>Effectuer l’addition de <code>a</code> et <code>b</code>, commenter le résultat ;</li>
<li>Effectuer l’addition suivante : <code>x+a</code>, commenter le résultat, puis regarder le résultat de <code>a+x</code> ;</li>
<li>Multiplier le vecteur par le scalaire <code>c</code> que l’on fixera à 2 ;</li>
<li>Effectuer la multiplication de <code>a</code> et <code>b</code>, commenter le résultat ;</li>
<li>Effectuer la multiplication suivante : <code>x*a</code>, commenter le résultat ;</li>
<li>Récupérer les positions des multiples de 2 et les stocker dans un vecteur que l’on nommera <code>ind</code>, puis conserver uniquement les multiples de 2 de <code>x</code> dans un vecteur que l’on nommera <code>mult_2</code> ;</li>
<li>Afficher les éléments de <code>x</code> qui sont multiples de 3 <em>et</em> multiples de 2 ;</li>
<li>Afficher les éléments de <code>x</code> qui sont multiples de 3 <em>ou</em> multiples de 2 ;</li>
<li>Calculer la somme des éléments de <code>x</code> ;</li>
<li>Remplacer le premier élément de <code>x</code> par un <code>4</code> ;</li>
<li>Remplacer le premier élément de <code>x</code> par la valeur <code>NA</code>, puis calculer la somme des éléments de <code>x</code> ;</li>
<li>Lister les objets en mémoire dans la session R ;</li>
<li>Supprimer le vecteur ;</li>
<li>Supprimer la totalité des objets de la session.</li>
</ol>
</div>
<!-- % ======== % -->
<!-- % EXERCICE % -->
<!-- % ======== % -->

<div class="exframe">
<p><strong>Exercice 2. Manipulation de listes</strong></p>
<ol style="list-style-type: decimal">
<li>évaluer le code suivant : <code>TRUE+FALSE+TRUE*4</code> et le commenter ;</li>
<li>évaluer les expressions suivantes : <code>c(1, 4, TRUE)</code>, et <code>c(1, 4, TRUE, "bonjour")</code>, commenter ;</li>
<li>Créer une liste que l’on appellera <code>l</code> et qui contient les éléments <code>1</code>, <code>4</code> et <code>TRUE</code> en première, deuxième et troisième positions, respectivement ;</li>
<li>Extraire le premier élément de la liste <code>l</code>, et afficher son mode. En faire de même avec le troisième élément, et commenter ;</li>
<li>Ajouter un quatrième élément à la liste <code>l</code> : <code>"bonjour"</code>, puis afficher la structure de <code>l</code> ;</li>
<li>Retirer le troisième élément de la liste <code>l</code> ;</li>
<li>Créer une liste de trois éléments : votre nom, votre prénom, et votre année de naissance. Ces trois éléments de la liste devront être nommés respectivement <code>"nom"</code>, <code>"prenom"</code> et <code>"année de naissance"</code>. Stocker la liste ainsi créée dans un objet nommé <code>moi</code> ;</li>
<li>Extraire le prénom de la liste <code>moi</code> de deux manières : en utilisant l’indice, et en utilisant le nommage ;</li>
<li>Créer une liste avec la même structure que celle de <code>moi</code>, en la remplissant avec les informations d’une autre personne et la nommer <code>toi</code>. Puis, créer la liste <code>personnes</code>, qui contiendra les listes <code>toi</code> et <code>moi</code> ;
10 Extraire la liste <code>toi</code> de <code>personnes</code> (en première position) ;
11 Extraire directement depuis <code>personne</code> le prénom de l’élément en première position.</li>
</ol>
</div>
<!-- % ======== % -->
<!-- % EXERCICE % -->
<!-- % ======== % -->

<div class="exframe">
<p><strong>Exercice 3. Manipulation de matrices</strong></p>
<ol style="list-style-type: decimal">
<li>Créer la matrice suivante : <span class="math inline">\(A = \begin{bmatrix} -3 &amp; 5 &amp; 6 \\ -1 &amp; 2 &amp; 2 \\ 1 &amp; -1 &amp; -1 \end{bmatrix}\)</span> ;</li>
<li>Afficher la dimension de <code>A</code>, son nombre de colonnes, son nombre de lignes et sa longueur ;</li>
<li>Extraire la seconde colonne de <code>A</code>, puis la première ligne ;</li>
<li>Extraire l’élément en troisième position à la première ligne ;</li>
<li>Extraire la sous-matrice de dimension <span class="math inline">\(2\times 2\)</span> du coin inférieur de <code>A</code>, c’est-à-dire <span class="math inline">\(\begin{bmatrix} 2 &amp; 2 \\ -1 &amp; -1 \end{bmatrix}\)</span> ;</li>
<li>Calculer la somme des colonnes puis des lignes de <code>A</code> ;</li>
<li>Afficher la diagonale de <code>A</code> ;</li>
<li>Rajouter le vecteur <span class="math inline">\(\begin{bmatrix} 1 &amp; 2 &amp; 3\end{bmatrix}^\top\)</span> à droite de la matrice <code>A</code> et stocker le résultat dans un objet appelé <code>B</code> ;</li>
<li>Retirer le quatrième vecteur de <code>B</code> ;</li>
<li>Retirer la première et la troisième ligne de <code>B</code> ;</li>
<li>Ajouter le scalaire <code>10</code> à <code>A</code> ;</li>
<li>Ajouter le vecteur <span class="math inline">\(\begin{bmatrix} 1 &amp; 2 &amp; 3\end{bmatrix}^\top\)</span> à A ;</li>
<li>Ajouter la matrice identité <span class="math inline">\(I_3\)</span> à <code>A</code> ;</li>
<li>Diviser tous les éléments de la matrice <code>A</code> par 2 ;</li>
<li>Multiplier la matrice <code>A</code> par le vecteur <span class="math inline">\(\begin{bmatrix} 1 &amp; 2 &amp; 3\end{bmatrix}^\top\)</span> ;</li>
<li>Afficher la transposée de <code>A</code> ;</li>
<li>Effectuer le produit avec transposition <span class="math inline">\(A^\top A\)</span>.</li>
</ol>
</div>
<!-- % ======== % -->
<!-- % EXERCICE % -->
<!-- % ======== % -->

<div class="exframe">
<p><strong>Exercice 4. Manipulation de matrices</strong></p>
<ol style="list-style-type: decimal">
<li>Télécharger le fichier <code>csv</code> à l’adresse suivante : <a href="http://egallic.fr/Enseignement/R/Exercices/donnees/notes.csv">http://egallic.fr/Enseignement/R/Exercices/donnees/notes.csv</a> et le placer dans le répertoire courant du projet. Importer son contenu dans R ;</li>
<li>Importer à nouveau les données dans R, mais en utilisant fournissant cette fois le l’url directement à la fonction d’importation ;</li>
<li>À présent, importer le contenu du fichier disponible à l’adresse <a href="http://egallic.fr/Enseignement/R/Exercices/donnees/notes_decim.csv" class="uri">http://egallic.fr/Enseignement/R/Exercices/donnees/notes_decim.csv</a>. Le séparateur de champs est un point virgule et le séparateur décimal est une virgule ;</li>
<li>Importer le contenu du fichier <a href="http://egallic.fr/Enseignement/R/Exercices/donnees/notes_h.csv" class="uri">http://egallic.fr/Enseignement/R/Exercices/donnees/notes_h.csv</a>. Le nom des colonnes n’est pas présent ;</li>
<li>Importer le contenu du fichier <a href="http://egallic.fr/Enseignement/R/Exercices/donnees/notes_h_s.csv" class="uri">http://egallic.fr/Enseignement/R/Exercices/donnees/notes_h_s.csv</a>. La première ligne n’est pas à importer ;</li>
<li>Importer le contenu de la première feuille du fichier Excel <a href="http://egallic.fr/Enseignement/R/Exercices/donnees/notes.xlsx" class="uri">http://egallic.fr/Enseignement/R/Exercices/donnees/notes.xlsx</a> ;</li>
<li>Importer le contenu de la seconde feuille (`notes_h_s) du fichier Excel <a href="http://egallic.fr/Enseignement/R/Exercices/donnees/notes.xlsx" class="uri">http://egallic.fr/Enseignement/R/Exercices/donnees/notes.xlsx</a>. La première ligne est un commentaire à ne pas considérer durant l’importaiton ;</li>
<li>Importer le fichier <a href="http://egallic.fr/Enseignement/R/Exercices/donnees/notes.rda" class="uri">http://egallic.fr/Enseignement/R/Exercices/donnees/notes.rda</a> dans R ;</li>
<li>Exporter le contenu de l’objet <code>notes</code> de la question précédente au format <code>csv</code> (virgule en séparateur de champs, point en séparateur décimal, ne pas conserver le numéro des lignes).</li>
<li>Importer le contenu du fichier <code>notes_2012.csv</code> contenu dans l’archive disponible à l’adresse suivante : <a href="http://egallic.fr/Enseignement/R/Exercices/donnees/notes.zip" class="uri">http://egallic.fr/Enseignement/R/Exercices/donnees/notes.zip</a></li>
</ol>
</div>
<!-- % ======== % -->
<!-- % EXERCICE % -->
<!-- % ======== % -->

<div class="exframe">
<p><strong>Exercice 5. Manipulation de tableaux de données</strong></p>
<ol style="list-style-type: decimal">
<li>À l’aide de la fonction <code>read_excel()</code> du <em>package</em> <code>readr</code>, importer le contenu de la feuille intitulée <code>notes_2012</code> du fichier Excel disponible à l’adresse suivante : <a href="http://egallic.fr/Enseignement/R/Exercices/donnees/notes_etudiants.xlsx" class="uri">http://egallic.fr/Enseignement/R/Exercices/donnees/notes_etudiants.xlsx</a> et le stocker dans une variable que l’on nommera <code>notes_2012</code> ;</li>
<li>Afficher les 6 premières lignes du jeu de données, puis les dimensions du tableau ;</li>
<li>Conserver uniquement la colonne <code>note_stat</code> du tableau de données <code>notes_2012</code> dans un objet que l’on appellera tmp ;</li>
<li>Conserver uniquement les colonnes <code>num_etudiant</code>, <code>note_stat</code> et <code>note_macro</code> dans l’objet <code>tmp</code>;</li>
<li>Remplacer le contenu de <code>tmp</code> par les observations de <code>notes_2012</code> pour lesquelles l’individu a obtenu une note de stat supérieure (strictement) à 10 ;</li>
<li>Remplacer le contenu de <code>tmp</code> par les observations de <code>notes_2012</code> pour lesquelles l’individu a obtenu une note comprise dans l’intervalle <span class="math inline">\((10,15)\)</span>;</li>
<li>Regarder s’il y a des doublons dans le tableau de données <code>notees_2012</code> ; le cas échéant, les retirer du tableau ;</li>
<li>Afficher le type des données de la colonne <code>num_etudiant</code>, puis afficher le type de toutes les colonnes de <code>notes_2012</code> ;</li>
<li>Ajouter au tableau <code>notes_2012</code> les colonnes suivantes :</li>
</ol>
<ul>
<li><code>note_stat_maj</code> : la note de stat (<code>note_stat</code>) majorée d’un point,</li>
<li><code>note_macro_maj</code> : la note de macro (<code>note_macro</code>) majorée de trois points (le faire en deux étapes : d’abord deux points en plus, puis un point) ;</li>
</ul>
<ol start="10" style="list-style-type: decimal">
<li>Renommer la colonne <code>year</code> en <code>annee</code> ;</li>
<li>Depuis le fichier <code>notes_etudiants.xlsx}</code> (c.f. question 1), importer le contenu des feuilles <code>notes_2013</code>, <code>notes_2014</code> et <code>prenoms</code> et le stocker dans les objets <code>notes_2013</code>, <code>notes_2014</code> et <code>prenoms</code> respectivement ;</li>
<li>Empiler le contenu des tableaux de données <code>notes_2012</code>, <code>notes_2013</code> et <code>notes_2014</code> dans un objet que l’on nommera <code>notes</code> ;</li>
<li>Fusionner les tableaux <code>notes</code> et <code>prenoms</code> à l’aide d’une jointure gauche, de manière à rajouter les informations contenues dans le tableau <code>prenoms</code> aux observations de <code>notes</code>. La jointure doit se faire par le numéro détudiant et l’année, l’objet final viendra remplacer le contenu de <code>notes</code> ;</li>
<li>Trier le tableau <code>notes</code> par années croissantes et notes de macro décroissantes ;</li>
<li>Changer le type des colonnes <code>annee</code> et <code>sexe</code> en facteur ;</li>
<li>Créer une colonne <code>apres_2012</code> qui prend la valeur <code>TRUE</code> si l’observation concerne une note attribuée après 2012;</li>
<li>à l’aide de la fonction <code>summarize()</code> du <em>package</em> {<code>dplyr</code>}, calculer :</li>
</ol>
<ul>
<li>la moyenne et l’écart-type annuels des notes pour chacune des deux matières,</li>
<li>la moyenne et l’écart-type annuels et par sexe des notes pour chacune des deux matières ;</li>
</ul>
<ol start="17" style="list-style-type: decimal">
<li>En utilisant la fonction <code>pivot_longer()</code> du <em>package</em> {<code>tidyr</code>}, créer un tableau dans lequel chaque ligne renseigne le numéro d’étudiant, l’année, le prénom, le sexe, l’enseignement (macro ou stat) et la note ;</li>
<li>En repartant de l’objet obtenu à la question précédente, utiliser la fonction <code>pivot_wider()</code> du <em>package</em> {<code>tidyr</code>} pour retomber sur le même tableau que <code>notes</code>.</li>
</ol>
</div>
<!-- % ======== % -->
<!-- % EXERCICE % -->
<!-- % ======== % -->

<div class="exframe">
<p><strong>Exercice 6. Manipulation de tableaux de chaînes de caractères</strong></p>
<ol style="list-style-type: decimal">
<li>Créer les objets <code>a</code> et <code>b</code> afin qu’il contiennent respectivement les chaînes de caractères suivantes : <code>23 à 0</code> et <code>C'est la piquette, Jack !</code> ;</li>
<li>Créer le vecteur <code>phrases</code> de longueur 2, dont les deux éléments sont <code>a</code> et <code>b</code> ;</li>
<li>À l’aide de la fonction appropriée dans le <em>package</em> {<code>stringr</code>}, afficher le nombre de caractètres de <code>a</code>, de <code>b</code>, puis appliquer la même fonction à l’objet <code>phrases</code> ;</li>
<li>En utilisant la fonction <code>str_c()</code>, concaténer <code>a</code> et <code>b</code> dans une seule chaîne de caractères, en choisissant la virgule comme caractère de séparation ;</li>
<li>Concaténer les deux éléments du vecteur <code>phrases</code> en une seule chaîne de caractères, en les séparant par le caractère de retour à la ligne, puis utiliser la fonction <code>cat()</code> pour afficher le résultat dans la console ;</li>
<li>Appliquer la même fonction que dans la question précédente à l’objet suivant : <code>c(NA, phrases)</code> et commenter ;</li>
<li>Mettre en majuscules, puis en minuscules les chaînes du vecteur <code>phrases</code> (afficher le résultat, ne pas modifier <code>phrases</code>);</li>
<li>À l’aide de la fonction <code>word()</code> du <em>package</em> {<code>stringr</code>}, extraire le mot <code>la</code>, puis <code>Jack</code> de la chaîne <code>b</code> ;</li>
<li>Même question que la précédente, en utilisant la fonction <code>str_sub()</code> ;</li>
<li>À l’aide de la fonction <code>str_detect()</code>, rechercher si le motif <code>piqu</code> puis <code>mauvais</code> sont présents dans <code>b</code> ;</li>
<li>À l’aide de la fonction <code>str_detect()</code>, rechercher si le motif <code>piqu</code> est présent dans les éléments du vecteur <code>phrases</code> ;</li>
<li>À l’aide de la fonction <code>str_detect()</code>, rechercher si le motif <code>piqu</code> ou le motif <code>à</code> sont présents dans les éléments du vecteur <code>phrases</code> ;</li>
<li>En utilisant la fonction <code>str_locate()</code>, retourner les positions de la première occurence du caractère <code>a</code> dans la chaîne <code>b</code>, puis essayer avec le caractère <code>w</code> pour observer le résultat retourné ;</li>
<li>Retourner toutes les positions du motif <code>a</code> dans la chaîne <code>b</code> ;</li>
<li>En utilisant la fonction <code>str_replace()</code>, remplacer la première occurence du motif <code>a</code>, par le motif <code>Z</code> (afficher le résultat, ne pas modifier <code>phrases</code>);</li>
<li>Remplacer toutes les occurences de <code>a</code> par <code>Z</code> dans la chaîne <code>b</code> (afficher le résultat, ne pas modifier <code>phrases</code>) ;</li>
<li>Utiliser la fonction <code>str_split()</code> pour séparer la chaîne <code>b</code> en utilisant la virgule comme séparateur de sous-chaînes ;</li>
<li>Retirer tous les caractères de ponctuation de la chaîne <code>b</code>, puis utiliser la fonction <code>str_trim()</code> sur le résultat pour retirer les caractères blancs du début et de la fin de la chaîne.</li>
</ol>
</div>
<!-- % ======== % -->
<!-- % EXERCICE % -->
<!-- % ======== % -->

<div class="exframe">
<p><strong>Exercice 7. Manipulation de tableaux de de dates</strong></p>
<ol style="list-style-type: decimal">
<li><p>En utilisant la fonction <code>as.Date()</code>, stocker la date du 29 aoùt 2015 dans un objet que l’on appellera <code>d</code> puis afficher la classe de l’objet ;</p></li>
<li><p>À l’aide de la fonction appropriée, afficher la date du jour ;</p></li>
<li><p>À l’aide de la fonction <code>as.Date()</code>, stocker sous forme de date la chaîne de caractères suivante : <code>29-08-2015</code> ;</p></li>
<li><p>Utiliser les fonctions <code>as.POSIXct()</code> et <code>as.POSIXlt</code> pour stocker la chaîne de caractères <code>2015-08-29 20:30:56</code> sous forme de dates dans des objets nommés <code>d_ct</code> et <code>d_lt</code> respectivement ; utiliser ensuite la fonction <code>unclass()</code> sur les deux objets pour comparer la façon dont R a stocké l’information :</p></li>
<li><p>Utiliser la fonction appropriée du <em>package</em> {<code>lubridate</code>} pour stocker la chaîne de caractères <code>2015-08-29</code> sous forme de date ;</p></li>
<li><p>Même question avec la chaîne <code>2015-08-29 20:30:56</code> ;</p></li>
<li><p>Utiliser la fonction <code>ymd_hms()</code> pour stocker la date et l’heure actuelle, en précisant le fuseau horaire, puis afficher la date et l’heure correspondantes à New York City ;</p></li>
<li><p>Considérons le vecteur <code>x</code> :</p>
<p><code>x &lt;- c(ymd_hms("2015-08-29 20:30:56", tz = "Europe/Paris"),               ymd_hms("2015-09-15 08:10:33", tz = "Europe/Paris"))</code></p>
<p>Extraire l’année, le mois, le jour, les heures, les minutes et les secondes du premier élément de <code>x</code> à l’aide des fonctions appropriées du <em>package</em> {<code>lubridate</code>} ;</p></li>
<li><p>Appliquer les mêmes fonctions au vecteur <code>x</code> ;</p></li>
<li><p>Au premier élément de <code>x</code>, ajouter :</p></li>
</ol>
<ul>
<li>une seconde,</li>
<li>un jour,</li>
<li>un mois</li>
<li>deux années ;</li>
</ul>
<ol start="11" style="list-style-type: decimal">
<li>Tester si la date du premier élément de <code>x</code> vient avant celle du second élément ;</li>
<li>En utilisant la fonction <code>interval()</code> du <em>package</em> {<code>lubridate</code>}, créer un intervalle de dates entre les deux éléments de <code>x</code>, puis afficher le nombre de jours, puis le nombre d’heures, puis le nombre d’années séparant les deux dates ;</li>
<li>En utilisant la fonction <code>seq()</code>, créer une séquence de dates avec un intervalle de 5 jours entre chaque date, commençant à la date du premier élément de <code>x</code> et se terminant à la date du second élément de <code>x</code> (la séquence sera tronquée avant) ;</li>
<li>Convertir en date les deux chaînes de caracères suivantes : <code>Sam 29 Aoùt 2015</code> et <code>Sat 29 Aug 2015</code>.</li>
</ol>
</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-grolemund_2018_r">
<p>Grolemund, Garrett, and Hadley Wickham. 2018. <em>R for Data Science</em>. O’Reilly Media, Incorporated.</p>
</div>
<div id="ref-Lafaye_2011_Logiciel">
<p>Lafaye de Micheaux, P., R. Drouilhet, and B. Liquet. 2011. <em>Le Logiciel <code>R</code>: Maîtriser Le Langage - Effectuer Des Analyses Statistiques</em>. Statistique et Probabilités Appliquées. Springer.</p>
</div>
<div id="ref-Paradis_2002_R">
<p>Paradis, Emmanuel. 2002. “R Pour Les débutants.” <a href="http://cran.r-project.org/doc/contrib/Paradis-rdebuts_fr.pdf">http://cran.r-project.org/doc/contrib/Paradis-rdebuts_fr.pdf</a>.</p>
</div>
<div id="ref-Sanchez_2013_Handling">
<p>Sanchez, Gaston. 2013. <em>Handling and Processing Strings in <code>R</code></em>. Berkeley: Trowchez Editions. <a href="http://gastonsanchez.com/Handling_and_Processing_Strings_in_R.pdf">http://gastonsanchez.com/Handling_and_Processing_Strings_in_R.pdf</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="fonction.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"toc": {
"collapse": "subsubsection",
"scroll_highlight": true
},
"toc_depth": 5,
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
